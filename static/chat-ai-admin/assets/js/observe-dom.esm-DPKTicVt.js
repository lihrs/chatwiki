/*!
 * better-scroll / observe-dom
 * (c) 2016-2023 ustbhuangyi
 * Released under the MIT License.
 */var l=typeof window<"u",u=l&&navigator.userAgent.toLowerCase();u&&u.indexOf("android")>0;(function(){if(typeof u=="string"){var e=/os (\d\d?_\d(_\d)?)/,t=e.exec(u);if(!t)return!1;var r=t[1].split("_").map(function(o){return parseInt(o,10)});return r[0]===13&&r[1]>=4}return!1})();var k=!1;if(l){var g="test-passive";try{var d={};Object.defineProperty(d,"passive",{get:function(){k=!0}}),window.addEventListener(g,function(){},d)}catch{}}var b=l&&document.createElement("div").style,i=function(){if(!l)return!1;for(var e=[{key:"standard",value:"transform"},{key:"webkit",value:"webkitTransform"},{key:"Moz",value:"MozTransform"},{key:"O",value:"OTransform"},{key:"ms",value:"msTransform"}],t=0,r=e;t<r.length;t++){var o=r[t];if(b[o.value]!==void 0)return o.key}return!1}();function n(e){return i===!1?e:i==="standard"?e==="transitionEnd"?"transitionend":e:i+e.charAt(0).toUpperCase()+e.substr(1)}i&&i!=="standard"&&""+i.toLowerCase();var y=n("transform"),O=n("transition");l&&n("perspective")in b;n("transitionTimingFunction"),n("transitionDuration"),n("transitionDelay"),n("transformOrigin"),n("transitionEnd"),n("transitionProperty");function p(e){if(e instanceof window.SVGElement){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}else return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}var m=function(){function e(t){this.scroll=t,this.stopObserver=!1,this.init()}return e.prototype.init=function(){this.handleMutationObserver(),this.handleHooks()},e.prototype.handleMutationObserver=function(){var t=this;if(typeof MutationObserver<"u"){var r=0;this.observer=new MutationObserver(function(o){t.mutationObserverHandler(o,r)}),this.startObserve(this.observer)}else this.checkDOMUpdate()},e.prototype.handleHooks=function(){var t=this;this.hooksFn=[],this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.contentChanged,function(){t.stopObserve(),t.handleMutationObserver()}),this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.enable,function(){t.stopObserver&&t.handleMutationObserver()}),this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.disable,function(){t.stopObserve()}),this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.destroy,function(){t.destroy()})},e.prototype.mutationObserverHandler=function(t,r){var o=this;if(!this.shouldNotRefresh()){for(var s=!1,a=!1,h=0;h<t.length;h++){var f=t[h];if(f.type!=="attributes"){s=!0;break}else if(f.target!==this.scroll.scroller.content){a=!0;break}}s?this.scroll.refresh():a&&(clearTimeout(r),r=window.setTimeout(function(){o.shouldNotRefresh()||o.scroll.refresh()},60))}},e.prototype.startObserve=function(t){var r={attributes:!0,childList:!0,subtree:!0};t.observe(this.scroll.scroller.content,r)},e.prototype.shouldNotRefresh=function(){var t=this.scroll.scroller,r=t.scrollBehaviorX,o=t.scrollBehaviorY,s=r.currentPos>r.minScrollPos||r.currentPos<r.maxScrollPos||o.currentPos>o.minScrollPos||o.currentPos<o.maxScrollPos;return t.animater.pending||s},e.prototype.checkDOMUpdate=function(){var t=this,r=this.scroll.scroller.content,o=p(r),s=o.width,a=o.height,h=function(){if(!t.stopObserver){o=p(r);var c=o.width,v=o.height;(s!==c||a!==v)&&t.scroll.refresh(),s=c,a=v,f()}},f=function(){setTimeout(function(){h()},1e3)};f()},e.prototype.registerHooks=function(t,r,o){t.on(r,o,this),this.hooksFn.push([t,r,o])},e.prototype.stopObserve=function(){this.stopObserver=!0,this.observer&&this.observer.disconnect()},e.prototype.destroy=function(){this.stopObserve(),this.hooksFn.forEach(function(t){var r=t[0],o=t[1],s=t[2];r.off(o,s)}),this.hooksFn.length=0},e.pluginName="observeDOM",e}();export{m as O};
