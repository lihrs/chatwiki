import{b as M,M as D,k as C,h as H,l as J,B as Q,ax as Y,ay as oo,az as to,d as eo,aA as so,E as W}from"../../index-D5kWFI_D.js";import{d as m,S as V,O as x,U as n,X as t,j as s,Z as j,u as h,b as F,q as no,N as E,a6 as lo,F as ao,a1 as io,a0 as _,_ as S}from"./vue-chunks-BRsu9_To.js";import{r as ro,g as co,c as po,e as uo}from"./index-BUFsCuwD.js";import{A as _o}from"./add-robot-alert-Cp0efF1Z.js";import{I as mo}from"./InboxOutlined-B5kZxseM.js";import{U as fo,_ as vo}from"./index-BfVvK1-5.js";import{_ as bo}from"./index-QkBOwR6N.js";import{_ as ko}from"./page-alert-B52VRJuP.js";import{L as go}from"./list-tabs-Milc4Sq1.js";import"./index-qh96aJip.js";import{D as Co}from"./dropdown-LAVathmR.js";import{P as yo}from"./PlusOutlined-DpByR1sK.js";import{M as $o,_ as To}from"./index-CHJt20_R.js";import{_ as xo}from"./index-BPoB9Ww2.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-BwRZ1OHf.js";import"./index-BtvIFvZE.js";import"./Trigger-DKtb4Equ.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-DEufRGOn.js";import"./responsiveObserve-CkCS37Fy.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-BwNSer6q.js";import"./FormItemContext-FSdunmL7.js";import"./robot-CmlkmLKQ.js";import"./index-Ca1EG28E.js";import"./Input-BnGlJfeo.js";import"./index-DhRq8W09.js";import"./inputProps-BEjYvl-5.js";import"./Search-BlRwzxLf.js";import"./SearchOutlined-BtoJ0H4_.js";import"./TextArea-BjyvIBLl.js";import"./index-Dl5gOyIo.js";import"./Password-7xAmuTgW.js";import"./DownloadOutlined-B7eFnoKE.js";import"./CheckOutlined-BjkEYCxV.js";import"./RightOutlined-79RkPZqS.js";import"./move-BtjpvD48.js";import"./slide-DT-jtFtX.js";import"./colors-CvmZis4z.js";import"./shallowequal-C0xnIuy8.js";const ho={class:"form-box"},wo={class:"tip-box"},Ao={class:"ant-upload-drag-icon"},Lo={__name:"import-csl-alert",emits:["ok"],setup(O,{expose:y,emit:f}){const b=f,d=m(!1),u=m(!1),c=m([]),$=()=>{d.value=!0},U=()=>{d.value=!1,c.value=[]},k=()=>{if(c.value.length===0){C.error("请上传csl文件");return}u.value=!0,ro({file:c.value[0].originFileObj}).then(p=>{u.value=!1,d.value=!1,C.success("导入成功"),c.value=[],b("ok",p.data)}).catch(()=>{u.value=!1})},w=p=>p.name.endsWith(".csl")?!1:(C.error("只能上传csl格式的文件"),vo.LIST_IGNORE),A=p=>{const{status:a}=p.file;a!=="uploading"&&(p.file,p.fileList)};return y({open:$}),(p,a)=>{const I=bo,L=fo,P=D;return x(),V(P,{width:"600px",open:d.value,"onUpdate:open":a[1]||(a[1]=T=>d.value=T),confirmLoading:u.value,title:"导入csl文件创建机器人",onOk:k,onCancel:U},{default:n(()=>[t("div",ho,[t("div",wo,[s(I,{type:"info"},{description:n(()=>a[2]||(a[2]=[j(" 您可以将您编排好的机器人导出为csl文件,共享给他人使用。也可以从他人处获取导出的csl文件,通过导入形式创建机器人。 ")])),_:1})]),s(L,{fileList:c.value,"onUpdate:fileList":a[0]||(a[0]=T=>c.value=T),name:"file",multiple:!1,maxCount:1,accept:".csl","before-upload":w,onChange:A},{default:n(()=>[t("p",Ao,[s(h(mo),{class:"upload-icon"})]),a[3]||(a[3]=t("p",{class:"upload-text"},"点击或将文件拖拽到这里上传",-1)),a[4]||(a[4]=t("p",{class:"upload-hint"},"仅支持从chatwiki导出生成的csl文件",-1))]),_:1,__:[3,4]},8,["fileList"])])]),_:1},8,["open","confirmLoading"])}}},Ro=M(Lo,[["__scopeId","data-v-ae06ccf0"]]),Oo=()=>{const O=H();return{openUrlWithToken:f=>{const b=O.getToken;if(!b){console.warn("Token is missing");return}if(!f){console.warn("URL is missing");return}const d=f.includes("?")?"&":"?",u=`${f}${d}token=${b}`;window.open(u,"_blank")}}},Uo={class:"robot-page"},Io={class:"list-toolbar"},Po={class:"toolbar-box"},Bo={class:"toolbar-box"},Eo={class:"create-action"},So=["src"],Do={class:"create-action"},No=["src"],Wo={class:"create-action"},Fo=["src"],Mo={class:"list-box"},Vo=["onClick"],jo={class:"list-item"},Go={class:"robot-info"},Ko=["src"],qo={class:"robot-info-content"},zo={class:"robot-name"},Xo={class:"robot-type-tag"},Zo={class:"robot-desc"},Ho=["onClick"],Jo=["onClick"],Qo=["onClick"],Yo=["onClick"],ot=["onClick"],tt={__name:"robot-list",setup(O){const y=m([{title:"全部 (0)",value:"2"},{title:"聊天机器人 (0)",value:"0"},{title:"工作流 (0)",value:"1"}]),f=J();let{role_permission:b,role_type:d}=f;const u=F(()=>d==1||b.includes("RobotCreate")),c=m("2"),$=m([]),U=F(()=>c.value==2?$.value:$.value.filter(e=>e.application_type==c.value)),k=()=>{co().then(e=>{let o=0,r=0,i=0;e.data.forEach(v=>{v.application_type==0?r++:i++,o++}),y.value=[{title:"全部 ("+o+")",value:"2"},{title:"聊天机器人 ("+r+")",value:"0"},{title:"工作流 ("+i+")",value:"1"}],$.value=e.data}).catch(()=>{})},w=m(null),A=m(null),p=e=>{w.value.open(e)},a=()=>{A.value.open()},I=e=>{k(),L(e)},L=({id:e,robot_key:o,application_type:r})=>{r==0?window.open(`/#/robot/config/basic-config?id=${e}&robot_key=${o}`,"_blank","noopener"):window.open(`/#/robot/config/workflow?id=${e}&robot_key=${o}`,"_blank","noopener")},P=e=>{if(so(e.id)!=4)return C.error("您没有删除机器人的权限");let r=3,i=D.confirm({title:`删除机器人${e.robot_name}`,icon:s(W),content:"您确定要删除此机器人吗？",okText:r+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){T(e)},onCancel(){}}),v=setInterval(()=>{r==1?(i.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(v),v=void 0):(r-=1,i.update({okText:r+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},T=({id:e})=>{po({id:e}).then(()=>{C.success("删除成功"),k()})},G=e=>{let o=3,r=D.confirm({title:`复制机器人${e.robot_name}`,icon:s(W),content:"您确定要复制此机器人吗？",okText:o+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){K(e)},onCancel(){}}),i=setInterval(()=>{o==1?(r.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(i),i=void 0):(o-=1,r.update({okText:o+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},K=({id:e})=>{uo({id:e}).then(()=>{C.success("复制成功"),k()})},q=e=>{const{openUrlWithToken:o}=Oo();o(`/manage/robotExport?id=${e.id}`)},z=e=>{window.open(`#/robot/test?robot_key=${e.robot_key}&id=${e.id}`)},X=e=>{window.open(`#/robot/config/session-record?robot_key=${e.robot_key}&id=${e.id}`)},Z=e=>{window.open(`#/robot/config/statistical_analysis?robot_key=${e.robot_key}&id=${e.id}`)};return no(()=>{k()}),(e,o)=>{const r=Q,i=To,v=$o,N=Co,R=eo,B=xo;return x(),E("div",Uo,[o[12]||(o[12]=t("h3",{class:"page-title"},"应用",-1)),s(ko,{class:"mb-16",title:"使用说明"},{default:n(()=>o[6]||(o[6]=[t("div",null,[t("p",null," 1、应用包括两种类型：聊天机器人、工作流。聊天机器人适合新手用户，关联知识库后只需简单配置，即可创建一个基于私有知识库的问答机器人。工作流适合高级用户，利用系统预制节点自定义任务流程，适合解决复杂任务。 "),t("p",null,"2、发现模块也提供了丰富模版，可以根据需要选择适合模版快速创建应用。")],-1)])),_:1,__:[6]}),t("div",Io,[t("div",Po,[s(go,{tabs:y.value,value:c.value,"onUpdate:value":o[0]||(o[0]=l=>c.value=l)},null,8,["tabs","value"])]),t("div",Bo,[u.value?(x(),V(N,{key:0},{overlay:n(()=>[s(v,null,{default:n(()=>[s(i,{onClick:o[2]||(o[2]=_(l=>p(0),["prevent"]))},{default:n(()=>[t("span",Eo,[t("img",{class:"icon",src:h(Y),alt:""},null,8,So),o[8]||(o[8]=t("span",null,"聊天机器人",-1))])]),_:1}),s(i,{onClick:o[3]||(o[3]=_(l=>p(1),["prevent"]))},{default:n(()=>[t("span",Do,[t("img",{class:"icon",src:h(oo),alt:""},null,8,No),o[9]||(o[9]=t("span",null,"工作流",-1))])]),_:1}),s(i,{onClick:a},{default:n(()=>[t("span",Wo,[t("img",{class:"icon",src:h(to),alt:""},null,8,Fo),o[10]||(o[10]=t("span",null,"导入csl创建",-1))])]),_:1})]),_:1})]),default:n(()=>[s(r,{type:"primary",onClick:o[1]||(o[1]=_(()=>{},["prevent"]))},{icon:n(()=>[s(h(yo))]),default:n(()=>[o[7]||(o[7]=j(" 创建应用 "))]),_:1,__:[7]})]),_:1})):lo("",!0)])]),t("div",Mo,[(x(!0),E(ao,null,io(U.value,l=>(x(),E("div",{class:"list-item-wrapper",key:l.id,onClick:g=>L(l)},[t("div",jo,[t("div",Go,[t("img",{class:"robot-avatar",src:l.robot_avatar,alt:""},null,8,Ko),t("div",qo,[t("div",zo,S(l.robot_name),1),t("div",Xo,S(l.application_type==0?"聊天机器人":"工作流"),1)])]),t("div",Zo,S(l.robot_intro),1),t("div",{class:"robot-action",onClick:o[5]||(o[5]=_(()=>{},["stop"]))},[s(B,{title:"聊天测试"},{default:n(()=>[t("div",{class:"robot-action-item",onClick:_(g=>z(l),["stop"])},[s(R,{class:"action-icon",name:"chat"})],8,Ho)]),_:2},1024),s(B,{title:"会话记录"},{default:n(()=>[t("div",{class:"robot-action-item",onClick:_(g=>X(l),["stop"])},[s(R,{class:"action-icon",name:"session"})],8,Jo)]),_:2},1024),s(B,{title:"统计分析"},{default:n(()=>[t("div",{class:"robot-action-item",onClick:_(g=>Z(l),["stop"])},[s(R,{class:"action-icon",name:"analysis"})],8,Qo)]),_:2},1024),s(N,null,{overlay:n(()=>[s(v,null,{default:n(()=>[s(i,null,{default:n(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:g=>P(l)},"删 除",8,Yo)]),_:2},1024),s(i,null,{default:n(()=>[t("a",{class:"copy-text-color",href:"javascript:;",onClick:g=>G(l)},"复 制",8,ot)]),_:2},1024),s(i,{onClick:g=>q(l)},{default:n(()=>o[11]||(o[11]=[t("span",null,"导出为csl",-1)])),_:2,__:[11]},1032,["onClick"])]),_:2},1024)]),default:n(()=>[t("div",{class:"robot-action-item",onClick:o[4]||(o[4]=_(()=>{},["stop"]))},[s(R,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,Vo))),128))]),s(_o,{ref_key:"addRobotAlertRef",ref:w},null,512),s(Ro,{ref_key:"importCslAlertRef",ref:A,onOk:I},null,512)])}}},qt=M(tt,[["__scopeId","data-v-6a3d5ecb"]]);export{qt as default};
