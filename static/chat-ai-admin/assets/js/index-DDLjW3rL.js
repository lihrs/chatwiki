import{b as L,d as O,z as u,q as S,N as U,X as f,j as r,U as o,a2 as C,O as V,W as c,u as y,Z as v,a0 as D}from"./vue-chunks-BRsu9_To.js";import{b as J,k as b,bF as M,bL as T,B as j,bH as E,dj as H}from"../../index-CptKfSUC.js";import{A as P}from"./avatar-input-5_D2wSyM.js";import{t as Y}from"./validate-8MtiUsxW.js";import{F as g,_ as z}from"./index-BdXFo1Yi.js";import"./index-CrGpUfGH.js";import{I as W}from"./Input-BFAHe0DY.js";import{_ as X}from"./TextArea-DZQUCnMF.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./PlusOutlined-BR72fkTP.js";import"./index-hJ3NDJJa.js";import"./Trigger-B5sPmMFr.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./Password-BJfMc7qR.js";import"./inputProps-DCrFQ5HR.js";import"./DownloadOutlined-H1KeEsM2.js";import"./index-SQEG4xim.js";import"./colors-CB658H7g.js";import"./CheckOutlined-CR4N2RZP.js";import"./collapseMotion-Brd6xpAT.js";import"./FormItemContext-gpTH9eHq.js";import"./isPlainObject-iUjGA7o2.js";import"./responsiveObserve-BhysygCB.js";import"./QuestionCircleOutlined-DXvm_sAY.js";import"./index-TvkCt6Hp.js";import"./Search-BuYDKTKT.js";import"./SearchOutlined-BkABIbhb.js";import"./index-CreR3MX_.js";const Z={class:"add-library-page"},$={class:"form-box"},G={__name:"index",setup(K){b.config({duration:2});const _=C(),s=L(()=>1),x=g.useForm,n=O(!1),A=s.value==0?M:T,a=u({type:s.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:A,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:s.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),q=u({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:h,validateInfos:m}=x(a,q),k=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},F=()=>{_.back()},N=()=>{h().then(()=>{w()}).catch(e=>{})},w=()=>{let e=new FormData,t=JSON.parse(JSON.stringify(a));e.append("type",a.type),e.append("access_rights",a.access_rights),e.append("library_name",a.library_name),e.append("library_intro",a.library_intro),e.append("use_model",t.use_model),e.append("model_config_id",a.model_config_id),e.append("avatar",a.avatar_file?a.avatar_file:""),e.append("is_offline",a.is_offline),e.append("urls",JSON.stringify(Y(a.urls))),e.append("doc_type",a.doc_type),e.append("file_name",a.file_name),e.append("is_qa_doc",a.is_qa_doc),e.append("qa_index_type",a.qa_index_type),e.append("doc_auto_renew_frequency",a.doc_auto_renew_frequency),n.value=!0,E(e).then(p=>{b.success("创建成功"),I(p.data.id)}).catch(()=>{n.value=!1})},I=e=>{H({id:e}).then(t=>{n.value=!1,_.replace({path:"/public-library/config",query:{library_id:t.data.id,library_key:t.data.library_key}})}).catch(()=>{n.value=!1})};return S(()=>{}),(e,t)=>{const p=W,l=z,R=X,d=j,B=g;return V(),U("div",Z,[f("div",$,[r(B,{"label-col":{span:5}},{default:o(()=>[r(l,c({ref:"name",label:"知识库名称"},y(m).library_name),{default:o(()=>[r(p,{value:a.library_name,"onUpdate:value":t[0]||(t[0]=i=>a.library_name=i),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),r(l,{label:"知识库简介"},{default:o(()=>[r(R,{value:a.library_intro,"onUpdate:value":t[1]||(t[1]=i=>a.library_intro=i),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(l,c({ref:"name",label:"知识库封面"},y(m).avatar),{default:o(()=>[r(P,{value:a.avatar,"onUpdate:value":t[2]||(t[2]=i=>a.avatar=i),onChange:k},null,8,["value"]),t[3]||(t[3]=f("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[3]},16),r(l,{"wrapper-col":{span:14,offset:4}},{default:o(()=>[r(d,{onClick:F},{default:o(()=>t[4]||(t[4]=[v("取 消")])),_:1,__:[4]}),r(d,{type:"primary",style:{"margin-left":"16px"},loading:n.value,onClick:D(N,["prevent"])},{default:o(()=>t[5]||(t[5]=[v("下一步")])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1})])])}}},Ba=J(G,[["__scopeId","data-v-c27bd315"]]);export{Ba as default};
