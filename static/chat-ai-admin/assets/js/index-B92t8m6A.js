import{K as Ae,p as $e,q as G,t as la,v as na,w as Et,x as Je,P as Me,y as sa,z as Rt,A as oa,C as ot,F as ia,G as ra,H as da,J as ua,L as Lt,N as ca,O as it,Q as rt,S as _a,T as pa,U as va,b as he,f as ma,V as fa,M as fe,k as ie,W as Kt,n as Ve,X as ft,Y as ha,r as ga,Z as Nt,B as Ge,E as Be,$ as ya,a0 as At,d as ba,a1 as ka,a2 as wa,a3 as xa,a4 as Ca,a5 as Sa,a6 as $a,a7 as La,a8 as Da}from"../../index-CvfGQnmW.js";import{a as Ia,p as Oa,e as ht,d as D,b as Q,w as Ke,s as be,j as e,x as qe,G as Ce,h as gt,ac as Re,ad as Ta,N as T,O as b,F as _e,a1 as ze,a5 as Mt,_ as F,u as Y,U as l,S as oe,X as r,z as pe,W as ye,Z as P,a6 as te,a0 as Ye,q as Pa}from"./vue-chunks-BRsu9_To.js";import{_ as Va}from"./cu-scroll-B_WJBedC.js";import{g as jt}from"./index-8-RdvZT5.js";import{g as Ft}from"./index-ZXKXzZnJ.js";import{v as Ut}from"./validate-8MtiUsxW.js";import{F as Le,_ as Qe}from"./index-CeLDnZbi.js";import{P as Xe}from"./PlusOutlined-BsYDRa8m.js";import{_ as Ea}from"./index-Dktj88pM.js";import{d as _t}from"./role_avatar-DL0r08JY.js";import{g as Ze,a as Ht,b as Ra,s as Ka,d as Na,c as Aa,e as Ma,f as ja,h as Fa}from"./index-C_N0YJ9k.js";import"./index-DUS5CIPm.js";import{I as yt}from"./Input-DT-w6V-X.js";import{u as Ua,b as Ha,c as Ba,d as za,e as Wa,t as Dt,B as Ya,f as qa,g as Ja,h as Ga,S as Bt,a as zt}from"./index-Bic_ld4j.js";import{T as Qa,g as Xa,r as Za,_ as el}from"./index-CteniEgA.js";import{c as tl,a as pt,u as al}from"./useMaxLevel-CGODDmyb.js";import{u as It,C as dt}from"./CheckOutlined-N7bppPAu.js";import{u as ll,F as nl}from"./FormItemContext-CFzzmp00.js";import{g as sl,a as ol}from"./index-B0doyz59.js";import{g as il}from"./index-BNsyVryY.js";import"./index-ESeBgLel.js";import{_ as bt,R as Wt,a as rl}from"./RadioButton-Bh1r7hrP.js";import{D as dl}from"./dayjs-CXIbBuBE.js";import{_ as Yt,E as ul}from"./Password-Bl0n4Nu8.js";import{_ as qt}from"./index-B-jnfcw2.js";import{a as et,_ as kt}from"./index-SYniNczA.js";import{_ as wt}from"./Search-BVbdzfe3.js";import"./index-XnBLv09r.js";import{D as Jt}from"./dropdown-JwPNtE5e.js";import{M as cl}from"./MoreOutlined-CKee9gRv.js";import{M as Gt,_ as Qt}from"./index-Cn6_tPQQ.js";import{C as _l}from"./CaretDownOutlined-CGSacOH8.js";import{_ as Xt}from"./index-B-ykUzgY.js";import{_ as pl}from"./index-Cj1xldbi.js";import{D as vl}from"./DownOutlined-DKJ0lkJp.js";import{U as ml}from"./UserOutlined-CvUaVWRq.js";import{E as fl}from"./EditOutlined-CGnEZrbQ.js";import{Q as ut}from"./QuestionCircleOutlined-DsT-V90y.js";import{_ as hl}from"./index-ChS1NVDw.js";import{_ as xt}from"./index-BjEoDhm5.js";import{_ as gl}from"./TextArea-B40Dha8W.js";import{_ as yl,C as bl}from"./index-C_DWe9ZR.js";import{_ as kl,a as wl}from"./index-BADD93sS.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./Trigger-C5a0DMKm.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-C_BoBcyP.js";import"./responsiveObserve-4wudV-W8.js";import"./collapseMotion-Brd6xpAT.js";import"./DownloadOutlined-D6_CmJ5K.js";import"./inputProps-DJXIqADS.js";import"./slide-vrDadJH3.js";import"./index-DaOSj_2K.js";import"./SearchOutlined-B9P7O4A9.js";import"./move-CunrTozH.js";import"./CaretDownFilled-D2jjQ2Qs.js";import"./Checkbox-CD3yZxoG.js";import"./index-CN9-mtWv.js";import"./index-Be8_2it1.js";import"./colors-Cy2bPHOW.js";import"./shallowequal-C0xnIuy8.js";import"./fromPairs-Dx9PT-t0.js";import"./index-MLftqXg-.js";import"./LeftOutlined-CaA0Q_W1.js";import"./RightOutlined-DQOW11d0.js";function xl(t){return Array.isArray(t)?t:t!==void 0?[t]:[]}function Cl(t){const{label:v,value:y,children:n}=t||{},i=y||"value";return{_title:v?[v]:["title","label"],value:i,key:i,children:n||"children"}}function vt(t){return t.disabled||t.disableCheckbox||t.checkable===!1}function Sl(t,v){const y=[];function n(i){i.forEach(s=>{y.push(s[v.value]);const o=s[v.children];o&&n(o)})}return n(t),y}function Ot(t){return t==null}const Zt=Symbol("TreeSelectContextPropsKey");function $l(t){return Oa(Zt,t)}function Ll(){return Ia(Zt,{})}const Dl={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Il=ht({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(t,v){let{slots:y,expose:n}=v;const i=Ua(),s=Ha(),o=Ll(),a=D(),C=Ba(()=>o.treeData,[()=>i.open,()=>o.treeData],u=>u[0]),p=Q(()=>{const{checkable:u,halfCheckedKeys:_,checkedKeys:K}=s;return u?{checked:K,halfChecked:_}:null});Ke(()=>i.open,()=>{qe(()=>{var u;i.open&&!i.multiple&&s.checkedKeys.length&&((u=a.value)===null||u===void 0||u.scrollTo({key:s.checkedKeys[0]}))})},{immediate:!0,flush:"post"});const f=Q(()=>String(i.searchValue).toLowerCase()),$=u=>f.value?String(u[s.treeNodeFilterProp]).toLowerCase().includes(f.value):!1,w=be(s.treeDefaultExpandedKeys),S=be(null);Ke(()=>i.searchValue,()=>{i.searchValue&&(S.value=Sl(Ce(o.treeData),Ce(o.fieldNames)))},{immediate:!0});const E=Q(()=>s.treeExpandedKeys?s.treeExpandedKeys.slice():i.searchValue?S.value:w.value),g=u=>{var _;w.value=u,S.value=u,(_=s.onTreeExpand)===null||_===void 0||_.call(s,u)},d=u=>{u.preventDefault()},c=(u,_)=>{let{node:K}=_;var A,U;const{checkable:L,checkedKeys:h}=s;L&&vt(K)||((A=o.onSelect)===null||A===void 0||A.call(o,K.key,{selected:!h.includes(K.key)}),i.multiple||(U=i.toggleOpen)===null||U===void 0||U.call(i,!1))},x=D(null),R=Q(()=>s.keyEntities[x.value]),B=u=>{x.value=u};return n({scrollTo:function(){for(var u,_,K=arguments.length,A=new Array(K),U=0;U<K;U++)A[U]=arguments[U];return(_=(u=a.value)===null||u===void 0?void 0:u.scrollTo)===null||_===void 0?void 0:_.call(u,...A)},onKeydown:u=>{var _;const{which:K}=u;switch(K){case Ae.UP:case Ae.DOWN:case Ae.LEFT:case Ae.RIGHT:(_=a.value)===null||_===void 0||_.onKeydown(u);break;case Ae.ENTER:{if(R.value){const{selectable:A,value:U}=R.value.node||{};A!==!1&&c(null,{node:{key:x.value},selected:!s.checkedKeys.includes(U)})}break}case Ae.ESC:i.toggleOpen(!1)}},onKeyup:()=>{}}),()=>{var u;const{prefixCls:_,multiple:K,searchValue:A,open:U,notFoundContent:L=(u=y.notFoundContent)===null||u===void 0?void 0:u.call(y)}=i,{listHeight:h,listItemHeight:k,virtual:V,dropdownMatchSelectWidth:M,treeExpandAction:z}=o,{checkable:X,treeDefaultExpandAll:J,treeIcon:m,showTreeIcon:Z,switcherIcon:Se,treeLine:j,loadData:I,treeLoadedKeys:re,treeMotion:N,onTreeLoad:ee,checkedKeys:ue}=s;if(C.value.length===0)return e("div",{role:"listbox",class:`${_}-empty`,onMousedown:d},[L]);const ke={fieldNames:o.fieldNames};return re&&(ke.loadedKeys=re),E.value&&(ke.expandedKeys=E.value),e("div",{onMousedown:d},[R.value&&U&&e("span",{style:Dl,"aria-live":"assertive"},[R.value.node.value]),e(Qa,$e($e({ref:a,focusable:!1,prefixCls:`${_}-tree`,treeData:C.value,height:h,itemHeight:k,virtual:V!==!1&&M!==!1,multiple:K,icon:m,showIcon:Z,switcherIcon:Se,showLine:j,loadData:A?null:I,motion:N,activeKey:x.value,checkable:X,checkStrictly:!0,checkedKeys:p.value,selectedKeys:X?[]:ue,defaultExpandAll:J},ke),{},{onActiveChange:B,onSelect:c,onCheck:c,onExpand:g,onLoad:ee,filterTreeNode:$,expandAction:z}),G(G({},y),{checkable:s.customSlots.treeCheckable}))])}}}),Ol="SHOW_ALL",ea="SHOW_PARENT",Ct="SHOW_CHILD";function Tt(t,v,y,n){const i=new Set(t);return v===Ct?t.filter(s=>{const o=y[s];return!(o&&o.children&&o.children.some(a=>{let{node:C}=a;return i.has(C[n.value])})&&o.children.every(a=>{let{node:C}=a;return vt(C)||i.has(C[n.value])}))}):v===ea?t.filter(s=>{const o=y[s],a=o?o.parent:null;return!(a&&!vt(a.node)&&i.has(a.key))}):t}const je=()=>null;je.inheritAttrs=!1;je.displayName="ATreeSelectNode";je.isTreeSelectNode=!0;var Tl=function(t,v){var y={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&v.indexOf(n)<0&&(y[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)v.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(y[n[i]]=t[n[i]]);return y};function Pl(t){return t&&t.type&&t.type.isTreeSelectNode}function Vl(t){function v(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return la(y).map(n=>{var i,s,o;if(!Pl(n))return null;const a=n.children||{},C=n.key,p={};for(const[K,A]of Object.entries(n.props))p[na(K)]=A;const{isLeaf:f,checkable:$,selectable:w,disabled:S,disableCheckbox:E}=p,g={isLeaf:f||f===""||void 0,checkable:$||$===""||void 0,selectable:w||w===""||void 0,disabled:S||S===""||void 0,disableCheckbox:E||E===""||void 0},d=G(G({},p),g),{title:c=(i=a.title)===null||i===void 0?void 0:i.call(a,d),switcherIcon:x=(s=a.switcherIcon)===null||s===void 0?void 0:s.call(a,d)}=p,R=Tl(p,["title","switcherIcon"]),B=(o=a.default)===null||o===void 0?void 0:o.call(a),u=G(G(G({},R),{title:c,switcherIcon:x,key:C,isLeaf:f}),g),_=v(B);return _.length&&(u.children=_),u})}return v(t)}function mt(t){if(!t)return t;const v=G({},t);return"props"in v||Object.defineProperty(v,"props",{get(){return v}}),v}function El(t,v,y,n,i,s){let o=null,a=null;function C(){function p(f){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return f.map((S,E)=>{const g=`${$}-${E}`,d=S[s.value],c=y.includes(d),x=p(S[s.children]||[],g,c),R=e(je,S,{default:()=>[x.map(B=>B.node)]});if(v===d&&(o=R),c){const B={pos:g,node:R,children:x};return w||a.push(B),B}return null}).filter(S=>S)}a||(a=[],p(n),a.sort((f,$)=>{let{node:{props:{value:w}}}=f,{node:{props:{value:S}}}=$;const E=y.indexOf(w),g=y.indexOf(S);return E-g}))}Object.defineProperty(t,"triggerNode",{get(){return C(),o}}),Object.defineProperty(t,"allCheckedNodes",{get(){return C(),i?a:a.map(p=>{let{node:f}=p;return f})}})}function Rl(t,v){let{id:y,pId:n,rootPId:i}=v;const s={},o=[];return t.map(C=>{const p=G({},C),f=p[y];return s[f]=p,p.key=p.key||f,p}).forEach(C=>{const p=C[n],f=s[p];f&&(f.children=f.children||[],f.children.push(C)),(p===i||!f&&i===null)&&o.push(C)}),o}function Kl(t,v,y){const n=be();return Ke([y,t,v],()=>{const i=y.value;t.value?n.value=y.value?Rl(Ce(t.value),G({id:"id",pId:"pId",rootPId:null},i!==!0?i:{})):Ce(t.value).slice():n.value=Vl(Ce(v.value))},{immediate:!0,deep:!0}),n}const Nl=t=>{const v=be({valueLabels:new Map}),y=be();return Ke(t,()=>{y.value=Ce(t.value)},{immediate:!0}),[Q(()=>{const{valueLabels:i}=v.value,s=new Map,o=y.value.map(a=>{var C;const{value:p}=a,f=(C=a.label)!==null&&C!==void 0?C:i.get(p);return s.set(p,f),G(G({},a),{label:f})});return v.value.valueLabels=s,o})]},Al=(t,v)=>{const y=be(new Map),n=be({});return gt(()=>{const i=v.value,s=tl(t.value,{fieldNames:i,initWrapper:o=>G(G({},o),{valueEntities:new Map}),processEntity:(o,a)=>{const C=o.node[i.value];a.valueEntities.set(C,o)}});y.value=s.valueEntities,n.value=s.keyEntities}),{valueEntities:y,keyEntities:n}},Ml=(t,v,y,n,i,s)=>{const o=be([]),a=be([]);return gt(()=>{let C=t.value.map($=>{let{value:w}=$;return w}),p=v.value.map($=>{let{value:w}=$;return w});const f=C.filter($=>!n.value[$]);y.value&&({checkedKeys:C,halfCheckedKeys:p}=pt(C,!0,n.value,i.value,s.value)),o.value=Array.from(new Set([...f,...C])),a.value=p}),[o,a]},jl=(t,v,y)=>{let{treeNodeFilterProp:n,filterTreeNode:i,fieldNames:s}=y;return Q(()=>{const{children:o}=s.value,a=v.value,C=n==null?void 0:n.value;if(!a||i.value===!1)return t.value;let p;if(typeof i.value=="function")p=i.value;else{const $=a.toUpperCase();p=(w,S)=>{const E=S[C];return String(E).toUpperCase().includes($)}}function f($){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=[];for(let E=0,g=$.length;E<g;E++){const d=$[E],c=d[o],x=w||p(a,mt(d)),R=f(c||[],x);(x||R.length)&&S.push(G(G({},d),{[o]:R}))}return S}return f(t.value)})};function ta(){return G(G({},Je(qa(),["mode"])),{prefixCls:String,id:String,value:{type:[String,Number,Object,Array]},defaultValue:{type:[String,Number,Object,Array]},onChange:{type:Function},searchValue:String,inputValue:String,onSearch:{type:Function},autoClearSearchValue:{type:Boolean,default:void 0},filterTreeNode:{type:[Boolean,Function],default:void 0},treeNodeFilterProp:String,onSelect:Function,onDeselect:Function,showCheckedStrategy:{type:String},treeNodeLabelProp:String,fieldNames:{type:Object},multiple:{type:Boolean,default:void 0},treeCheckable:{type:Boolean,default:void 0},treeCheckStrictly:{type:Boolean,default:void 0},labelInValue:{type:Boolean,default:void 0},treeData:{type:Array},treeDataSimpleMode:{type:[Boolean,Object],default:void 0},loadData:{type:Function},treeLoadedKeys:{type:Array},onTreeLoad:{type:Function},treeDefaultExpandAll:{type:Boolean,default:void 0},treeExpandedKeys:{type:Array},treeDefaultExpandedKeys:{type:Array},onTreeExpand:{type:Function},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,onDropdownVisibleChange:{type:Function},treeLine:{type:[Boolean,Object],default:void 0},treeIcon:Me.any,showTreeIcon:{type:Boolean,default:void 0},switcherIcon:Me.any,treeMotion:Me.any,children:Array,treeExpandAction:String,showArrow:{type:Boolean,default:void 0},showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:Me.any,maxTagPlaceholder:{type:Function},dropdownPopupAlign:Me.any,customSlots:Object})}function Fl(t){return!t||typeof t!="object"}const Ul=ht({compatConfig:{MODE:3},name:"TreeSelect",inheritAttrs:!1,props:Et(ta(),{treeNodeFilterProp:"value",autoClearSearchValue:!0,showCheckedStrategy:Ct,listHeight:200,listItemHeight:20,prefixCls:"vc-tree-select"}),setup(t,v){let{attrs:y,expose:n,slots:i}=v;const s=za(Re(t,"id")),o=Q(()=>t.treeCheckable&&!t.treeCheckStrictly),a=Q(()=>t.treeCheckable||t.treeCheckStrictly),C=Q(()=>t.treeCheckStrictly||t.labelInValue),p=Q(()=>a.value||t.multiple),f=Q(()=>Cl(t.fieldNames)),[$,w]=It("",{value:Q(()=>t.searchValue!==void 0?t.searchValue:t.inputValue),postState:H=>H||""}),S=H=>{var W;w(H),(W=t.onSearch)===null||W===void 0||W.call(t,H)},E=Kl(Re(t,"treeData"),Re(t,"children"),Re(t,"treeDataSimpleMode")),{keyEntities:g,valueEntities:d}=Al(E,f),c=H=>{const W=[],q=[];return H.forEach(le=>{d.value.has(le)?q.push(le):W.push(le)}),{missingRawValues:W,existRawValues:q}},x=jl(E,$,{fieldNames:f,treeNodeFilterProp:Re(t,"treeNodeFilterProp"),filterTreeNode:Re(t,"filterTreeNode")}),R=H=>{if(H){if(t.treeNodeLabelProp)return H[t.treeNodeLabelProp];const{_title:W}=f.value;for(let q=0;q<W.length;q+=1){const le=H[W[q]];if(le!==void 0)return le}}},B=H=>xl(H).map(q=>Fl(q)?{value:q}:q),u=H=>B(H).map(q=>{let{label:le}=q;const{value:de,halfChecked:se}=q;let ae;const ne=d.value.get(de);return ne&&(le=le??R(ne.node),ae=ne.node.disabled),{label:le,value:de,halfChecked:se,disabled:ae}}),[_,K]=It(t.defaultValue,{value:Re(t,"value")}),A=Q(()=>B(_.value)),U=be([]),L=be([]);gt(()=>{const H=[],W=[];A.value.forEach(q=>{q.halfChecked?W.push(q):H.push(q)}),U.value=H,L.value=W});const h=Q(()=>U.value.map(H=>H.value)),{maxLevel:k,levelEntities:V}=al(g),[M,z]=Ml(U,L,o,g,k,V),X=Q(()=>{const q=Tt(M.value,t.showCheckedStrategy,g.value,f.value).map(se=>{var ae,ne,ge;return(ge=(ne=(ae=g.value[se])===null||ae===void 0?void 0:ae.node)===null||ne===void 0?void 0:ne[f.value.value])!==null&&ge!==void 0?ge:se}).map(se=>{const ae=U.value.find(ne=>ne.value===se);return{value:se,label:ae==null?void 0:ae.label}}),le=u(q),de=le[0];return!p.value&&de&&Ot(de.value)&&Ot(de.label)?[]:le.map(se=>{var ae;return G(G({},se),{label:(ae=se.label)!==null&&ae!==void 0?ae:se.value})})}),[J]=Nl(X),m=(H,W,q)=>{const le=u(H);if(K(le),t.autoClearSearchValue&&w(""),t.onChange){let de=H;o.value&&(de=Tt(H,t.showCheckedStrategy,g.value,f.value).map(Pe=>{const We=d.value.get(Pe);return We?We.node[f.value.value]:Pe}));const{triggerValue:se,selected:ae}=W||{triggerValue:void 0,selected:void 0};let ne=de;if(t.treeCheckStrictly){const xe=L.value.filter(Pe=>!de.includes(Pe.value));ne=[...ne,...xe]}const ge=u(ne),Oe={preValue:U.value,triggerValue:se};let Te=!0;(t.treeCheckStrictly||q==="selection"&&!ae)&&(Te=!1),El(Oe,se,H,E.value,Te,f.value),a.value?Oe.checked=ae:Oe.selected=ae;const we=C.value?ge:ge.map(xe=>xe.value);t.onChange(p.value?we:we[0],C.value?null:ge.map(xe=>xe.label),Oe)}},Z=(H,W)=>{let{selected:q,source:le}=W;var de,se,ae;const ne=Ce(g.value),ge=Ce(d.value),Oe=ne[H],Te=Oe==null?void 0:Oe.node,we=(de=Te==null?void 0:Te[f.value.value])!==null&&de!==void 0?de:H;if(!p.value)m([we],{selected:!0,triggerValue:we},"option");else{let xe=q?[...h.value,we]:M.value.filter(Pe=>Pe!==we);if(o.value){const{missingRawValues:Pe,existRawValues:We}=c(xe),$t=We.map(st=>ge.get(st).key);let nt;q?{checkedKeys:nt}=pt($t,!0,ne,k.value,V.value):{checkedKeys:nt}=pt($t,{halfCheckedKeys:z.value},ne,k.value,V.value),xe=[...Pe,...nt.map(st=>ne[st].node[f.value.value])]}m(xe,{selected:q,triggerValue:we},le||"option")}q||!p.value?(se=t.onSelect)===null||se===void 0||se.call(t,we,mt(Te)):(ae=t.onDeselect)===null||ae===void 0||ae.call(t,we,mt(Te))},Se=H=>{if(t.onDropdownVisibleChange){const W={};Object.defineProperty(W,"documentClickClose",{get(){return!1}}),t.onDropdownVisibleChange(H,W)}},j=(H,W)=>{const q=H.map(le=>le.value);if(W.type==="clear"){m(q,{},"selection");return}W.values.length&&Z(W.values[0].value,{selected:!1,source:"selection"})},{treeNodeFilterProp:I,loadData:re,treeLoadedKeys:N,onTreeLoad:ee,treeDefaultExpandAll:ue,treeExpandedKeys:ke,treeDefaultExpandedKeys:Fe,onTreeExpand:De,virtual:Ue,listHeight:ve,listItemHeight:ce,treeLine:Ee,treeIcon:Ne,showTreeIcon:He,switcherIcon:O,treeMotion:me,customSlots:tt,dropdownMatchSelectWidth:at,treeExpandAction:lt}=Ta(t);Wa(Dt({checkable:a,loadData:re,treeLoadedKeys:N,onTreeLoad:ee,checkedKeys:M,halfCheckedKeys:z,treeDefaultExpandAll:ue,treeExpandedKeys:ke,treeDefaultExpandedKeys:Fe,onTreeExpand:De,treeIcon:Ne,treeMotion:me,showTreeIcon:He,switcherIcon:O,treeLine:Ee,treeNodeFilterProp:I,keyEntities:g,customSlots:tt})),$l(Dt({virtual:Ue,listHeight:ve,listItemHeight:ce,treeData:x,fieldNames:f,onSelect:Z,dropdownMatchSelectWidth:at,treeExpandAction:lt}));const Ie=D();return n({focus(){var H;(H=Ie.value)===null||H===void 0||H.focus()},blur(){var H;(H=Ie.value)===null||H===void 0||H.blur()},scrollTo(H){var W;(W=Ie.value)===null||W===void 0||W.scrollTo(H)}}),()=>{var H;const W=Je(t,["id","prefixCls","customSlots","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"]);return e(Ya,$e($e($e({ref:Ie},y),W),{},{id:s,prefixCls:t.prefixCls,mode:p.value?"multiple":void 0,displayValues:J.value,onDisplayValuesChange:j,searchValue:$.value,onSearch:S,OptionList:Il,emptyOptions:!E.value.length,onDropdownVisibleChange:Se,tagRender:t.tagRender||i.tagRender,dropdownMatchSelectWidth:(H=t.dropdownMatchSelectWidth)!==null&&H!==void 0?H:!0}),i)}}}),Hl=t=>{const{componentCls:v,treePrefixCls:y,colorBgElevated:n}=t,i=`.${y}`;return[{[`${v}-dropdown`]:[{padding:`${t.paddingXS}px ${t.paddingXS/2}px`},Xa(y,Rt(t,{colorBgContainer:n})),{[i]:{borderRadius:0,"&-list-holder-inner":{alignItems:"stretch",[`${i}-treenode`]:{[`${i}-node-content-wrapper`]:{flex:"auto"}}}}},il(`${y}-checkbox`,t),{"&-rtl":{direction:"rtl",[`${i}-switcher${i}-switcher_close`]:{[`${i}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Bl(t,v){return sa("TreeSelect",y=>{const n=Rt(y,{treePrefixCls:v.value});return[Hl(n)]})(t)}const Pt=(t,v,y)=>y!==void 0?y:`${t}-${v}`;function zl(){return G(G({},Je(ta(),["showTreeIcon","treeMotion","inputIcon","getInputElement","treeLine","customSlots"])),{suffixIcon:Me.any,size:rt(),bordered:va(),treeLine:pa([Boolean,Object]),replaceFields:_a(),placement:rt(),status:rt(),popupClassName:String,dropdownClassName:String,"onUpdate:value":it(),"onUpdate:treeExpandedKeys":it(),"onUpdate:searchValue":it()})}const ct=ht({compatConfig:{MODE:3},name:"ATreeSelect",inheritAttrs:!1,props:Et(zl(),{choiceTransitionName:"",listHeight:256,treeIcon:!1,listItemHeight:26,bordered:!0}),slots:Object,setup(t,v){let{attrs:y,slots:n,expose:i,emit:s}=v;oa(!(t.treeData===void 0&&n.default)),ot(t.multiple!==!1||!t.treeCheckable,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true"),ot(t.replaceFields===void 0,"TreeSelect","`replaceFields` is deprecated, please use fieldNames instead"),ot(!t.dropdownClassName,"TreeSelect","`dropdownClassName` is deprecated. Please use `popupClassName` instead.");const o=ll(),a=nl.useInject(),C=Q(()=>sl(a.status,t.status)),{prefixCls:p,renderEmpty:f,direction:$,virtual:w,dropdownMatchSelectWidth:S,size:E,getPopupContainer:g,getPrefixCls:d,disabled:c}=ia("select",t),{compactSize:x,compactItemClassnames:R}=ra(p,$),B=Q(()=>x.value||E.value),u=da(),_=Q(()=>{var N;return(N=c.value)!==null&&N!==void 0?N:u.value}),K=Q(()=>d()),A=Q(()=>t.placement!==void 0?t.placement:$.value==="rtl"?"bottomRight":"bottomLeft"),U=Q(()=>Pt(K.value,ua(A.value),t.transitionName)),L=Q(()=>Pt(K.value,"",t.choiceTransitionName)),h=Q(()=>d("select-tree",t.prefixCls)),k=Q(()=>d("tree-select",t.prefixCls)),[V,M]=Ja(p),[z]=Bl(k,h),X=Q(()=>Lt(t.popupClassName||t.dropdownClassName,`${k.value}-dropdown`,{[`${k.value}-dropdown-rtl`]:$.value==="rtl"},M.value)),J=Q(()=>!!(t.treeCheckable||t.multiple)),m=Q(()=>t.showArrow!==void 0?t.showArrow:t.loading||!J.value),Z=D();i({focus(){var N,ee;(ee=(N=Z.value).focus)===null||ee===void 0||ee.call(N)},blur(){var N,ee;(ee=(N=Z.value).blur)===null||ee===void 0||ee.call(N)}});const Se=function(){for(var N=arguments.length,ee=new Array(N),ue=0;ue<N;ue++)ee[ue]=arguments[ue];s("update:value",ee[0]),s("change",...ee),o.onFieldChange()},j=N=>{s("update:treeExpandedKeys",N),s("treeExpand",N)},I=N=>{s("update:searchValue",N),s("search",N)},re=N=>{s("blur",N),o.onFieldBlur()};return()=>{var N,ee,ue;const{notFoundContent:ke=(N=n.notFoundContent)===null||N===void 0?void 0:N.call(n),prefixCls:Fe,bordered:De,listHeight:Ue,listItemHeight:ve,multiple:ce,treeIcon:Ee,treeLine:Ne,showArrow:He,switcherIcon:O=(ee=n.switcherIcon)===null||ee===void 0?void 0:ee.call(n),fieldNames:me=t.replaceFields,id:tt=o.id.value,placeholder:at=(ue=n.placeholder)===null||ue===void 0?void 0:ue.call(n)}=t,{isFormItemInput:lt,hasFeedback:Ie,feedbackIcon:H}=a,{suffixIcon:W,removeIcon:q,clearIcon:le}=Ga(G(G({},t),{multiple:J.value,showArrow:m.value,hasFeedback:Ie,feedbackIcon:H,prefixCls:p.value}),n);let de;ke!==void 0?de=ke:de=f("Select");const se=Je(t,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon","bordered","status","onUpdate:value","onUpdate:treeExpandedKeys","onUpdate:searchValue"]),ae=Lt(!Fe&&k.value,{[`${p.value}-lg`]:B.value==="large",[`${p.value}-sm`]:B.value==="small",[`${p.value}-rtl`]:$.value==="rtl",[`${p.value}-borderless`]:!De,[`${p.value}-in-form-item`]:lt},ol(p.value,C.value,Ie),R.value,y.class,M.value),ne={};return t.treeData===void 0&&n.default&&(ne.children=ca(n.default())),V(z(e(Ul,$e($e($e($e({},y),se),{},{disabled:_.value,virtual:w.value,dropdownMatchSelectWidth:S.value,id:tt,fieldNames:me,ref:Z,prefixCls:p.value,class:ae,listHeight:Ue,listItemHeight:ve,treeLine:!!Ne,inputIcon:W,multiple:ce,removeIcon:q,clearIcon:le,switcherIcon:ge=>Za(h.value,O,ge,n.leafIcon,Ne),showTreeIcon:Ee,notFoundContent:de,getPopupContainer:g==null?void 0:g.value,treeMotion:null,dropdownClassName:X.value,choiceTransitionName:L.value,onChange:Se,onBlur:re,onSearch:I,onTreeExpand:j},ne),{},{transitionName:U.value,customSlots:G(G({},n),{treeCheckable:()=>e("span",{class:`${p.value}-tree-checkbox-inner`},null)}),maxTagPlaceholder:t.maxTagPlaceholder||n.maxTagPlaceholder,placement:A.value,showArrow:Ie||He,placeholder:at}),G(G({},n),{treeCheckable:()=>e("span",{class:`${p.value}-tree-checkbox-inner`},null)}))))}}}),Vt=je,St=G(ct,{TreeNode:je,SHOW_ALL:Ol,SHOW_PARENT:ea,SHOW_CHILD:Ct,install:t=>(t.component(ct.name,ct),t.component(Vt.displayName,Vt),t)}),Wl={class:"page-tabs"},Yl=["onClick"],ql={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(t,{emit:v}){const{t:y}=ma(),n=v,i=t,s=D([{value:1,title:y("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"},{value:0,title:y("views.user.model.rolePermissions"),langKey:"views.user.model.rolePermissions"}]),o=a=>{n("update:value",a),n("change",a)};return(a,C)=>(b(),T("div",Wl,[(b(!0),T(_e,null,ze(s.value,p=>(b(),T("div",{class:Mt(["tab-item",{active:i.value==p.value}]),onClick:f=>o(p.value),key:p.value},F(Y(y)(p.langKey)),11,Yl))),128))]))}},Jl=he(ql,[["__scopeId","data-v-e344f7b9"]]),Gl={class:"avatar-uploader"},Ql=["src"],Xl={key:1},Zl=["src"],en={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(t,{emit:v}){function y(d){return new Promise((c,x)=>{const R=new FileReader;R.readAsDataURL(d),R.onload=()=>c(R.result),R.onerror=B=>x(B)})}const n=v,i=t,s=D([]),o=D(!1),a=D("");Ke(()=>i.value,d=>{a.value=d},{immediate:!0});const C=Le.useInjectFormItemContext(),p=()=>{let d={imageUrl:a.value,file:s.value[0].originFileObj};n("change",d),n("update:value",d.imageUrl),C.onFieldChange()},f=d=>d.type==="image/jpeg"||d.type==="image/png"?d.size/1024<1024?(s.value=[d],y(d).then(R=>{a.value=R,o.value=!1,p()}),!1):(ie.error("成员头像图片大小不能超过1M"),!1):(ie.error("机器人头像只支持JPG、PNG格式的图片"),!1),$=D(!1),w=D(""),S=D(""),E=()=>{$.value=!1,S.value=""},g=async d=>{!d.url&&!d.preview&&(d.preview=await y(d.originFileObj)),w.value=d.url||d.preview,$.value=!0,S.value=d.name||d.url.substring(d.url.lastIndexOf("/")+1)};return(d,c)=>{const x=Ea,R=fe;return b(),T("div",Gl,[e(x,{"file-list":s.value,"onUpdate:fileList":c[0]||(c[0]=B=>s.value=B),"list-type":"picture-card","show-upload-list":!1,"before-upload":f,accept:".jpg,.png,.jpeg",onPreview:g},{default:l(()=>[a.value?(b(),T("img",{key:0,class:"avatar",src:a.value,alt:"avatar"},null,8,Ql)):(b(),T("div",Xl,[o.value?(b(),oe(Y(fa),{key:0})):(b(),oe(Y(Xe),{key:1})),c[1]||(c[1]=r("div",{class:"ant-upload-text"},"上传照片",-1))]))]),_:1},8,["file-list"]),e(R,{open:$.value,title:S.value,footer:null,onCancel:E},{default:l(()=>[r("img",{alt:"example",style:{width:"100%"},src:w.value},null,8,Zl)]),_:1},8,["open","title"])])}}},tn=he(en,[["__scopeId","data-v-1945844c"]]),an={class:"form-box"},ln={class:"avatar-box"},nn={class:"flex-item-box"},sn={class:"flex-item-box"},on={class:"flex-item-box"},rn={class:"flex-item-box"},dn={key:0,style:{"margin-top":"4px"}},un={__name:"add-team-members",emits:["ok"],setup(t,{expose:v,emit:y}){const n=y,i=Le.useForm,s=D(!1),o=D("添加团队成员"),a=pe({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",department_ids:[],expire_time_type:0,expire_time:"",id:""}),C=D([]),p=()=>{Ze({}).then(u=>{let _=u.data||[];C.value=ft(_)})},f=u=>{a.avatar=u.file},$=D([]);Kt({page:1,size:200,search:""}).then(u=>{let _=u.data.list||[];$.value=_.filter(K=>K.id!="1"&&K.role_type!=1)});const w=pe({user_name:[{message:"请输入登录账号",required:!0},{validator:async(u,_)=>!/^[a-zA-Z0-9_.-]+$/.test(_)&&_?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(u,_)=>!Ut(_)&&_?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(u,_)=>_!=a.password&&_?Promise.reject("两次输入的密码不一致"):Promise.resolve()}],expire_time:[{validator:async(u,_)=>a.expire_time_type==1&&!_?Promise.reject("请选择指定日期"):Promise.resolve()}],department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:S,validate:E,validateInfos:g}=i(a,w),d=u=>{o.value="添加团队成员",s.value=!0,S(),a.user_name="",a.nick_name="",a.avatar="",a.avatar_url=_t,a.user_roles="3",a.password="",a.check_password="",a.expire_time_type=0,a.expire_time="",a.department_ids=u?[u]:[],a.id="",p()},c=u=>{o.value="编辑团队成员",a.user_name=u.user_name,a.nick_name=u.nick_name,a.avatar_url=u.avatar||_t,a.avatar="",a.user_roles=u.user_roles,a.password="",a.check_password="",a.id=u.id,u.expire_time>0?(a.expire_time_type=1,a.expire_time=Ve(u.expire_time*1e3)):(a.expire_time_type=0,a.expire_time=""),a.department_ids=u.departments.map(_=>+_.id),delete w.password,delete w.check_password,s.value=!0,p()},x=D(!1),R=()=>{E().then(()=>{let u={...Ce(a)};u.expire_time_type==1?u.expire_time=Ve(u.expire_time).unix():u.expire_time=0,u.department_ids=a.department_ids.join(","),delete u.avatar_url,x.value=!0,ha(u).then(_=>{ie.success(`${o.value}成功`),s.value=!1,n("ok")}).finally(()=>{x.value=!1})})},B=u=>u&&u<Ve().startOf("day");return v({add:d,edit:c}),(u,_)=>{const K=yt,A=Qe,U=zt,L=Bt,h=St,k=Yt,V=Wt,M=bt,z=dl,X=Le,J=fe;return b(),T("div",null,[e(J,{open:s.value,"onUpdate:open":_[9]||(_[9]=m=>s.value=m),title:o.value,onOk:R,width:"746px"},{default:l(()=>[r("div",an,[r("div",ln,[e(tn,{value:a.avatar_url,"onUpdate:value":_[0]||(_[0]=m=>a.avatar_url=m),onChange:f},null,8,["value"]),_[10]||(_[10]=r("div",{class:"tip"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),e(X,{layout:"vertical",autocomplete:"off"},{default:l(()=>[r("div",nn,[e(A,ye({label:"成员昵称"},Y(g).nick_name),{default:l(()=>[e(K,{maxlength:100,type:"text",placeholder:"请输入昵称",value:a.nick_name,"onUpdate:value":_[1]||(_[1]=m=>a.nick_name=m)},null,8,["value"])]),_:1},16),e(A,ye({label:"登录账号"},Y(g).user_name),{default:l(()=>[e(K,{disabled:a.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:a.user_name,"onUpdate:value":_[2]||(_[2]=m=>a.user_name=m)},null,8,["disabled","value"])]),_:1},16)]),r("div",sn,[e(A,ye({label:"成员角色"},Y(g).user_roles),{default:l(()=>[e(L,{value:a.user_roles,"onUpdate:value":_[3]||(_[3]=m=>a.user_roles=m),style:{width:"100%"},placeholder:"请选择成员角色"},{default:l(()=>[(b(!0),T(_e,null,ze($.value,m=>(b(),oe(U,{key:m.id,value:m.id},{default:l(()=>[P(F(m.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),e(A,ye({label:"选择部门"},Y(g).department_ids,{name:"department_ids"}),{default:l(()=>[e(h,{value:a.department_ids,"onUpdate:value":_[4]||(_[4]=m=>a.department_ids=m),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":C.value,"tree-node-filter-prop":"label"},{title:l(({value:m,label:Z})=>[r("div",null,F(Z),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),r("div",on,[a.id?te("",!0):(b(),oe(A,ye({key:0,label:"登录密码"},Y(g).password),{default:l(()=>[e(k,{value:a.password,"onUpdate:value":_[5]||(_[5]=m=>a.password=m),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),a.id?te("",!0):(b(),oe(A,ye({key:1,label:"确认密码"},Y(g).check_password),{default:l(()=>[e(k,{value:a.check_password,"onUpdate:value":_[6]||(_[6]=m=>a.check_password=m),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),r("div",rn,[e(A,ye({label:"过期时间"},Y(g).expire_time,{required:""}),{default:l(()=>[e(M,{value:a.expire_time_type,"onUpdate:value":_[7]||(_[7]=m=>a.expire_time_type=m)},{default:l(()=>[e(V,{value:0},{default:l(()=>_[11]||(_[11]=[P("永久有效")])),_:1,__:[11]}),e(V,{value:1},{default:l(()=>_[12]||(_[12]=[P("指定时间")])),_:1,__:[12]})]),_:1},8,["value"]),a.expire_time_type==1?(b(),T("div",dn,[e(z,{showNow:!1,format:"YYYY-MM-DD HH:mm","disabled-date":B,value:a.expire_time,"onUpdate:value":_[8]||(_[8]=m=>a.expire_time=m),"show-time":{defaultValue:Y(Ve)("00:00","HH:mm")}},null,8,["value","show-time"])])):te("",!0)]),_:1},16)])]),_:1})])]),_:1},8,["open","title"])])}}},cn=he(un,[["__scopeId","data-v-04881526"]]),_n={class:"form-box"},pn={__name:"reset-password",emits:["ok"],setup(t,{expose:v,emit:y}){const n=y,i=Le.useForm,s=D(!1),o=D("重置登录密码"),a=pe({password:"",check_password:"",id:""}),C=pe({password:[{message:"请输入登录密码",required:!0},{validator:async(E,g)=>!Ut(g)&&g?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(E,g)=>g!=a.password&&g?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:p,validate:f,validateInfos:$}=i(a,C),w=E=>{E.id,s.value=!0,p(),a.password="",a.check_password="",a.id=E.id},S=()=>{f().then(()=>{ga({...Ce(a)}).then(E=>{ie.success("修改成功"),s.value=!1,n("ok")})})};return v({open:w}),(E,g)=>{const d=Yt,c=Qe,x=Le,R=fe;return b(),T("div",null,[e(R,{open:s.value,"onUpdate:open":g[2]||(g[2]=B=>s.value=B),title:o.value,onOk:S,width:"476px"},{default:l(()=>[r("div",_n,[e(x,{layout:"vertical"},{default:l(()=>[e(c,ye({label:"登录密码"},Y($).password),{default:l(()=>[e(d,{value:a.password,"onUpdate:value":g[0]||(g[0]=B=>a.password=B),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),e(c,ye({label:"确认密码"},Y($).check_password),{default:l(()=>[e(d,{value:a.check_password,"onUpdate:value":g[1]||(g[1]=B=>a.check_password=B),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},vn=he(pn,[["__scopeId","data-v-8c704fed"]]),mn={key:0,class:"form-wrapper"},fn={class:"select"},hn={class:"tools-wrapper"},gn=["src"],yn={class:"item-name"},bn={key:1,class:"form-wrapper"},kn={class:"main-tabs-box"},wn={class:"select"},xn={class:"tools-wrapper"},Cn={class:"item-name"},Sn={class:"tools-wrapper"},$n={class:"item-name"},Ln={key:2,class:"form-wrapper"},Dn={class:"select"},In={class:"tools-wrapper"},On={class:"item-name"},Tn={__name:"see-model-alert",props:{robotList:{type:Array,default:()=>[]},libraryList:{type:Array,default:()=>[]},formList:{type:Array,default:()=>[]}},emits:["save","ok"],setup(t,{expose:v,emit:y}){const n=y,i=t,s=D([]),o=D(""),a=D(!1),C=D([]),p=D([]),f=L=>{const h=[];return L.map(k=>{h.push(k.id)}),h},$=L=>{s.value=L},w=D(1),S=[{value:2,payload:{title:"部门知识库"}},{value:1,payload:{title:"成员知识库"}}],E=D(S);let g=null;const d=D(1),c=D(1),x=D(),R=async(L,h,k)=>{s.value=[],d.value=L,c.value=1,w.value=1,g=JSON.parse(JSON.stringify(k)),x.value=g.id,k=JSON.parse(JSON.stringify(k)),E.value=S,k.managed_robot_list=k.managed_robot_list||[],k.managed_library_list=k.managed_library_list||[],k.managed_form_list=k.managed_form_list||[];let V=[];L==1?(o.value="添加成员管理的机器人",V=i.robotList,V.forEach(M=>{let z=k.managed_robot_list.filter(X=>X.id==M.id);z.length?M.operate_rights=z[0].operate_rights:M.operate_rights="4"}),h&&h=="edit"&&(o.value="编辑成员管理的机器人",s.value=f(k.managed_robot_list))):L==2?(o.value="添加成员管理的知识库",V=i.libraryList,V.forEach(M=>{let z=k.managed_library_list.filter(X=>X.id==M.id);z.length?M.operate_rights=z[0].operate_rights:M.operate_rights="4"}),h&&h=="edit"&&(o.value="编辑成员管理的知识库",s.value=f(k.managed_library_list))):L==3&&(o.value="添加成员管理的数据库",V=i.formList,V.forEach(M=>{let z=k.managed_form_list.filter(X=>X.id==M.id);z.length?M.operate_rights=z[0].operate_rights:M.operate_rights="4"}),h&&h=="edit"&&(o.value="编辑成员管理的数据库",s.value=f(k.managed_form_list))),C.value=V,a.value=!0},B=()=>{Ht({object_type:d.value,identity_type:c.value,identity_id:x.value,tab:c.value}).then(L=>{p.value=L.data||[]})},u=()=>{w.value==2&&B()},_=(L,h)=>{s.value=[],c.value=1,w.value=1,d.value=L,x.value=h;let k=[];L==1?(o.value="批量修改成员管理的机器人",k=i.robotList):L==2?(o.value="批量修改成员管理的知识库",k=i.libraryList):L==3&&(o.value="批量修改成员管理的数据库",k=i.formList),k.forEach(V=>{V.operate_rights="4"}),C.value=k,a.value=!0},K=(L,h,k)=>{s.value=[],h.is_user?c.value=1:c.value=2,x.value=h.id,E.value=[{value:2,payload:{title:c.value==1?"部门知识库":"上级知识库"}},{value:1,payload:{title:c.value==1?"成员知识库":"部门知识库"}}],w.value=1,d.value=L;let V=[];L==1?(o.value=`添加${c==1?"成员":"部门"}管理的机器人`,V=i.robotList):L==2?(o.value=`添加${c==1?"成员":"部门"}管理的知识库`,V=i.libraryList):L==3&&(o.value=`添加${c==1?"成员":"部门"}管理的数据库`,V=i.formList),V.forEach(M=>{let z=k.filter(X=>X.object_id==M.id);z.length?M.operate_rights=z[0].operate_rights:M.operate_rights="4"}),s.value=k.map(M=>M.object_id),C.value=V,a.value=!0},A=()=>{let L={identity_ids:x.value,identity_type:c.value,object_type:d.value},h=[];C.value.forEach(k=>{s.value.includes(k.id)&&h.push({object_id:+k.id,object_type:+d.value,operate_rights:+k.operate_rights})}),L.object_array=JSON.stringify(h),Ra(L).then(k=>{a.value=!1,ie.success("保存成功"),n("ok")})},U=()=>{};return v({open:R,handleBatchOpen:_,handleDepartmentOpen:K}),(L,h)=>{const k=kt,V=Wt,M=bt,z=et,X=qt,J=fe;return b(),oe(J,{class:"add-model-alert",width:"800px",open:a.value,"onUpdate:open":h[1]||(h[1]=m=>a.value=m),title:o.value,onOk:A,onCancel:U},{default:l(()=>[d.value==1?(b(),T("div",mn,[r("div",fn,"已选择("+F(s.value.length)+")",1),e(z,{"data-source":C.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:$}},{default:l(()=>[e(k,{title:"机器人","data-index":"robot_name",width:350},{default:l(({record:m})=>[r("div",hn,[r("img",{class:"model-logo",src:m.robot_avatar,alt:""},null,8,gn),r("div",yn,F(m.robot_name),1)])]),_:1}),e(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[e(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[e(V,{value:"4"},{default:l(()=>h[2]||(h[2]=[P("管理")])),_:1,__:[2]}),e(V,{value:"2"},{default:l(()=>h[3]||(h[3]=[P("编辑")])),_:1,__:[3]}),e(V,{value:"1"},{default:l(()=>h[4]||(h[4]=[P("查看")])),_:1,__:[4]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):d.value==2?(b(),T("div",bn,[r("div",kn,[e(X,{value:w.value,"onUpdate:value":h[0]||(h[0]=m=>w.value=m),options:E.value,onChange:u},{label:l(({payload:m})=>[P(F(m.title),1)]),_:1},8,["value","options"])]),w.value==1?(b(),T(_e,{key:0},[r("div",wn,"已选择("+F(s.value.length)+")",1),e(z,{"data-source":C.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:$}},{default:l(()=>[e(k,{title:"知识库","data-index":"library_name",width:350},{default:l(({record:m})=>[r("div",xn,[r("div",Cn,F(m.library_name),1)])]),_:1}),e(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[e(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[e(V,{value:"4"},{default:l(()=>h[5]||(h[5]=[P("管理")])),_:1,__:[5]}),e(V,{value:"2"},{default:l(()=>h[6]||(h[6]=[P("编辑")])),_:1,__:[6]}),e(V,{value:"1"},{default:l(()=>h[7]||(h[7]=[P("查看")])),_:1,__:[7]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])],64)):(b(),oe(z,{key:1,"data-source":p.value,pagination:!1,scroll:{y:500},"row-key":"id"},{default:l(()=>[e(k,{title:"知识库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",Sn,[r("div",$n,F(m.name),1)])]),_:1}),e(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[e(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z,disabled:""},{default:l(()=>[e(V,{value:"4"},{default:l(()=>h[8]||(h[8]=[P("管理")])),_:1,__:[8]}),e(V,{value:"2"},{default:l(()=>h[9]||(h[9]=[P("编辑")])),_:1,__:[9]}),e(V,{value:"1"},{default:l(()=>h[10]||(h[10]=[P("查看")])),_:1,__:[10]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source"]))])):d.value==3?(b(),T("div",Ln,[r("div",Dn,"已选择("+F(s.value.length)+")",1),e(z,{"data-source":C.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:$}},{default:l(()=>[e(k,{title:"数据库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",In,[r("div",On,F(m.name),1)])]),_:1}),e(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[e(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[e(V,{value:"4"},{default:l(()=>h[11]||(h[11]=[P("管理")])),_:1,__:[11]}),e(V,{value:"2"},{default:l(()=>h[12]||(h[12]=[P("编辑")])),_:1,__:[12]}),e(V,{value:"1"},{default:l(()=>h[13]||(h[13]=[P("查看")])),_:1,__:[13]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):te("",!0)]),_:1},8,["open","title"])}}},aa=he(Tn,[["__scopeId","data-v-e46dd298"]]),Pn={class:"form-box"},Vn={class:"form-item"},En={class:"form-content"},Rn={key:0,class:"form-item"},Kn={class:"form-content"},Nn={__name:"add-department",emits:["ok"],setup(t,{expose:v,emit:y}){const n=D(!1),i=y,s=pe({department_name:"",id:"",pid:""}),o=D(""),a=w=>{s.id="",s.pid=w.id>0?w.id||"":void 0,s.department_name="",o.value="添加部门",n.value=!0,f()},C=w=>{s.id=w.id||"",s.pid=w.pid||"",s.department_name=w.title||"",o.value="重命名",n.value=!0},p=D([]),f=()=>{Ze({}).then(w=>{let S=w.data||[];p.value=ft(S)})},$=()=>{if(!s.department_name)return ie.error("请输入部门名称");if(!s.id&&!s.pid)return ie.error("请选择所属部门");Ka({...s}).then(w=>{ie.success("修改成功"),n.value=!1,i("ok")})};return v({show:a,rename:C}),(w,S)=>{const E=yt,g=St,d=fe;return b(),T("div",null,[e(d,{open:n.value,"onUpdate:open":S[2]||(S[2]=c=>n.value=c),title:o.value,onOk:$,width:472},{default:l(()=>[r("div",Pn,[r("div",Vn,[S[3]||(S[3]=r("div",{class:"form-label"},"部门名称",-1)),r("div",En,[e(E,{maxLength:10,value:s.department_name,"onUpdate:value":S[0]||(S[0]=c=>s.department_name=c),placeholder:"请输入部门名称"},null,8,["value"])])]),s.id?te("",!0):(b(),T("div",Rn,[S[4]||(S[4]=r("div",{class:"form-label"},"所属部门",-1)),r("div",Kn,[e(g,{value:s.pid,"onUpdate:value":S[1]||(S[1]=c=>s.pid=c),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":p.value,"tree-node-filter-prop":"label"},{title:l(({value:c,label:x})=>[r("div",null,F(x),1)]),_:1},8,["value","tree-data"])])]))])]),_:1},8,["open","title"])])}}},An=he(Nn,[["__scopeId","data-v-29565254"]]),Mn={class:"del-box"},jn={class:"icon-box"},Fn={class:"footer-btn"},Un={class:"set-box"},Hn={class:"set-item"},Bn={__name:"del-department",emits:["ok"],setup(t,{expose:v,emit:y}){const n=D(!1),i=D(!1),s=y,o=pe({id:"",new_department_id:void 0});let a=[];const C=g=>{if(a=[],a=p(g),o.new_department_id=void 0,o.id=g.id,g.children.length==0){fe.confirm({title:"提示",icon:e(Be),content:"确定删除该部门",onOk(){w()}});return}n.value=!0,E()};function p(g){let d=[g.id];if(g.children&&g.children.length>0)for(const c of g.children)d=d.concat(p(c));return d}const f=()=>{i.value=!0},$=()=>{o.new_department_id="",w()},w=()=>{Na({...o}).then(g=>{i.value=!1,n.value=!1,ie.success("删除成功"),s("ok",o.id)})},S=D([]),E=()=>{Aa().then(g=>{let d=g.data||[];S.value=d.filter(c=>!a.includes(+c.id))})};return v({show:C}),(g,d)=>{const c=Ge,x=fe,R=zt,B=Bt;return b(),T("div",null,[e(x,{open:n.value,"onUpdate:open":d[1]||(d[1]=u=>n.value=u),title:null,footer:null,width:480,closable:!1},{default:l(()=>[r("div",Mn,[r("div",jn,[e(Y(Nt))]),d[7]||(d[7]=r("div",{class:"top-title"},"删除部门",-1)),d[8]||(d[8]=r("div",{class:"content"}," 确认删除部门么？直接删除后，该部门成员归属到默认部门或设置新的部门 ",-1)),r("div",Fn,[e(c,{onClick:d[0]||(d[0]=u=>n.value=!1)},{default:l(()=>d[4]||(d[4]=[P("关闭")])),_:1,__:[4]}),e(c,{danger:"",onClick:$},{default:l(()=>d[5]||(d[5]=[P("直接删除")])),_:1,__:[5]}),e(c,{type:"primary",onClick:f},{default:l(()=>d[6]||(d[6]=[P("删除并设置")])),_:1,__:[6]})])])]),_:1},8,["open"]),e(x,{open:i.value,"onUpdate:open":d[3]||(d[3]=u=>i.value=u),title:"设置部门",width:472,onOk:w},{default:l(()=>[r("div",Un,[d[10]||(d[10]=r("div",{class:"set-desc"},"删除之前请先将之前部门的成员换到其他团队",-1)),r("div",Hn,[d[9]||(d[9]=r("div",{class:"set-label"},"所属部门",-1)),r("div",null,[e(B,{value:o.new_department_id,"onUpdate:value":d[2]||(d[2]=u=>o.new_department_id=u),style:{width:"100%"},placeholder:"请选择"},{default:l(()=>[(b(!0),T(_e,null,ze(S.value,u=>(b(),oe(R,{key:u.id,value:u.id},{default:l(()=>[P(F(u.department_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])]),_:1},8,["open"])])}}},zn=he(Bn,[["__scopeId","data-v-5221bb6a"]]),Wn={class:"department-tree-search"},Yn={class:"flex-block"},qn={class:"tree-list-box"},Jn={style:{"margin-right":"4px"}},Gn={class:"action-btn toggle-btn"},Qn={class:"doc-item"},Xn={key:0,class:"tree-title"},Zn={style:{color:"#f50"}},es={style:{color:"#f50"}},ts={key:1,class:"tree-title"},as={class:"use-num"},ls={key:2,class:"doc-action-box"},ns={__name:"department-tree",emits:["select","save","refresh"],setup(t,{expose:v,emit:y}){const n=y;let i=[];const s=[],o=(L,h)=>{let k;for(let V=0;V<h.length;V++){const M=h[V];M.children&&(M.children.some(z=>z.key===L)?k=M.key:o(L,M.children)&&(k=o(L,M.children)))}return k},a=D([]),C=D([]),p=D(""),f=D(!0),$=D([]);let w="",S={};const E=L=>{a.value=L,f.value=!1};Ke(p,L=>{const h=s.map(k=>k.title.indexOf(L)>-1?o(k.key,$.value):null).filter((k,V,M)=>k&&M.indexOf(k)===V);a.value=h,p.value=L,f.value=!0});const g=L=>{for(let h=0;h<L.length;h++){const k=L[h],V=k.key;s.push({key:V,title:k.title}),k.children&&g(k.children)}},d=L=>{Ze({}).then(h=>{let k=h.data||[];i=[],i=ya(k),g(i),$.value=i,L&&(k.forEach(V=>{V.is_default==1&&(w=V.id,S=V)}),qe(()=>{w&&(C.value=[w],n("select",S))}))})};d(!0);let c={};const x=L=>{C.value[0]==L?qe(()=>{w&&(C.value=[w],n("select",S))}):n("refresh"),d()},R=D(),B=L=>{R.value.show(L)},u=L=>{R.value.rename(L)},_=(L,h)=>{h.node.is_user,h.node.id,h.selected||qe(()=>{C.value=[h.node.id]}),c={...h.node},n("select",c)},K=D(null),A=L=>{K.value.show(L)},U=()=>{d(),n("refresh")};return v({getLists:d}),(L,h)=>{const k=wt,V=Xt,M=Qt,z=Gt,X=Jt,J=el;return b(),T(_e,null,[r("div",Wn,[r("div",Yn,[e(k,{value:p.value,"onUpdate:value":h[0]||(h[0]=m=>p.value=m),placeholder:"搜索部门",style:{flex:"1"}},null,8,["value"]),r("div",{class:"add-btn-box",onClick:h[1]||(h[1]=m=>B({}))},[e(Y(Xe))])]),r("div",qn,[e(J,{"expanded-keys":a.value,selectedKeys:C.value,"onUpdate:selectedKeys":h[3]||(h[3]=m=>C.value=m),"auto-expand-parent":f.value,onSelect:_,"tree-data":$.value,blockNode:"",onExpand:E},{switcherIcon:l(({switcherCls:m})=>[r("div",Jn,[r("span",Gn,[e(Y(_l),{style:{"font-size":"12px"},class:Mt(m)},null,8,["class"])])])]),title:l(m=>[r("div",Qn,[m.title.indexOf(p.value)>-1&&p.value?(b(),T("span",Xn,[m.title.length>3&&m.level>3?(b(),oe(V,{key:0},{title:l(()=>[P(F(m.title),1)]),default:l(()=>[P(" "+F(m.title.substring(0,m.title.indexOf(p.value)))+" ",1),r("span",Zn,F(p.value),1),P(" "+F(m.title.substring(m.title.indexOf(p.value)+p.value.length)),1)]),_:2},1024)):(b(),T(_e,{key:1},[P(F(m.title.substring(0,m.title.indexOf(p.value)))+" ",1),r("span",es,F(p.value),1),P(" "+F(m.title.substring(m.title.indexOf(p.value)+p.value.length)),1)],64))])):(b(),T("span",ts,[m.title.length>3&&m.level>3?(b(),oe(V,{key:0},{title:l(()=>[P(F(m.title),1)]),default:l(()=>[P(" "+F(m.title),1)]),_:2},1024)):(b(),T(_e,{key:1},[P(F(m.title),1)],64))])),r("div",as,F(m.children_nums),1),m.is_user?te("",!0):(b(),T("div",ls,[e(X,null,{overlay:l(()=>[e(z,null,{default:l(()=>[e(M,{key:"addDoc",onClick:Ye(Z=>B(m),["stop","prevent"])},{default:l(()=>h[4]||(h[4]=[r("span",{class:"menu-name"},"添加子部门",-1)])),_:2,__:[4]},1032,["onClick"]),e(M,{key:"importDoc",onClick:Ye(Z=>u(m),["stop","prevent"])},{default:l(()=>h[5]||(h[5]=[r("span",{class:"menu-name"},"重命名",-1)])),_:2,__:[5]},1032,["onClick"]),m.is_default!=1?(b(),oe(M,{key:"del",onClick:Ye(Z=>A(m),["stop","prevent"])},{default:l(()=>h[6]||(h[6]=[r("span",{class:"menu-name",style:{color:"#fb363f"}},"删 除",-1)])),_:2,__:[6]},1032,["onClick"])):te("",!0)]),_:2},1024)]),default:l(()=>[r("span",{class:"action-btn",onClick:h[2]||(h[2]=Ye(()=>{},["stop"]))},[e(Y(cl))])]),_:2},1024)]))])]),_:1},8,["expanded-keys","selectedKeys","auto-expand-parent","tree-data"])])]),e(An,{ref_key:"addDepartmentRef",ref:R,onOk:U},null,512),e(zn,{ref_key:"delDepartmentRef",ref:K,onOk:x},null,512)],64)}}},ss=he(ns,[["__scopeId","data-v-3bf8a600"]]),os={class:"main-content-box"},is={style:{"margin-top":"12px"}},rs={key:0},ds={key:1},us={key:2},cs={class:"list-content"},_s={key:0},ps={key:1},vs={key:2},ms={key:0,class:"user-block"},fs={class:"role-menu-box"},hs=["onClick"],gs={class:"menu-header"},ys={key:0,class:"check-box"},bs=["onClick"],ks={class:"menu-header"},ws={key:0,class:"check-box"},xs=["onClick"],Cs={class:"menu-header"},Ss={key:0,class:"check-box"},$s={class:"hover-btn-box"},Ls={key:0},Ds={key:1},Is={key:2},Os=["onClick"],Ts={__name:"knowledge-permissions",props:{treeParmas:{type:Object,default:()=>({})}},setup(t){const v=D("2"),y=D([]),n=t;Ke(()=>n.treeParmas,c=>{i()},{deep:!0});const i=()=>{Ht({object_type:v.value,identity_type:n.treeParmas.is_user?1:2,identity_id:n.treeParmas.id}).then(c=>{let x=c.data||[];y.value=x})};i();const s=()=>{i()},o=(c,x)=>{let R=x==4?"管理":x==2?"编辑":"查看";fe.confirm({title:"提示?",icon:e(Be),content:"确认修改该数据权限为【"+R+"】",okText:"确认",cancelText:"取消",onOk:()=>{let B=[{object_id:+c.object_id,object_type:+c.object_type,operate_rights:+x}];Ma({identity_ids:c.identity_id,identity_type:2,object_array:JSON.stringify(B)}).then(u=>{ie.success("修改成功"),i()})},onCancel(){}})},a=c=>{fe.confirm({title:"提示?",icon:e(Be),content:"确认删除该条数据",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{ja({identity_id:c.identity_id,identity_type:2,object_id:c.object_id,object_type:c.object_type}).then(x=>{ie.success("删除成功"),i()})},onCancel(){}})},C=D([]),p=D([]),f=D([]),$=async()=>{await jt().then(c=>{C.value=c.data}).catch(()=>{})},w=async()=>{await At({type:""}).then(c=>{p.value=c.data}).catch(()=>{})},S=async()=>{await Ft().then(c=>{f.value=c.data}).catch(()=>{})},E=D(null),g=async()=>{if(!n.treeParmas.id)return ie.error("请先选择部门");let c=v.value;c==1?await $():c==2?await w():c==3&&await S(),E.value.handleDepartmentOpen(c,n.treeParmas,y.value)},d=D([{dataIndex:"name",key:"name"},{title:"权限",dataIndex:"role",key:"role"},{title:"操作",dataIndex:"action",key:"action",width:80}]);return(c,x)=>{const R=rl,B=bt,u=Ge,_=pl,K=et;return b(),T(_e,null,[r("div",os,[e(B,{value:v.value,"onUpdate:value":x[0]||(x[0]=A=>v.value=A),onChange:s},{default:l(()=>[e(R,{value:"2"},{default:l(()=>x[1]||(x[1]=[P("知识库")])),_:1,__:[1]}),e(R,{value:"1"},{default:l(()=>x[2]||(x[2]=[P("机器人")])),_:1,__:[2]}),e(R,{value:"3"},{default:l(()=>x[3]||(x[3]=[P("数据库")])),_:1,__:[3]})]),_:1},8,["value"]),r("div",is,[e(u,{type:"primary",onClick:g},{default:l(()=>[v.value==2?(b(),T("span",rs,"添加知识库权限")):te("",!0),v.value==1?(b(),T("span",ds,"添加机器人权限")):te("",!0),v.value==3?(b(),T("span",us,"添加数据库权限")):te("",!0)]),_:1})]),r("div",cs,[e(K,{columns:d.value,"data-source":y.value,pagination:!1},{headerCell:l(({column:A})=>[A.key==="name"?(b(),T(_e,{key:0},[v.value==2?(b(),T("span",_s,"知识库")):te("",!0),v.value==1?(b(),T("span",ps,"机器人")):te("",!0),v.value==3?(b(),T("span",vs,"数据库")):te("",!0)],64)):te("",!0)]),bodyCell:l(({column:A,record:U})=>[A.key==="name"?(b(),T("div",ms,F(U.name),1)):te("",!0),A.key==="role"?(b(),oe(_,{key:1,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:l(()=>[r("div",fs,[r("div",{class:"role-menu",onClick:L=>o(U,4)},[r("div",gs,[e(Y(ml)),x[4]||(x[4]=r("span",{class:"title"},"管理",-1))]),x[5]||(x[5]=r("div",{class:"desc"},"可编辑，可删除，可查看",-1)),U.operate_rights==4?(b(),T("div",ys,[e(Y(dt))])):te("",!0)],8,hs),r("div",{class:"role-menu",onClick:L=>o(U,2)},[r("div",ks,[e(Y(fl)),x[6]||(x[6]=r("span",{class:"title"},"编辑",-1))]),x[7]||(x[7]=r("div",{class:"desc"},"可编辑，可查看",-1)),U.operate_rights==2?(b(),T("div",ws,[e(Y(dt))])):te("",!0)],8,bs),r("div",{class:"role-menu",onClick:L=>o(U,1)},[r("div",Cs,[e(Y(ul)),x[8]||(x[8]=r("span",{class:"title"},"查看",-1))]),x[9]||(x[9]=r("div",{class:"desc"},"仅查看",-1)),U.operate_rights==1?(b(),T("div",Ss,[e(Y(dt))])):te("",!0)],8,xs)])]),default:l(()=>[r("div",$s,[U.operate_rights==4?(b(),T("span",Ls,"管理")):te("",!0),U.operate_rights==2?(b(),T("span",Ds,"编辑")):te("",!0),U.operate_rights==1?(b(),T("span",Is,"查看")):te("",!0),e(Y(vl))])]),_:2},1024)):te("",!0),A.key==="action"?(b(),T("a",{key:2,onClick:L=>a(U)},"删除",8,Os)):te("",!0)]),_:1},8,["columns","data-source"])])]),e(aa,{ref_key:"seeModelAlertRef",ref:E,robotList:C.value,libraryList:p.value,formList:f.value,onOk:i},null,8,["robotList","libraryList","formList"])],64)}}},Ps=he(Ts,[["__scopeId","data-v-0ea0ca0d"]]),Vs={__name:"batch-edit-department",emits:["ok"],setup(t,{expose:v,emit:y}){const n=D(!1),i=y,s=Le.useForm,o=pe({user_ids:"",department_ids:[]}),a=pe({department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:C,validate:p,validateInfos:f}=s(o,a),$=d=>{o.user_ids=d,o.department_ids=[],n.value=!0,S()},w=D([]),S=()=>{Ze({}).then(d=>{let c=d.data||[];w.value=ft(c)})},E=D(!1),g=()=>{p().then(()=>{let d={...o};d.department_ids=o.department_ids.join(","),E.value=!0,Fa(d).then(c=>{ie.success("批量修改部门成功"),n.value=!1,i("ok")}).finally(()=>{E.value=!1})})};return v({show:$}),(d,c)=>{const x=St,R=Qe,B=Le,u=fe;return b(),T("div",null,[e(u,{open:n.value,"onUpdate:open":c[1]||(c[1]=_=>n.value=_),title:"批量修改部门",onOk:g,confirmLoading:E.value},{default:l(()=>[e(B,{layout:"vertical",style:{"margin-top":"24px"}},{default:l(()=>[e(R,ye({label:"选择部门"},Y(f).department_ids),{default:l(()=>[e(x,{value:o.department_ids,"onUpdate:value":c[0]||(c[0]=_=>o.department_ids=_),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":w.value,"tree-node-filter-prop":"label"},{title:l(({value:_,label:K})=>[r("div",null,F(K),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Es={class:"flex-content-box"},Rs={class:"left-department-box"},Ks={class:"team-members-pages"},Ns={class:"main-tabs-block"},As={class:"list-box"},Ms={class:"user-box"},js=["src"],Fs={class:"name-info"},Us={class:"user-name"},Hs={class:"nick-name"},Bs={key:0,class:"list-content"},zs={key:1,class:"list-preview list-content"},Ws={style:{display:"inline"}},Ys={class:"list-item-box"},qs={class:"list-item"},Js={key:0,class:"list-content"},Gs={key:1,class:"list-content"},Qs=["onClick"],Xs={key:2,class:"list-preview list-content"},Zs={style:{display:"inline"}},eo={class:"list-item-box"},to={class:"list-item"},ao=["onClick"],lo={key:0,class:"list-content"},no={key:1,class:"list-content"},so=["onClick"],oo={key:2,class:"list-preview list-content"},io={style:{display:"inline"}},ro={class:"list-item-box"},uo={class:"list-item"},co=["onClick"],_o={key:0,class:"list-content"},po={key:1,class:"list-content"},vo=["onClick"],mo={key:2,class:"list-preview list-content"},fo={style:{display:"inline"}},ho={class:"list-item-box"},go={class:"list-item"},yo=["onClick"],bo={key:0,class:"status-block green"},ko={key:1,class:"status-block yellow"},wo=["onClick"],xo=["onClick"],Co=["onClick"],So={__name:"team-members",setup(t){const v=D(1),y=[{value:1,payload:{title:"团队成员"}},{value:2,payload:{title:"知识库权限"}}],n=pe({page:1,size:10,total:0,search:""}),i=D([]),s=D([]),o=D([]),a=D(null),C=j=>{n.page=j.current,n.size=j.pageSize,g()},p=pe({id:""}),f=j=>{Object.assign(p,{...j}),v.value==1&&$()},$=()=>{n.page=1,g()},w=D([]),S=j=>{let I=[];return j.map(re=>{I.push(re.name||re.department_name)}),I.join(", ")},E=D(!1),g=()=>{let j={page:n.page,size:n.size,search:n.search};p.id&&p.is_default!=1&&(j.department_id=p.id),E.value=!0,wa(j).then(I=>{let re=I.data.list;re.forEach(N=>{N.create_time=Ve(N.create_time*1e3).format("YYYY-MM-DD HH:mm"),N.expire_time_desc=N.expire_time=="0"?"永久有效":Ve(N.expire_time*1e3).format("YYYY-MM-DD HH:mm"),N.expire_status=0,(N.expire_time=="0"||Ve().unix()<N.expire_time)&&(N.expire_status=1),N.managed_robot_list=N.managed_robot_list?JSON.parse(N.managed_robot_list):[],N.managed_library_list=N.managed_library_list?JSON.parse(N.managed_library_list):[],N.managed_form_list=N.managed_form_list?JSON.parse(N.managed_form_list):[],N.departments=N.departments?JSON.parse(N.departments):[]}),w.value=re,R.selectedRowKeys=[],n.total=+I.data.total}).finally(()=>{E.value=!1})},d=()=>{v.value==1&&$()},c=D(null),x=()=>{g(),c.value.getLists()},R=pe({selectedRowKeys:[]}),B=j=>{R.selectedRowKeys=j},u=j=>({disabled:j.role_type==1}),_=j=>{xa({user_id:j.id}).then(I=>{ie.success(j.login_switch==1?"关闭成功":"开启成功"),g()})},K=D(null),A=()=>{K.value.add(p.id)},U=j=>{K.value.edit(j)},L=D(null),h=j=>{L.value.open(j)},k=j=>{fe.confirm({title:"提示?",icon:e(Be),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ca({id:j.id}).then(I=>{ie.success("删除成功"),g()})},onCancel(){}})},V=async()=>{await jt().then(j=>{i.value=j.data}).catch(()=>{})},M=async()=>{await At({type:""}).then(j=>{s.value=j.data}).catch(()=>{})},z=async()=>{await Ft().then(j=>{o.value=j.data}).catch(()=>{})},X=async j=>{let I=[];if(R.selectedRowKeys.forEach(re=>{w.value.filter(ee=>ee.id==re)[0].role_type==1||I.push(re)}),R.selectedRowKeys=I,R.selectedRowKeys.length==0)return ie.error("请选择要修改的成员");j==1?await V():j==2?await M():j==3&&await z(),a.value.handleBatchOpen(j,R.selectedRowKeys.join(","))},J=D(null),m=()=>{if(R.selectedRowKeys.length==0)return ie.error("请选择要修改的成员");J.value.show(R.selectedRowKeys.join(","))},Z=async(j,I)=>{j==1?await V():j==2?await M():j==3&&await z(),a.value.open(j,"add",I)},Se=async(j,I)=>{j==1?await V():j==2?await M():j==3&&await z(),a.value.open(j,"edit",I)};return(j,I)=>{const re=Va,N=qt,ee=Ge,ue=Qt,ke=Gt,Fe=Jt,De=xt,Ue=wt,ve=Xt,ce=kt,Ee=ba,Ne=hl,He=et;return b(),T("div",Es,[r("div",Rs,[e(re,{style:{"padding-right":"24px"}},{default:l(()=>[e(ss,{ref_key:"departmentTreeRef",ref:c,onSelect:f,onRefresh:g},null,512)]),_:1})]),r("div",Ks,[e(re,{style:{"padding-right":"24px"}},{default:l(()=>[r("div",Ns,[e(N,{value:v.value,"onUpdate:value":I[0]||(I[0]=O=>v.value=O),options:y,onChange:d},{label:l(({payload:O})=>[P(F(O.title),1)]),_:1},8,["value"])]),v.value==1?(b(),T(_e,{key:0},[e(De,{justify:"space-between"},{default:l(()=>[e(De,{gap:8},{default:l(()=>[e(ee,{type:"primary",onClick:A},{icon:l(()=>[e(Y(Xe))]),default:l(()=>[I[5]||(I[5]=P(" 添加团队成员 "))]),_:1,__:[5]}),e(Fe,null,{overlay:l(()=>[e(ke,null,{default:l(()=>[e(ue,{onClick:I[1]||(I[1]=O=>X(1))},{default:l(()=>I[7]||(I[7]=[P(" 修改机器人 ")])),_:1,__:[7]}),e(ue,{onClick:I[2]||(I[2]=O=>X(2))},{default:l(()=>I[8]||(I[8]=[P(" 修改知识库 ")])),_:1,__:[8]}),e(ue,{onClick:I[3]||(I[3]=O=>X(3))},{default:l(()=>I[9]||(I[9]=[P(" 修改数据库 ")])),_:1,__:[9]})]),_:1})]),default:l(()=>[e(ee,null,{default:l(()=>I[6]||(I[6]=[P("批量修改权限")])),_:1,__:[6]})]),_:1}),e(ee,{onClick:m},{default:l(()=>I[10]||(I[10]=[P("批量修改部门")])),_:1,__:[10]})]),_:1}),e(Ue,{value:n.search,"onUpdate:value":I[4]||(I[4]=O=>n.search=O),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:$},null,8,["value"])]),_:1}),r("div",As,[e(He,{"data-source":w.value,scroll:{x:1100},loading:E.value,"row-key":"id","row-selection":{selectedRowKeys:R.selectedRowKeys,onChange:B,getCheckboxProps:u},pagination:{current:n.page,total:n.total,pageSize:n.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:C},{default:l(()=>[e(ce,{title:"成员名称","data-index":"user_name",width:"190px"},{default:l(({record:O})=>[r("div",Ms,[r("img",{src:O.avatar||Y(_t),alt:""},null,8,js),r("div",Fs,[r("div",Us,[O.user_name&&O.user_name.length>7?(b(),oe(ve,{key:0,title:O.user_name},{default:l(()=>[P(F(O.user_name),1)]),_:2},1032,["title"])):(b(),T(_e,{key:1},[P(F(O.user_name),1)],64))]),r("div",Hs,[O.nick_name&&O.nick_name.length>7?(b(),oe(ve,{key:0,title:O.nick_name},{default:l(()=>[P(F(O.nick_name),1)]),_:2},1032,["title"])):(b(),T(_e,{key:1},[P(F(O.nick_name),1)],64))])])])]),_:1}),e(ce,{title:"角色","data-index":"role_name",width:"100px"},{default:l(({record:O})=>[P(F(O.role_name),1)]),_:1}),e(ce,{"data-index":"departments",width:"200px"},{title:l(()=>I[11]||(I[11]=[P(" 部门 ")])),default:l(({record:O})=>[O.departments&&O.departments.length==0?(b(),T("div",Bs," -- ")):(b(),T("div",zs,[e(ve,null,{title:l(()=>[r("div",Ws,F(S(O.departments)),1)]),default:l(()=>[r("div",Ys,[r("div",qs,F(S(O.departments)),1)])]),_:2},1024)]))]),_:1}),e(ce,{"data-index":"managed_robot_list",width:"200px"},{title:l(()=>[I[13]||(I[13]=P(" 管理的机器人 ")),e(ve,null,{title:l(()=>I[12]||(I[12]=[P("所有者和管理员可以创建和管理全部机器人，成员只能管理分配的机器人。")])),default:l(()=>[e(Y(ut))]),_:1})]),default:l(({record:O})=>[O.role_type==1?(b(),T("div",Js,I[14]||(I[14]=[r("div",null,"全部",-1)]))):O.managed_robot_list?(b(),T("div",Xs,[e(ve,null,{title:l(()=>[r("div",Zs,F(S(O.managed_robot_list)),1)]),default:l(()=>[r("div",eo,[r("div",to,F(S(O.managed_robot_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>Se(1,O)},[e(Ee,{name:"edit"})],8,ao)])):(b(),T("div",Gs,[r("div",{class:"list-highlight",onClick:me=>Z(1,O)},"添加",8,Qs)]))]),_:1}),e(ce,{"data-index":"managed_library_list",width:"200px"},{title:l(()=>[I[16]||(I[16]=P(" 管理的知识库 ")),e(ve,null,{title:l(()=>I[15]||(I[15]=[P("所有者和管理员可以创建和管理全部知识库，成员只能管理分配的知识库。")])),default:l(()=>[e(Y(ut))]),_:1})]),default:l(({record:O})=>[O.role_type==1?(b(),T("div",lo,I[17]||(I[17]=[r("div",null,"全部",-1)]))):O.managed_library_list?(b(),T("div",oo,[e(ve,null,{title:l(()=>[r("div",io,F(S(O.managed_library_list)),1)]),default:l(()=>[r("div",ro,[r("div",uo,F(S(O.managed_library_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>Se(2,O)},[e(Ee,{name:"edit"})],8,co)])):(b(),T("div",no,[r("div",{class:"list-highlight",onClick:me=>Z(2,O)},"添加",8,so)]))]),_:1}),e(ce,{"data-index":"managed_form_list",width:"200px"},{title:l(()=>[I[19]||(I[19]=P(" 管理的数据库 ")),e(ve,null,{title:l(()=>I[18]||(I[18]=[P("所有者和管理员可以创建和管理全部数据库，成员只能管理分配的数据库。")])),default:l(()=>[e(Y(ut))]),_:1})]),default:l(({record:O})=>[O.role_type==1?(b(),T("div",_o,I[20]||(I[20]=[r("div",null,"全部",-1)]))):O.managed_form_list?(b(),T("div",mo,[e(ve,null,{title:l(()=>[r("div",fo,F(S(O.managed_form_list)),1)]),default:l(()=>[r("div",ho,[r("div",go,F(S(O.managed_form_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>Se(3,O)},[e(Ee,{name:"edit"})],8,yo)])):(b(),T("div",po,[r("div",{class:"list-highlight",onClick:me=>Z(3,O)},"添加",8,vo)]))]),_:1}),e(ce,{title:"状态","data-index":"expire_status",width:"120px"},{default:l(({record:O})=>[O.expire_status==1?(b(),T("div",bo,[e(Y(ka)),I[21]||(I[21]=P("生效中 "))])):te("",!0),O.expire_status==0?(b(),T("div",ko,[e(Y(Nt)),I[22]||(I[22]=P("已过期 "))])):te("",!0)]),_:1}),e(ce,{title:"过期时间","data-index":"expire_time_desc",width:"130px"},{default:l(({record:O})=>[P(F(O.expire_time_desc),1)]),_:1}),e(ce,{title:"登录","data-index":"login_switch",width:"90px",fixed:"right"},{default:l(({record:O})=>[e(Ne,{onChange:me=>_(O),checked:O.login_switch=="1",disabled:O.role_type=="1","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked","disabled"])]),_:1}),e(ce,{title:"操作","data-index":"action",width:"176px",fixed:"right"},{default:l(({record:O})=>[O.role_type=="1"?(b(),oe(De,{key:0,gap:16},{default:l(()=>I[23]||(I[23]=[r("span",{class:"disabled"},"编辑",-1),r("span",{class:"disabled"},"重置密码",-1),r("span",{class:"disabled"},"删除",-1)])),_:1,__:[23]})):(b(),oe(De,{key:1,gap:16},{default:l(()=>[r("a",{onClick:me=>U(O)},"编辑",8,wo),r("a",{onClick:me=>h(O)},"重置密码",8,xo),r("a",{onClick:me=>k(O)},"删除",8,Co)]),_:2},1024))]),_:1})]),_:1},8,["data-source","loading","row-selection","pagination"])])],64)):(b(),oe(Ps,{key:1,treeParmas:p},null,8,["treeParmas"]))]),_:1}),e(cn,{ref_key:"addTeamMembersRef",ref:K,onOk:x},null,512),e(vn,{ref_key:"resetPasswordRef",ref:L,onOk:g},null,512),e(aa,{ref_key:"seeModelAlertRef",ref:a,robotList:i.value,libraryList:s.value,formList:o.value,onOk:g},null,8,["robotList","libraryList","formList"]),e(Vs,{ref_key:"batchEditDepartmentRef",ref:J,onOk:x},null,512)])])}}},$o=he(So,[["__scopeId","data-v-d71c6dcf"]]),Lo={class:"form-box"},Do={class:"title-row"},Io={class:"check-num"},Oo={__name:"add-role",emits:["ok"],setup(t,{expose:v,emit:y}){const n=y,i=Le.useForm,s=D([]),o=D({}),a=D(!1),C=D("添加角色"),p=D(""),f=pe({name:"",mark:"",role_type:""}),$=pe({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:w,validate:S,validateInfos:E}=i(f,$),g=async()=>{await Sa().then(u=>{s.value=u.data;for(let _=0;_<u.data.length;_++){const K=u.data[_];o.value[K.uni_key]=[]}})},d=async()=>{await g(),C.value="添加角色",p.value="",a.value=!0,f.name="",f.mark="",w()},c=u=>{C.value="编辑角色",p.value=u.id,$a({id:u.id}).then(_=>{let K=_.data,A=K.role_permission||[];f.name=K.name,f.mark=K.mark,f.role_type=K.role_type,o.value=x(s.value,A),a.value=!0})},x=(u,_)=>{let K={};return u.forEach(A=>{K[A.uni_key]=[];for(let U=0;U<A.children.length;U++){const L=A.children[U];_.includes(L.uni_key)&&K[A.uni_key].push(L.uni_key)}}),K},R=u=>{let _=[];for(let K in u)u[K].map(U=>{_.push(U)});return _},B=()=>{S().then(()=>{let u=R(o.value),_={id:p.value,mark:f.mark};f.role_type==0&&(_.name=f.name,_.role_type=f.role_type,_.uni_keys=u.join(",")),La(_).then(K=>{a.value=!1,ie.success("保存成功"),n("ok")})})};return Pa(()=>{g()}),v({add:d,edit:c}),(u,_)=>{const K=yt,A=Qe,U=gl,L=xt,h=bl,k=wl,V=kl,M=yl,z=Le,X=fe;return b(),T("div",null,[e(X,{open:a.value,"onUpdate:open":_[2]||(_[2]=J=>a.value=J),title:C.value,onOk:B,width:"746px"},{default:l(()=>[r("div",Lo,[e(z,{layout:"vertical"},{default:l(()=>[e(A,ye({label:"角色名称"},Y(E).name),{default:l(()=>[e(K,{type:"text",maxlength:100,disabled:f.role_type>0,placeholder:"请输入角色名称",value:f.name,"onUpdate:value":_[0]||(_[0]=J=>f.name=J)},null,8,["disabled","value"])]),_:1},16),e(A,{label:"角色备注"},{default:l(()=>[e(U,{value:f.mark,"onUpdate:value":_[1]||(_[1]=J=>f.mark=J),placeholder:"请输入角色备注"},null,8,["value"])]),_:1}),e(A,{label:"角色权限"},{default:l(()=>[(b(!0),T(_e,null,ze(s.value,J=>(b(),T("div",{class:"role-check-box",key:J.uni_key},[e(L,{class:"title-boock",justify:"space-between"},{default:l(()=>[r("div",Do,F(J.name),1),r("div",Io,F(o.value[J.uni_key].length)+"/"+F(J.children.length),1)]),_:2},1024),e(M,{value:o.value[J.uni_key],"onUpdate:value":m=>o.value[J.uni_key]=m,style:{width:"100%"}},{default:l(()=>[e(V,{gutter:[0,12]},{default:l(()=>[(b(!0),T(_e,null,ze(J.children,m=>(b(),oe(k,{span:6,key:m.uni_key},{default:l(()=>[e(h,{disabled:f.role_type>0,value:m.uni_key},{default:l(()=>[P(F(m.name),1)]),_:2},1032,["disabled","value"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])]))),128))]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},To=he(Oo,[["__scopeId","data-v-93015f2b"]]),Po={class:"team-members-pages"},Vo={class:"list-box"},Eo={__name:"role-permissions",setup(t){D("");const v=pe({page:1,size:10,total:0,search:""}),y=D([{}]),n=f=>{v.page=f.current,v.size=f.pageSize,s()},i=()=>{v.page=1,s()},s=()=>{let f={page:v.page,size:v.size,search:v.search};Kt(f).then($=>{let w=$.data.list;w.forEach(S=>{S.update_time=Ve(S.update_time*1e3).format("YYYY-MM-DD HH:mm")}),y.value=w,v.total=+$.data.total})};i();const o=D(null),a=()=>{o.value.add()},C=f=>{o.value.edit(f)},p=f=>{fe.confirm({title:"提示?",icon:e(Be),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Da({id:f.id}).then($=>{ie.success("删除成功"),s()})},onCancel(){}})};return(f,$)=>{const w=Ge,S=wt,E=xt,g=kt,d=et;return b(),T("div",Po,[e(E,{justify:"space-between"},{default:l(()=>[e(w,{type:"primary",onClick:a},{icon:l(()=>[e(Y(Xe))]),default:l(()=>[$[1]||($[1]=P(" 添加角色 "))]),_:1,__:[1]}),e(S,{value:v.search,"onUpdate:value":$[0]||($[0]=c=>v.search=c),placeholder:"输入角色名称",style:{width:"288px"},onSearch:i},null,8,["value"])]),_:1}),r("div",Vo,[e(d,{"data-source":y.value,pagination:{current:v.page,total:v.total,pageSize:v.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:n},{default:l(()=>[e(g,{title:"角色","data-index":"name",width:"157px"},{default:l(({record:c})=>[P(F(c.name),1)]),_:1}),e(g,{title:"备注","data-index":"mark",width:"480px"},{default:l(({record:c})=>[P(F(c.mark),1)]),_:1}),e(g,{title:"最近修改时间","data-index":"update_time",width:"150px"},{default:l(({record:c})=>[P(F(c.update_time),1)]),_:1}),e(g,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:l(({record:c})=>[P(F(c.operate_name),1)]),_:1}),e(g,{title:"创建人","data-index":"create_name",width:"130px"},{default:l(({record:c})=>[P(F(c.create_name),1)]),_:1}),e(g,{title:"操作","data-index":"action",width:"178px"},{default:l(({record:c})=>[e(E,{gap:16,class:"action-box"},{default:l(()=>[e(w,{type:"link",onClick:x=>C(c)},{default:l(()=>$[2]||($[2]=[P("编辑")])),_:2,__:[2]},1032,["onClick"]),e(w,{type:"link",onClick:x=>p(c),disabled:c.role_type<=3&&c.role_type>0},{default:l(()=>$[3]||($[3]=[P("删除")])),_:2,__:[3]},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),e(To,{ref_key:"addRoleRef",ref:o,onOk:s},null,512)])}}},Ro=he(Eo,[["__scopeId","data-v-5beb8d86"]]),Ko={class:"user-model-page"},No={class:"list-wrapper"},Ao={__name:"index",setup(t){const v=D(1),y=()=>{v.value};return(n,i)=>(b(),T("div",Ko,[e(Jl,{value:v.value,"onUpdate:value":i[0]||(i[0]=s=>v.value=s),onChange:y},null,8,["value"]),r("div",No,[v.value==1?(b(),oe($o,{key:0})):(b(),oe(Ro,{key:1}))])]))}},tr=he(Ao,[["__scopeId","data-v-df6b3107"]]);export{tr as default};
