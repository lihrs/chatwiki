import{b as U,k as u}from"../../index-CvfGQnmW.js";import{I as F}from"./InboxOutlined-gHsJ5qL7.js";import{U as w}from"./index-Dktj88pM.js";import{b as L,d as M,w as N,N as i,O as p,j as f,X as s,U as T,u as v,_ as x,F as I,a1 as B,a5 as j}from"./vue-chunks-BRsu9_To.js";const z={class:"ant-upload-drag-icon"},A={class:"ant-upload-hint"},D={__name:"upload-input",props:{value:{type:Array,default:()=>[]},maxCount:{type:Number,default:1},type:{type:[String,Number],default:0}},emits:["change","update:value"],setup(g,{emit:_}){const c=_,a=g;let o=["pdf","docx","txt","md","xlsx","csv","html"];a.type==2&&(o=["docx","csv","xlsx"]);const h=L(()=>o.map(e=>`.${e}`).join(",")),t=M([]);N(()=>a.value,e=>{t.value=e},{immediate:!0});let n=null;const C=()=>{if(t.value.length>=a.maxCount)return u.error("一次最多上传"+a.maxCount+"个文件")},d=()=>{t.value.length>a.maxCount&&u.error("一次最多上传"+a.maxCount+"个文件");let e=[...t.value];c("change",e),c("update:value",e)},b=e=>{y(e),d()},y=e=>{for(let l=0;l<t.value.length;l++)if(t.value[l].uid===e.uid){t.value.splice(l,1);break}},k=e=>{const l=e.name.split(".").pop();return o.includes(l.toLowerCase())?e.size/1024/1024<100?(t.value=[...t.value||[],e],t.value.length>a.maxCount&&(t.value=t.value.splice(0,a.maxCount)),n&&clearTimeout(n),n=setTimeout(()=>{d(),clearTimeout(n)},50),!1):(u.error("文件大小不能超过100M"),!1):(u.error("不支持的文件格式"),!1)};return(e,l)=>{const m=w;return p(),i("div",{class:j(["upload-input",{disabled:t.value.length>=a.maxCount}])},[f(m,{"file-list":t.value,name:"file",multiple:!0,"max-count":a.maxCount,accept:h.value,beforeUpload:k,onRemove:b,class:"ant-upload-drag"},{default:T(()=>[s("div",z,[f(v(F))]),l[1]||(l[1]=s("div",{class:"ant-upload-text"},"点击或将文件拖拽到这里上传",-1)),s("div",A,[s("p",null,"一次只能上传"+x(a.maxCount)+"个文档，单个文件不超过100M",1),s("p",null,[l[0]||(l[0]=s("span",null,"支持文件类型：",-1)),(p(!0),i(I,null,B(v(o),r=>(p(),i("span",{class:"ant-upload-hint-ext",key:r},"."+x(r),1))),128))])])]),_:1,__:[1]},8,["file-list","max-count","accept"]),s("div",{class:"disabled-mask",onClick:C})],2)}}},V=U(D,[["__scopeId","data-v-db78f10c"]]);export{V as U};
