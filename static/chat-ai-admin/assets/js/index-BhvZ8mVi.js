import{N as w,O as k,F as G,a1 as H,X as t,_ as h,a0 as x,j as n,U as i,d as $,b as Y,z as B,q as K,S as W,W as O,u as C,a2 as N,Z as X}from"./vue-chunks-BRsu9_To.js";import{b as q,d as Z,k as D,bE as E,bK as F,M,bG as Q,dJ as ee,B as te,a0 as ae,bH as oe,E as ne,bJ as se}from"../../index-CvfGQnmW.js";import{M as re,_ as ie}from"./index-Cn6_tPQQ.js";import"./index-XnBLv09r.js";import{D as le}from"./dropdown-JwPNtE5e.js";import{t as de}from"./validate-8MtiUsxW.js";import{A as _e}from"./avatar-input-BM11y6wX.js";import{F as I,_ as ce}from"./index-CeLDnZbi.js";import"./index-DUS5CIPm.js";import{I as pe}from"./Input-DT-w6V-X.js";import{_ as me}from"./TextArea-B40Dha8W.js";import{_ as ue}from"./page-alert-D3-3uqYj.js";import{P as fe}from"./PlusOutlined-BsYDRa8m.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-C5a0DMKm.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-vrDadJH3.js";import"./index-DaOSj_2K.js";import"./index-B-ykUzgY.js";import"./colors-Cy2bPHOW.js";import"./RightOutlined-DQOW11d0.js";import"./move-CunrTozH.js";import"./index-Dktj88pM.js";import"./Password-Bl0n4Nu8.js";import"./inputProps-DJXIqADS.js";import"./DownloadOutlined-D6_CmJ5K.js";import"./CheckOutlined-N7bppPAu.js";import"./FormItemContext-CFzzmp00.js";import"./isPlainObject-C_BoBcyP.js";import"./responsiveObserve-4wudV-W8.js";import"./QuestionCircleOutlined-DsT-V90y.js";import"./index-B0doyz59.js";import"./Search-BVbdzfe3.js";import"./SearchOutlined-B9P7O4A9.js";const ye={class:"list-box"},ve=["onClick"],be={class:"library-info"},ge=["src"],he={class:"library-info-content"},ke={class:"library-title"},xe={class:"item-body"},we={class:"library-desc"},$e={class:"item-footer"},Le={class:"library-size"},Ae={class:"text-item"},Ce={class:"text-item"},De=["onClick"],qe=["onClick"],Be={__name:"index",props:{list:{type:Array,default:()=>[]},showCreate:{type:Boolean,default:!0}},emits:["add","edit","delete"],setup(L,{emit:v}){const p=v,d=L,_=c=>{p("edit",c)},u=c=>{p("delete",c)};return(c,m)=>{const s=Z,o=ie,e=re,f=le;return k(),w("div",ye,[(k(!0),w(G,null,H(d.list,l=>(k(),w("div",{class:"list-item-wrapper",key:l.id},[t("div",{class:"list-item",onClick:x(g=>_(l),["stop"])},[t("div",be,[t("img",{class:"library-icon",src:l.avatar,alt:""},null,8,ge),t("div",he,[t("div",ke,h(l.library_name),1)])]),t("div",xe,[t("div",we,h(l.library_intro),1)]),t("div",$e,[t("div",Le,[t("span",Ae,"文档："+h(l.file_total),1),t("span",Ce,"大小："+h(l.file_size_str),1)]),t("div",{class:"action-box",onClick:m[1]||(m[1]=x(()=>{},["stop"]))},[n(f,null,{overlay:i(()=>[n(e,null,{default:i(()=>[n(o,null,{default:i(()=>[t("a",{href:"javascript:;",onClick:x(g=>_(l),["stop"])},"管 理",8,De)]),_:2},1024),n(o,null,{default:i(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:g=>u(l)},"删 除",8,qe)]),_:2},1024)]),_:2},1024)]),default:i(()=>[t("div",{class:"action-item",onClick:m[0]||(m[0]=x(()=>{},["stop"]))},[n(s,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,ve)]))),128))])}}},Oe=q(Be,[["__scopeId","data-v-8d366fcc"]]),Ie={class:"form-box"},Ne={__name:"add-library-model",setup(L,{expose:v}){D.config({duration:2});const p=N(),d=$(!1),_=Y(()=>1);let u="",c="";const m=I.useForm,s=$(!1),o=_.value==0?E:F,e=B({type:_.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:o,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:_.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),f=B({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:l,validateInfos:g}=m(e,f),R=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},S=()=>{d.value=!1},T=()=>{l().then(()=>{P()}).catch(a=>{})},P=()=>{let a=new FormData,r=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",r.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(de(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),s.value=!0,Q(a).then(b=>{D.success("创建成功"),c=b.data.id,u=b.data.library_key,z(b.data.id)}).catch(()=>{s.value=!1})},U=async()=>await ee({library_key:u,doc_id:"",doc_type:"4",pid:0,title:"无标题文档",content:"# 无标题文档",sort:0}),z=()=>{U().then(a=>{let r=a.data.doc_id;p.replace({path:"/public-library/editor",query:{library_id:c,library_key:u,doc_id:r}})})};return v({show:()=>{d.value=!0}}),K(()=>{}),(a,r)=>{const b=pe,A=ce,J=me,V=I,j=M;return k(),W(j,{open:d.value,"onUpdate:open":r[3]||(r[3]=y=>d.value=y),title:"添加知识库",onOk:T,confirmLoading:s.value,onCancel:S,width:"640px"},{default:i(()=>[t("div",Ie,[n(V,{"label-col":{span:5}},{default:i(()=>[n(A,O({ref:"name",label:"知识库名称"},C(g).library_name),{default:i(()=>[n(b,{value:e.library_name,"onUpdate:value":r[0]||(r[0]=y=>e.library_name=y),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),n(A,{label:"知识库简介"},{default:i(()=>[n(J,{maxlength:1e3,value:e.library_intro,"onUpdate:value":r[1]||(r[1]=y=>e.library_intro=y),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),n(A,O({ref:"name",label:"知识库封面"},C(g).avatar),{default:i(()=>[n(_e,{value:e.avatar,"onUpdate:value":r[2]||(r[2]=y=>e.avatar=y),onChange:R},null,8,["value"]),r[4]||(r[4]=t("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[4]},16)]),_:1})])]),_:1},8,["open","confirmLoading"])}}},Ee=q(Ne,[["__scopeId","data-v-17846dfc"]]),Fe={"bg-color":"#f5f9ff",class:"library-page"},Me={class:"library-page-body"},Re={class:"list-toolbar"},Se={class:"toolbar-box"},Te={class:"list-total"},Pe={class:"toolbar-box"},Ue={__name:"index",setup(L){N();const v=$(null),p=$([]),d=()=>{ae({type:1}).then(s=>{let o=s.data||[];o.forEach(e=>{e.file_size_str=oe(e.file_size),e.avatar||(e.avatar=e.type==0?E:F)}),p.value=o})};d();const _=()=>{v.value.show()},u=s=>{window.open(`/#/public-library/home?library_id=${s.id}&library_key=${s.library_key}`,"_blank","noopener")},c=s=>{let o=3,e=M.confirm({title:`删除${s.library_name}`,icon:n(ne),content:"您确定要删除此知识库吗？",okText:o+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){m(s)},onCancel(){}}),f=setInterval(()=>{o==1?(e.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(f),f=void 0):(o-=1,e.update({okText:o+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},m=({id:s})=>{se({id:s}).then(()=>{D.success("删除成功"),d()})};return(s,o)=>{const e=te;return k(),w("div",Fe,[o[3]||(o[3]=t("div",{class:"page-title"},"对外文档",-1)),n(ue,{style:{"margin-bottom":"16px"},title:"使用说明"},{default:i(()=>o[1]||(o[1]=[t("div",null,[t("p",null," 1、对外文档作为在线文档创作管理工具，创作的文档既可作为知识库关联到机器人使用，也可分享给好友查看。 "),t("p",null,"2、支持设置每篇文档的title、description、keyword，提高SEO搜索权重。")],-1)])),_:1,__:[1]}),t("div",Me,[t("div",Re,[t("div",Se,[t("h3",Te,"全部 ("+h(p.value.length)+")",1)]),t("div",Pe,[n(e,{type:"primary",onClick:o[0]||(o[0]=f=>_())},{icon:i(()=>[n(C(fe))]),default:i(()=>[o[2]||(o[2]=X(" 新建对外文档 "))]),_:1,__:[2]})])]),t("div",null,[n(Oe,{list:p.value,onAdd:_,onEdit:u,onDelete:c},null,8,["list"])])]),n(Ee,{ref_key:"addLibraryModelRef",ref:v},null,512)])}}},Dt=q(Ue,[["__scopeId","data-v-a53f16e9"]]);export{Dt as default};
