import{b as B,M as D,k as $,B as Z,ac as j,Z as G,ad as T,E as W,ae as X,af as H,ag as J}from"../../index-CvfGQnmW.js";import{S as K,a as Q}from"./index-Bic_ld4j.js";import{_ as Y}from"./index-DUS5CIPm.js";import{I as M}from"./Input-DT-w6V-X.js";import{d as u,z as E,S as R,O as g,U as p,X as n,j as s,N as O,a1 as oo,_ as F,F as to,G as N,u as eo,Z as ao,a6 as no}from"./vue-chunks-BRsu9_To.js";import{_ as q,F as z}from"./index-CeLDnZbi.js";import{_ as A}from"./TextArea-B40Dha8W.js";import{_ as lo}from"./index-BjQk2Mcr.js";import{a as so}from"./index-SYniNczA.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-C5a0DMKm.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./index-B0doyz59.js";import"./slide-vrDadJH3.js";import"./index-DaOSj_2K.js";import"./CheckOutlined-N7bppPAu.js";import"./DownOutlined-DKJ0lkJp.js";import"./SearchOutlined-B9P7O4A9.js";import"./FormItemContext-CFzzmp00.js";import"./move-CunrTozH.js";import"./Search-BVbdzfe3.js";import"./isPlainObject-C_BoBcyP.js";import"./inputProps-DJXIqADS.js";import"./Password-Bl0n4Nu8.js";import"./responsiveObserve-4wudV-W8.js";import"./collapseMotion-Brd6xpAT.js";import"./index-B-ykUzgY.js";import"./colors-Cy2bPHOW.js";import"./QuestionCircleOutlined-DsT-V90y.js";import"./index-CteniEgA.js";import"./useMaxLevel-CGODDmyb.js";import"./CaretDownFilled-D2jjQ2Qs.js";import"./index-BNsyVryY.js";import"./fromPairs-Dx9PT-t0.js";import"./index-MLftqXg-.js";import"./LeftOutlined-CaA0Q_W1.js";import"./RightOutlined-DQOW11d0.js";import"./index-C_DWe9ZR.js";import"./Checkbox-CD3yZxoG.js";import"./index-XnBLv09r.js";import"./dropdown-JwPNtE5e.js";import"./index-Cn6_tPQQ.js";import"./shallowequal-C0xnIuy8.js";import"./index-ESeBgLel.js";import"./RadioButton-Bh1r7hrP.js";import"./CaretDownOutlined-CGSacOH8.js";const io={class:"add-domain-form"},co={class:"form-item"},ro={class:"form-input-box"},po={__name:"add-domain-modal ",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(w,{expose:f,emit:v}){const b=w;function L(e){return e=e.replace("。",".").toLowerCase(),e=e.replace(/\/$/,""),e=e.replace(/(^\s*)|(\s*$)/g,""),e=e.replace("http://",""),e=e.replace("https://",""),e}const k=v,a=u(!1),h=u("添加自定义域名"),d=u([{label:"http",value:"http:"},{label:"https",value:"https:"}]),t=E({id:null,url:"",protocol:"http:"}),C=()=>{try{if(t.url){const e=new URL(t.url);e.protocol=="http:"||e.protocol=="https:"?t.protocol=e.protocol:t.protocol="http:",t.url=e.hostname}}catch{t.url=L(t.url)}},S=()=>{if(!t.url)return $.error("请输入配置域名");t.url=L(t.url),k("ok",{...t})};return f({open:e=>{e?(t.url=e.url,t.protocol=e.protocol,t.id=e.id,h.value="修改自定义域名"):(t.id=null,t.url="",t.protocol="http:",h.value="添加自定义域名"),a.value=!0},close:()=>{a.value=!1}}),(e,c)=>{const x=Q,m=K,o=M,l=Y,y=D;return g(),R(y,{open:a.value,"onUpdate:open":c[2]||(c[2]=_=>a.value=_),title:h.value,onOk:S,confirmLoading:b.confirmLoading},{default:p(()=>[n("div",io,[n("div",co,[c[3]||(c[3]=n("div",{class:"form-label"},"配置域名：",-1)),n("div",ro,[s(l,{compact:"",style:{width:"100%"}},{default:p(()=>[s(m,{value:t.protocol,"onUpdate:value":c[0]||(c[0]=_=>t.protocol=_),style:{width:"20%"}},{default:p(()=>[(g(!0),O(to,null,oo(d.value,_=>(g(),R(x,{value:_.value,key:_.value},{default:p(()=>[n("span",null,F(_.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s(o,{value:t.url,"onUpdate:value":c[1]||(c[1]=_=>t.url=_),style:{width:"80%"},placeholder:"请输入配置域名",onBlur:C},null,8,["value"])]),_:1})])]),c[4]||(c[4]=n("div",{class:"form-tip"}," 配置域名只需要填写域名部分,比如kf.xxx.com.您可以根据需求选择http或https协议 ",-1))])]),_:1},8,["open","title","confirmLoading"])}}},uo=B(po,[["__scopeId","data-v-a3d32ded"]]),mo={class:"upload-ssl-form"},_o={class:"domain"},fo={__name:"upload-ssl",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(w,{expose:f,emit:v}){const b=v,L=w,k=u(),a=E({id:"",domain:"",ssl_certificate:"",ssl_certificate_key:""}),h={ssl_certificate:[{required:!0,message:"请输入证书文件(.crt或.pem)"}],ssl_certificate_key:[{required:!0,message:"请输入私钥文件(.key)"}]},d=u(!1),t=r=>{a.id=r.id,a.domain=r.url,a.ssl_certificate="",a.ssl_certificate_key="",d.value=!0},C=()=>{d.value=!1},S=()=>{k.value.validate().then(()=>{b("ok",N(a))}).catch(r=>{})};return f({open:t,close:C}),(r,i)=>{const e=A,c=q,x=z,m=D;return g(),R(m,{open:d.value,"onUpdate:open":i[2]||(i[2]=o=>d.value=o),title:"上传证书",onOk:S,confirmLoading:L.confirmLoading},{default:p(()=>[n("div",mo,[n("div",_o,"域名："+F(r.domain),1),s(x,{ref_key:"formRef",ref:k,model:a,rules:h,autocomplete:"off",layout:"vertical"},{default:p(()=>[s(c,{label:"证书文件(.crt或.pem)",name:"ssl_certificate"},{default:p(()=>[s(e,{rows:5,value:a.ssl_certificate,"onUpdate:value":i[0]||(i[0]=o=>a.ssl_certificate=o)},null,8,["value"])]),_:1}),s(c,{label:"私钥文件(.key)",name:"ssl_certificate_key"},{default:p(()=>[s(e,{rows:5,value:a.ssl_certificate_key,"onUpdate:value":i[1]||(i[1]=o=>a.ssl_certificate_key=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},vo=B(fo,[["__scopeId","data-v-04038b85"]]),ko={class:"upload-ssl-form"},ho={__name:"upload-validation-file",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(w,{expose:f,emit:v}){const b=v,L=w,k=u(),a=E({id:"",file_name:"",file_content:""}),h={file_name:[{required:!0,message:"请输入文件名"}],file_content:[{required:!0,message:"请输入文件内容"}]},d=u(!1),t=r=>{a.id=r.id,a.file_name="",a.file_content="",d.value=!0},C=()=>{d.value=!1},S=()=>{k.value.validate().then(()=>{b("ok",N(a))}).catch(r=>{})};return f({open:t,close:C}),(r,i)=>{const e=M,c=q,x=A,m=z,o=D;return g(),R(o,{open:d.value,"onUpdate:open":i[2]||(i[2]=l=>d.value=l),title:"上传证书",onOk:S,confirmLoading:L.confirmLoading},{default:p(()=>[n("div",ko,[s(m,{ref_key:"formRef",ref:k,model:a,rules:h,autocomplete:"off",layout:"vertical"},{default:p(()=>[s(c,{label:"文件名（含文件后缀，比如 mzkAzOpb6L.txt）",name:"file_name"},{default:p(()=>[s(e,{value:a.file_name,"onUpdate:value":i[0]||(i[0]=l=>a.file_name=l)},null,8,["value"])]),_:1}),s(c,{label:"文件内容",name:"file_content"},{default:p(()=>[s(x,{rows:5,value:a.file_content,"onUpdate:value":i[1]||(i[1]=l=>a.file_content=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},yo=B(ho,[["__scopeId","data-v-6af751a1"]]),go={class:"domain-page"},Lo={class:"page-container"},xo={class:"domain-tips"},bo={class:"list-action-box"},Co={class:"list-box"},So={key:0},wo={key:1},Uo={key:2,class:"action-box"},$o=["onClick"],Oo=["onClick"],Ro=["onClick"],Fo=["onClick"],Bo={__name:"index",setup(w){const f=u(null),v=u(!1),b=[{title:"域名",dataIndex:"url",key:"url"},{title:"证书",dataIndex:"is_upload",key:"is_upload",width:300},{title:"操作",key:"action"}],L=()=>{f.value.open()},k=o=>{let l={id:o.id,url:o.url,protocol:"http:"};try{const y=new URL(o.url);y.protocol=="http:"||y.protocol=="https:"?l.protocol=y.protocol:l.protocol="http:",l.url=y.hostname}catch{}f.value.open(l)},a=o=>{v.value=!0;let l=`${o.protocol}//${o.url}`;X({url:l,id:o.id||void 0}).then(()=>{$.success("保存成功"),v.value=!1,f.value.close(),m()}).catch(()=>{v.value=!1})},h=o=>{D.confirm({title:"删除",icon:s(W),content:"确定要删除吗？",onOk(){T({id:o.id}).then(()=>{$.success("删除成功"),m()})},onCancel(){}})},d=u(null),t=u(!1),C=o=>{d.value.open(o)},S=o=>{t.value=!0;let l={id:o.id,ssl_certificate:o.ssl_certificate,ssl_certificate_key:o.ssl_certificate_key};H(l).then(()=>{t.value=!1,d.value.close(),$.success("上传成功"),m()}).catch(()=>{t.value=!1})},r=u(null),i=u(!1),e=o=>{r.value.open(o)},c=o=>{i.value=!0,J({...o}).then(()=>{i.value=!1,r.value.close(),$.success("上传成功"),m()}).catch(()=>{i.value=!1})},x=u([]),m=async()=>{const o=await j();x.value=o.data||[]};return m(),(o,l)=>{const y=lo,_=Z,P=so;return g(),O("div",go,[n("div",Lo,[l[2]||(l[2]=n("div",{class:"page-title"},"自定义域名设置",-1)),n("div",xo,[s(y,{type:"info","show-icon":""},{icon:p(()=>[n("div",null,[s(eo(G),{style:{"font-size":"16px"}})])]),description:p(()=>l[0]||(l[0]=[n("div",{class:"tip-text"},[n("div",null,"将域名解析到ChatWiki服务器，可以通过自由域名访问对外文档和对外服务web APP。"),n("div",null," 1、域名解析请参考帮助文档，目前只支持阿里云备案的域名，将域名cname到wiki.aishipinhao.com。 "),n("div",null,"2、如需使用https,请在添加域名后，上传证书文件，包括公钥和私钥(ky文件)。")],-1)])),_:1})]),n("div",bo,[n("div",null,[s(_,{type:"primary",onClick:L},{default:p(()=>l[1]||(l[1]=[ao("添加自定义域名")])),_:1,__:[1]})])]),n("div",Co,[s(P,{columns:b,"data-source":x.value},{bodyCell:p(({column:V,record:U})=>[V.key==="url"?(g(),O("span",So,F(U.url),1)):V.key==="is_upload"?(g(),O("span",wo,F(U.is_upload?"已上传":"未上传"),1)):V.key==="action"?(g(),O("span",Uo,[n("a",{class:"action-btn",onClick:I=>C(U)},"上传证书",8,$o),n("a",{class:"action-btn",onClick:I=>e(U)},"上传验证文件",8,Oo),n("a",{class:"action-btn",onClick:I=>k(U)},"编辑",8,Ro),n("a",{class:"action-btn",onClick:I=>h(U)},"删除",8,Fo)])):no("",!0)]),_:1},8,["data-source"])])]),s(uo,{ref_key:"addDomainModalRef",ref:f,confirmLoading:v.value,onOk:a},null,8,["confirmLoading"]),s(vo,{ref_key:"uploadSSLRef",ref:d,"confirm-loading":t.value,onOk:S},null,8,["confirm-loading"]),s(yo,{ref_key:"uploadValidationFileRef",ref:r,"confirm-loading":i.value,onOk:c},null,8,["confirm-loading"])])}}},$t=B(Bo,[["__scopeId","data-v-29b673e3"]]);export{$t as default};
