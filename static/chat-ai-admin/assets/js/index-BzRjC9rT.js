import{b as A,k as I,bK as M,d as P,B as z,di as E,b_ as T}from"../../index-5YmK49PT.js";import{d as g,z as y,w as D,q as k,N as B,O as F,X as i,j as o,U as n,W as h,u as w,a0 as G,Z as K,G as C,b as W,a3 as X}from"./vue-chunks-BRsu9_To.js";import{C as Y}from"./config-page-menu-DeAfvK8P.js";import{A as Z}from"./avatar-input-BnRM0RTR.js";import{F as L,_ as H}from"./index-CgExRH-D.js";import"./index-CaUPg-sM.js";import{I as J}from"./Input-BUp4aYTr.js";import{_ as Q}from"./TextArea-srALwtoG.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-8HS083vp.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-B4vLzRfT.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-D1R8ir8y.js";import"./index-D-Ceyk84.js";import"./index-BlLboPxR.js";import"./colors-DWh3mM8d.js";import"./PlusOutlined-CMRQwZGc.js";import"./index-CoXfmZ4Q.js";import"./Password-DgCvYgs_.js";import"./inputProps-DdSvkSVM.js";import"./DownloadOutlined-BbtFZu2C.js";import"./CheckOutlined-DCEeaX0q.js";import"./FormItemContext-CEomr4ey.js";import"./isPlainObject-vCHOGwck.js";import"./responsiveObserve-BCCnUN0N.js";import"./QuestionCircleOutlined-B1NoWbnW.js";import"./index-DKf75RQ4.js";import"./Search-CIbInPkK.js";import"./SearchOutlined-Cw4SeIMs.js";const aa={class:"form-box"},ea={class:"form-box-header"},ta={class:"form-box-label"},oa={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(d,{emit:u}){I.config({duration:2});const f=u,r=d,s=g(1),c=L.useForm,v=g(!1),m=M,a=y({type:s.value,access_rights:0,library_name:"",library_intro:"",use_model:"",avatar:m,avatar_file:"",is_offline:!1,model_config_id:""}),_=y({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),b=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:U,validateInfos:x}=c(a,_),N=()=>{U().then(()=>{O()}).catch(e=>{})},O=()=>{let e=C(a);f("submit",e)},R=e=>{v.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:m,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return D(r.value,e=>{R({...e})}),k(()=>{}),(e,t)=>{const S=P,$=J,p=H,j=Q,q=z,V=L;return F(),B("div",aa,[i("div",ea,[i("div",ta,[o(S,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),t[3]||(t[3]=i("span",{class:"form-box-label-text"},"知识库信息",-1))]),t[4]||(t[4]=i("div",null,null,-1))]),o(V,{"label-col":{span:6},style:{width:"600px"}},{default:n(()=>[o(p,h({ref:"name",label:"知识库名称"},w(x).library_name),{default:n(()=>[o($,{value:a.library_name,"onUpdate:value":t[0]||(t[0]=l=>a.library_name=l),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),o(p,{label:"知识库简介"},{default:n(()=>[o(j,{value:a.library_intro,"onUpdate:value":t[1]||(t[1]=l=>a.library_intro=l),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),o(p,h({ref:"name",label:"知识库封面"},w(x).avatar),{default:n(()=>[o(Z,{value:a.avatar,"onUpdate:value":t[2]||(t[2]=l=>a.avatar=l),onChange:b},null,8,["value"]),t[5]||(t[5]=i("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[5]},16),o(p,{"wrapper-col":{offset:6,span:8}},{default:n(()=>[o(q,{type:"primary",style:{"margin-left":"8px"},loading:d.saveLoading,onClick:G(N,["prevent"])},{default:n(()=>t[6]||(t[6]=[K("保存")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})])}}},ra=A(oa,[["__scopeId","data-v-377531e7"]]),ia={class:"add-library-page"},sa={class:"page-container"},na={class:"form-box-wrapper"},la={__name:"index",setup(d){const u=X(),f=W(()=>u.query.library_id),r=y({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),s=g(!1),c=a=>{Object.assign(r,a),s.value=!0,v().then(()=>{s.value=!1}).catch(()=>{s.value=!1})},v=async()=>{let a={...C(r)};delete a.library_key,a.avatar_file?(a.avatar=a.avatar_file,delete a.avatar_file):(delete a.avatar,delete a.avatar_file),await T(a),I.success("修改成功")},m=()=>{E({id:f.value}).then(a=>{Object.assign(r,a.data)})};return k(()=>{m()}),(a,_)=>(F(),B("div",ia,[o(Y),i("div",sa,[i("div",na,[o(ra,{value:r,"onUpdate:value":_[0]||(_[0]=b=>r=b),saveLoading:s.value,onSubmit:c},null,8,["value","saveLoading"])])])]))}},Ta=A(la,[["__scopeId","data-v-d762895e"]]);export{Ta as default};
