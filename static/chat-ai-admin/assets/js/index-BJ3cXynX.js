import{M as x,N as w,F as K,$ as Q,W as t,Z as k,a0 as $,k as o,S as r,a4 as F,e as L,b as W,B as D,x as Z,Q as X,V as S,u as C,a1 as M,a2 as N,Y as ee}from"./vue-chunks-BjMuQ6KD.js";import{b as B,d as te,k as I,bF as O,bK as E,bE as ae,M as R,dI as oe,a0 as se,bH as ne,E as ie,bJ as re,B as le}from"../../index-CfxQ5aRu.js";import{_ as de,M as _e}from"./index-Bx_z5H0C.js";import"./index-CBvtIVuM.js";import{D as ce}from"./dropdown-DsYo-imx.js";import{t as pe}from"./validate-8MtiUsxW.js";import{A as me}from"./avatar-input-CyrSta4s.js";import{F as q,_ as ue}from"./index-xqeVJHPz.js";import"./index-DcUUFn-g.js";import{I as fe}from"./Input-C5WaaE9Z.js";import{_ as ve}from"./TextArea-CN_AI7y7.js";import{_ as ye}from"./page-alert-D48cNvXY.js";import{P as be}from"./PlusOutlined-xiVHYVI8.js";import"./axios-Cm0UX6qg.js";import"./qs-DjdPq-RR.js";import"./crypto-js-BemCeW_6.js";import"./dayjs-DK4rpucX.js";import"./shallowequal-B6gQS78g.js";import"./Trigger-Dy6Dc2CN.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-BH6Vz7El.js";import"./slide-BYYxYcj9.js";import"./index-CXSrVsd0.js";import"./index-D1MiuDW_.js";import"./colors-C9XVGyX_.js";import"./RightOutlined-BHf0iqSq.js";import"./move-BjmscfYf.js";import"./index-DqFgAaLP.js";import"./Password-BCnVcrNJ.js";import"./inputProps-D7qr__m5.js";import"./DownloadOutlined-BrqGknZq.js";import"./CheckOutlined-BLsT0eZM.js";import"./FormItemContext-DQ1b1ToO.js";import"./isPlainObject-xAKL-sfk.js";import"./responsiveObserve-X1b6Czsg.js";import"./QuestionCircleOutlined-Deh272L3.js";import"./index-D6-G2N0k.js";import"./Search-DozVr2pE.js";import"./SearchOutlined-B7dGgS_P.js";const he={class:"list-box"},ge=["onClick"],ke={class:"library-info"},xe=["src"],$e={class:"library-info-content"},we={class:"library-title"},Le={class:"item-body"},Ae={class:"library-desc"},Ce={class:"item-footer"},Ie={class:"library-size"},Be={class:"text-item"},De={class:"text-item"},Se=["onClick"],qe=["onClick"],Fe={__name:"index",props:{list:{type:Array,default:()=>[]},showCreate:{type:Boolean,default:!0}},emits:["add","edit","delete"],setup(l,{emit:b}){const m=b,_=l,c=p=>{m("edit",p)},f=p=>{m("delete",p)};return(p,u)=>{const s=te,n=de,e=_e,v=ce;return x(),w("div",he,[(x(!0),w(K,null,Q(_.list,d=>(x(),w("div",{class:"list-item-wrapper",key:d.id},[t("div",{class:"list-item",onClick:$(g=>c(d),["stop"])},[t("div",ke,[t("img",{class:"library-icon",src:d.avatar,alt:""},null,8,xe),t("div",$e,[t("div",we,k(d.library_name),1)])]),t("div",Le,[t("div",Ae,k(d.library_intro),1)]),t("div",Ce,[t("div",Ie,[t("span",Be,"文档："+k(d.file_total),1),t("span",De,"大小："+k(d.file_size_str),1)]),t("div",{class:"action-box",onClick:u[1]||(u[1]=$(()=>{},["stop"]))},[o(v,null,{overlay:r(()=>[o(e,null,{default:r(()=>[o(n,null,{default:r(()=>[t("a",{href:"javascript:;",onClick:$(g=>c(d),["stop"])},"管 理",8,Se)]),_:2},1024),o(n,null,{default:r(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:g=>f(d)},"删 除",8,qe)]),_:2},1024)]),_:2},1024)]),default:r(()=>[t("div",{class:"action-item",onClick:u[0]||(u[0]=$(()=>{},["stop"]))},[o(s,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,ge)]))),128))])}}},Me=B(Fe,[["__scopeId","data-v-8e17564f"]]),Ne=l=>(M("data-v-74974e9d"),l=l(),N(),l),Oe={class:"form-box"},Ee=Ne(()=>t("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),Re={__name:"add-library-model",setup(l,{expose:b}){I.config({duration:2});const m=F(),_=L(!1),c=W(()=>1);let f="",p="";const u=q.useForm,s=L(!1),n=c.value==0?O:E,e=D({type:c.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:n,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:c.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),v=D({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:d,validateInfos:g}=u(e,v),P=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},U=()=>{_.value=!1},V=()=>{d().then(()=>{z()}).catch(a=>{})},z=()=>{let a=new FormData,i=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",i.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(pe(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),s.value=!0,ae(a).then(h=>{I.success("创建成功"),p=h.data.id,f=h.data.library_key,Y(h.data.id)}).catch(()=>{s.value=!1})},J=async()=>await oe({library_key:f,doc_id:"",doc_type:"4",pid:0,title:"无标题文档",content:"# 无标题文档",sort:0}),Y=()=>{J().then(a=>{let i=a.data.doc_id;m.replace({path:"/public-library/editor",query:{library_id:p,library_key:f,doc_id:i}})})};return b({show:()=>{_.value=!0}}),Z(()=>{}),(a,i)=>{const h=fe,A=ue,j=ve,H=q,G=R;return x(),X(G,{open:_.value,"onUpdate:open":i[3]||(i[3]=y=>_.value=y),title:"添加知识库",onOk:V,confirmLoading:s.value,onCancel:U,width:"640px"},{default:r(()=>[t("div",Oe,[o(H,{"label-col":{span:5}},{default:r(()=>[o(A,S({ref:"name",label:"知识库名称"},C(g).library_name),{default:r(()=>[o(h,{value:e.library_name,"onUpdate:value":i[0]||(i[0]=y=>e.library_name=y),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),o(A,{label:"知识库简介"},{default:r(()=>[o(j,{maxlength:1e3,value:e.library_intro,"onUpdate:value":i[1]||(i[1]=y=>e.library_intro=y),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),o(A,S({ref:"name",label:"知识库封面"},C(g).avatar),{default:r(()=>[o(me,{value:e.avatar,"onUpdate:value":i[2]||(i[2]=y=>e.avatar=y),onChange:P},null,8,["value"]),Ee]),_:1},16)]),_:1})])]),_:1},8,["open","confirmLoading"])}}},Te=B(Re,[["__scopeId","data-v-74974e9d"]]),T=l=>(M("data-v-168c2444"),l=l(),N(),l),Pe={"bg-color":"#f5f9ff",class:"library-page"},Ue=T(()=>t("div",{class:"page-title"},"对外文档",-1)),Ve=T(()=>t("div",null,[t("p",null," 1、对外文档作为在线文档创作管理工具，创作的文档既可作为知识库关联到机器人使用，也可分享给好友查看。 "),t("p",null,"2、支持设置每篇文档的title、description、keyword，提高SEO搜索权重。")],-1)),ze={class:"library-page-body"},Je={class:"list-toolbar"},Ye={class:"toolbar-box"},je={class:"list-total"},He={class:"toolbar-box"},Ge={__name:"index",setup(l){F();const b=L(null),m=L([]),_=()=>{se({type:1}).then(s=>{let n=s.data||[];n.forEach(e=>{e.file_size_str=ne(e.file_size),e.avatar||(e.avatar=e.type==0?O:E)}),m.value=n})};_();const c=()=>{b.value.show()},f=s=>{window.open(`/#/public-library/home?library_id=${s.id}&library_key=${s.library_key}`,"_blank","noopener")},p=s=>{let n=3,e=R.confirm({title:`删除${s.library_name}`,icon:o(ie),content:"您确定要删除此知识库吗？",okText:n+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){u(s)},onCancel(){}}),v=setInterval(()=>{n==1?(e.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(v),v=void 0):(n-=1,e.update({okText:n+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},u=({id:s})=>{re({id:s}).then(()=>{I.success("删除成功"),_()})};return(s,n)=>{const e=le;return x(),w("div",Pe,[Ue,o(ye,{style:{"margin-bottom":"16px"},title:"使用说明"},{default:r(()=>[Ve]),_:1}),t("div",ze,[t("div",Je,[t("div",Ye,[t("h3",je,"全部 ("+k(m.value.length)+")",1)]),t("div",He,[o(e,{type:"primary",onClick:n[0]||(n[0]=v=>c())},{icon:r(()=>[o(C(be))]),default:r(()=>[ee(" 新建对外文档 ")]),_:1})])]),t("div",null,[o(Me,{list:m.value,onAdd:c,onEdit:f,onDelete:p},null,8,["list"])])]),o(Te,{ref_key:"addLibraryModelRef",ref:b},null,512)])}}},Nt=B(Ge,[["__scopeId","data-v-168c2444"]]);export{Nt as default};
