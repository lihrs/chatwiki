import{_ as Wt}from"./cu-scroll-ClwfOnpN.js";import{q as K,F as Xt,p as _e,x as at,Q as ce,O as Zt,A as pt,b as we,bR as ye,k as Y,d as mt,M as ae,bS as Kt,f as ft,B as vt,bT as ke,bU as eo,bL as to,e as oo,bV as ao,bH as no,n as nt,V as so,a1 as xe,br as he,E as lo,bW as io,bX as uo,bY as _o,bZ as co,b_ as ro,aC as po}from"../../index-CfxQ5aRu.js";import{f as st,e as y,k as e,a4 as Ue,a5 as Ie,B as ee,M as o,N as i,S as a,W as t,V as mo,u as I,a7 as _,Q as T,F as E,$ as re,a6 as ht,Z as $,aa as Pe,Y as r,a1 as Te,a2 as Me,b as Oe,x as fo,D as vo,ai as ho,G as $e,a0 as qe,H as lt}from"./vue-chunks-BjMuQ6KD.js";import{U as gt}from"./upload-input-KJwzMPlh.js";import{t as it}from"./validate-8MtiUsxW.js";import{F as be,_ as De}from"./index-xqeVJHPz.js";import"./index-DcUUFn-g.js";import{I as Ce}from"./Input-C5WaaE9Z.js";import"./index-DPiF7UEG.js";import{R as go,_ as yo}from"./RadioButton-_iRIgmgW.js";import{M as ut}from"./model-select-c6lAzYs5.js";import{O as ko}from"./open-grapg-modal-DZKHM53P.js";import{D as bo}from"./DownOutlined-Gk0UBxct.js";import{U as wo}from"./UpOutlined-CY9GinGn.js";import{_ as Co}from"./index-Capld-U4.js";import{S as Re,_ as Ne}from"./index-BuS_bfCI.js";import{R as xo}from"./rename-modal-BPJhzzDn.js";import{_ as Oo}from"./page-alert-D48cNvXY.js";import{C as $o}from"./index-CxLzlFzW.js";import{g as qo,c as _t,d as So,r as Fo,a as Lo}from"./index-BGu3mc-Q.js";import{u as ct}from"./FormItemContext-DQ1b1ToO.js";import{_ as Po,M as Uo}from"./index-Bx_z5H0C.js";import"./index-CBvtIVuM.js";import{D as Io}from"./dropdown-DsYo-imx.js";import{g as To}from"./index-DqFgAaLP.js";import{S as Mo}from"./index-BLP-Fxny.js";import{_ as Do}from"./index-DAEefp5e.js";import{P as Ro}from"./PlusOutlined-xiVHYVI8.js";import{S as No}from"./SearchOutlined-B7dGgS_P.js";import{C as Se}from"./ClockCircleFilled-BsRXNW0P.js";import{S as zo}from"./SyncOutlined-DZpJ_zyP.js";import{M as Ho}from"./MoreOutlined-DLVu09bY.js";import{_ as Eo}from"./index-D8Y0HnA5.js";import{_ as Bo}from"./index-BCGkuM1J.js";import{_ as Vo}from"./index-C-uK-k7U.js";import{_ as jo}from"./index-D1MiuDW_.js";import{a as Go}from"./index-P3IiyBCy.js";import{_ as Ao}from"./TextArea-CN_AI7y7.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-DjdPq-RR.js";import"./crypto-js-BemCeW_6.js";import"./dayjs-DK4rpucX.js";import"./InboxOutlined-CqHQumjT.js";import"./Trigger-Dy6Dc2CN.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-xAKL-sfk.js";import"./responsiveObserve-X1b6Czsg.js";import"./collapseMotion-BH6Vz7El.js";import"./QuestionCircleOutlined-Deh272L3.js";import"./index-D6-G2N0k.js";import"./Search-DozVr2pE.js";import"./inputProps-D7qr__m5.js";import"./Password-BCnVcrNJ.js";import"./Checkbox-DQe8ZxR1.js";import"./index-d7geF-HW.js";import"./slide-BYYxYcj9.js";import"./index-CXSrVsd0.js";import"./CheckOutlined-BLsT0eZM.js";import"./move-BjmscfYf.js";import"./index-BSl1-tWC.js";import"./index-C3Es6Ui_.js";import"./colors-C9XVGyX_.js";import"./shallowequal-B6gQS78g.js";import"./RightOutlined-BHf0iqSq.js";import"./DownloadOutlined-BrqGknZq.js";import"./index-C38XHIGB.js";import"./useMaxLevel-C9fYQrQA.js";import"./CaretDownFilled-CgS0_Akm.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-qzkQKHcF.js";import"./CaretDownOutlined-Qu8nVykI.js";const Fe=()=>({format:String,showNow:ce(),showHour:ce(),showMinute:ce(),showSecond:ce(),use12Hours:ce(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:ce(),popupClassName:String,status:Zt()});function Qo(d){const k=qo(d,K(K({},Fe()),{order:{type:Boolean,default:!0}})),{TimePicker:w,RangePicker:q}=k,f=st({name:"ATimePicker",inheritAttrs:!1,props:K(K(K(K({},_t()),So()),Fe()),{addon:{type:Function}}),slots:Object,setup(P,z){let{slots:S,expose:F,emit:v,attrs:c}=z;const C=P,R=ct();Xt(!(S.addon||C.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const U=y();F({focus:()=>{var l;(l=U.value)===null||l===void 0||l.focus()},blur:()=>{var l;(l=U.value)===null||l===void 0||l.blur()}});const D=(l,H)=>{v("update:value",l),v("change",l,H),R.onFieldChange()},b=l=>{v("update:open",l),v("openChange",l)},x=l=>{v("focus",l)},X=l=>{v("blur",l),R.onFieldBlur()},h=l=>{v("ok",l)};return()=>{const{id:l=R.id.value}=C;return e(w,_e(_e(_e({},c),at(C,["onUpdate:value","onUpdate:open"])),{},{id:l,dropdownClassName:C.popupClassName,mode:void 0,ref:U,renderExtraFooter:C.addon||S.addon||C.renderExtraFooter||S.renderExtraFooter,onChange:D,onOpenChange:b,onFocus:x,onBlur:X,onOk:h}),S)}}}),J=st({name:"ATimeRangePicker",inheritAttrs:!1,props:K(K(K(K({},_t()),Fo()),Fe()),{order:{type:Boolean,default:!0}}),slots:Object,setup(P,z){let{slots:S,expose:F,emit:v,attrs:c}=z;const C=P,R=y(),U=ct();F({focus:()=>{var p;(p=R.value)===null||p===void 0||p.focus()},blur:()=>{var p;(p=R.value)===null||p===void 0||p.blur()}});const D=(p,W)=>{v("update:value",p),v("change",p,W),U.onFieldChange()},b=p=>{v("update:open",p),v("openChange",p)},x=p=>{v("focus",p)},X=p=>{v("blur",p),U.onFieldBlur()},h=(p,W)=>{v("panelChange",p,W)},l=p=>{v("ok",p)},H=(p,W,te)=>{v("calendarChange",p,W,te)};return()=>{const{id:p=U.id.value}=C;return e(q,_e(_e(_e({},c),at(C,["onUpdate:open","onUpdate:value"])),{},{id:p,dropdownClassName:C.popupClassName,picker:"time",mode:void 0,ref:R,onChange:D,onOpenChange:b,onFocus:x,onBlur:X,onPanelChange:h,onOk:l,onCalendarChange:H}),S)}}});return{TimePicker:f,TimeRangePicker:J}}const{TimePicker:ge,TimeRangePicker:Le}=Qo(Lo),yt=K(ge,{TimePicker:ge,TimeRangePicker:Le,install:d=>(d.component(ge.name,ge),d.component(Le.name,Le),d)});var Yo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const Jo=Yo;function rt(d){for(var k=1;k<arguments.length;k++){var w=arguments[k]!=null?Object(arguments[k]):{},q=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(q=q.concat(Object.getOwnPropertySymbols(w).filter(function(f){return Object.getOwnPropertyDescriptor(w,f).enumerable}))),q.forEach(function(f){Wo(d,f,w[f])})}return d}function Wo(d,k,w){return k in d?Object.defineProperty(d,k,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[k]=w,d}var ze=function(k,w){var q=rt({},k,w.attrs);return e(pt,rt({},q,{icon:Jo}),null)};ze.displayName="CopyOutlined";ze.inheritAttrs=!1;const Xo=ze;var Zo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};const Ko=Zo;function dt(d){for(var k=1;k<arguments.length;k++){var w=arguments[k]!=null?Object(arguments[k]):{},q=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(q=q.concat(Object.getOwnPropertySymbols(w).filter(function(f){return Object.getOwnPropertyDescriptor(w,f).enumerable}))),q.forEach(function(f){ea(d,f,w[f])})}return d}function ea(d,k,w){return k in d?Object.defineProperty(d,k,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[k]=w,d}var He=function(k,w){var q=dt({},k,w.attrs);return e(pt,dt({},q,{icon:Ko}),null)};He.displayName="HourglassFilled";He.inheritAttrs=!1;const ta=He,oa={class:"form-box"},aa={class:"upload-document-type-box"},na=["onClick"],sa={class:"right-block"},la={class:"title-block"},ia={class:"title-text"},ua={class:"desc"},_a={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(d,{expose:k,emit:w}){const q=Ue(),f=Ie(),J=be.useForm,P=y(!1),z=y("添加自定义文档"),S=d,F=ee({library_id:f.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),v=y([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),c=h=>{F.qa_index_type=h},C=ee({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:R,validate:U,validateInfos:D}=J(F,C),b=()=>{P.value=!0,R(),F.file_name="",F.is_qa_doc=0,F.qa_index_type=1,S.libraryInfo.type==2&&(F.is_qa_doc=1)},x=y(!1),X=()=>{U().then(()=>{let h={...Pe(F)};x.value=!0,ye(h).then(l=>{Y.success(`${z.value}成功`),P.value=!1,q.push("/library/preview?id="+l.data.file_ids[0])}).finally(()=>{x.value=!1})})};return k({add:b}),(h,l)=>{const H=Ce,p=De,W=go,te=yo,oe=mt,g=be,N=ae;return o(),i("div",null,[e(N,{open:P.value,"onUpdate:open":l[2]||(l[2]=B=>P.value=B),title:z.value,onOk:X,width:"472px",confirmLoading:x.value},{default:a(()=>[t("div",oa,[e(g,{layout:"vertical"},{default:a(()=>[e(p,mo({label:"文档名称"},I(D).file_name),{default:a(()=>[e(H,{type:"text",placeholder:"请输入文档名称",value:F.file_name,"onUpdate:value":l[0]||(l[0]=B=>F.file_name=B)},null,8,["value"])]),_:1},16),_("",!0),F.is_qa_doc==1?(o(),T(p,{key:1,label:"索引方式",required:""},{default:a(()=>[t("div",aa,[(o(!0),i(E,null,re(v.value,B=>(o(),i("div",{class:ht(["type-item",{active:F.qa_index_type==B.value}]),key:B.value,onClick:ve=>c(B.value)},[t("div",sa,[t("div",la,[e(oe,{name:F.qa_index_type==B.value?B.iconNameActive:B.iconName},null,8,["name"]),t("div",ia,$(B.title),1)]),t("div",ua,$(B.desc),1)]),F.qa_index_type==B.value?(o(),T(oe,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):_("",!0)],10,na))),128))])]),_:1})):_("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},ca=we(_a,[["__scopeId","data-v-0fbc9294"]]),ne=d=>(Te("data-v-64d599b8"),d=d(),Me(),d),ra={class:"alert-box"},da=ne(()=>t("div",null,[r(" 通过word或者EXce形式导入问答对，建议您参考"),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),r("  "),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),r("创建导入文档 ")],-1)),pa=ne(()=>t("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)),ma={class:"upload-file-box"},fa={key:0,class:"hight-set"},va={key:0,class:"set-box"},ha={class:"form-item"},ga=ne(()=>t("div",{class:"form-item-label"},"问题所在列：",-1)),ya={class:"form-item-body"},ka={class:"form-item"},ba=ne(()=>t("div",{class:"form-item-label"},"相似问法所在列：",-1)),wa={class:"form-item-body"},Ca={class:"form-item"},xa=ne(()=>t("div",{class:"form-item-label"},"答案所在列：",-1)),Oa={class:"form-item-body"},$a={key:1,class:"set-box"},qa={class:"form-item"},Sa=ne(()=>t("div",{class:"form-item-label"},"问题开始标识符：",-1)),Fa={class:"form-item-body"},La={class:"form-item"},Pa=ne(()=>t("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),Ua={class:"form-item-body"},Ia={class:"form-item"},Ta=ne(()=>t("div",{class:"form-item-label"},"答案开始标识符：",-1)),Ma={class:"form-item-body"},Da={__name:"qa-upload-modal",emits:["ok"],setup(d,{expose:k,emit:w}){const q=Ue(),J=Ie().query,P=y(!1),z=y(!1),S=y([]),F=w,v=y([]),c=ee({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),C=y(!0),R=()=>{P.value=!0},U=()=>{let h=new FormData;S.value.forEach(l=>{h.append("library_files",l)}),Kt(h).then(l=>{let H=[];for(let p in l.data)H.push({lable:l.data[p],value:p});v.value=H})},D=()=>{if(S.value.length==0){Y.error("请选择文件");return}z.value=!0;let h=new FormData;h.append("library_id",J.id);let l=!1;S.value.forEach(H=>{(H.name.includes(".xlsx")||H.name.includes(".csv"))&&(l=!0),h.append("library_files",H)}),l?(h.append("question_column",c.question_column),h.append("answer_column",c.answer_column),c.similar_column&&h.append("similar_column",c.similar_column)):(h.append("question_lable",c.question_lable),h.append("answer_lable",c.answer_lable),h.append("similar_label",c.similar_label)),h.append("is_qa_doc",1),ye(h).then(H=>{F("ok"),P.value=!1,S.value=[],z.value=!1,l&&q.push("/library/document-segmentation?document_id="+H.data.file_ids[0])}).catch(()=>{z.value=!1})},b=()=>{S.value=[]},x=y(1),X=h=>{c.question_column=void 0,c.answer_column=void 0,c.similar_column=void 0,c.question_lable="问题：",c.answer_lable="答案：",c.similar_label="相似问题：",S.value=h,h&&h.length>0&&(h[0].type.includes(".document")?x.value=2:(x.value=1,U()))};return k({show:R}),(h,l)=>{const H=Co,p=Re,W=Ne,te=Ce,oe=ae;return o(),i("div",null,[e(oe,{width:680,open:P.value,"onUpdate:open":l[8]||(l[8]=g=>P.value=g),"confirm-loading":z.value,maskClosable:!1,title:"上传文档",onOk:D,onCancel:b},{default:a(()=>[t("div",ra,[e(H,{"show-icon":""},{message:a(()=>[da,pa]),_:1})]),t("div",ma,[e(gt,{type:2,value:S.value,"onUpdate:value":l[0]||(l[0]=g=>S.value=g),onChange:X},null,8,["value"])]),S.value.length>0?(o(),i("div",fa,[t("a",{onClick:l[1]||(l[1]=g=>C.value=!C.value)},[r("高级设置： "),C.value?(o(),T(I(wo),{key:1})):(o(),T(I(bo),{key:0}))]),C.value?(o(),i(E,{key:0},[x.value==1?(o(),i("div",va,[t("div",ha,[ga,t("div",ya,[e(W,{value:c.question_column,"onUpdate:value":l[2]||(l[2]=g=>c.question_column=g),placeholder:"请选择列名",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,re(v.value,g=>(o(),T(p,{value:g.value,key:g.value},{default:a(()=>[r($(g.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",ka,[ba,t("div",wa,[e(W,{value:c.similar_column,"onUpdate:value":l[3]||(l[3]=g=>c.similar_column=g),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,re(v.value,g=>(o(),T(p,{value:g.value,key:g.value},{default:a(()=>[r($(g.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",Ca,[xa,t("div",Oa,[e(W,{value:c.answer_column,"onUpdate:value":l[4]||(l[4]=g=>c.answer_column=g),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,re(v.value,g=>(o(),T(p,{value:g.value,key:g.value},{default:a(()=>[r($(g.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):_("",!0),x.value==2?(o(),i("div",$a,[t("div",qa,[Sa,t("div",Fa,[e(te,{placeholder:"请输入标识符",value:c.question_lable,"onUpdate:value":l[5]||(l[5]=g=>c.question_lable=g)},null,8,["value"])])]),t("div",La,[Pa,t("div",Ua,[e(te,{placeholder:"请输入标识符",value:c.similar_label,"onUpdate:value":l[6]||(l[6]=g=>c.similar_label=g)},null,8,["value"])])]),t("div",Ia,[Ta,t("div",Ma,[e(te,{placeholder:"请输入标识符",value:c.answer_lable,"onUpdate:value":l[7]||(l[7]=g=>c.answer_lable=g)},null,8,["value"])])])])):_("",!0)],64)):_("",!0)])):_("",!0)]),_:1},8,["open","confirm-loading"])])}}},Ra=we(Da,[["__scopeId","data-v-64d599b8"]]),Na="/assets/img/guide-image-DSu20zRj.png",Ee=d=>(Te("data-v-d94a3a33"),d=d(),Me(),d),za={class:"container"},Ha={class:"guide-content"},Ea=Ee(()=>t("img",{src:Na,alt:"操作引导",class:"guide-image"},null,-1)),Ba={class:"content-box"},Va=Ee(()=>t("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),ja=Ee(()=>t("div",{class:"content-check"},"不再显示此提示",-1)),Ga={__name:"guide-learning-tips",setup(d,{expose:k}){const w=ft(),q=y(!1),f=y(!1),J=y(""),P=()=>{setTimeout(()=>{q.value=!0},500)},z=()=>{w.setGuideLearningTips(f.value),q.value=!1},S=()=>{w.setGuideLearningTips(f.value),q.value=!1};return k({show:P}),(F,v)=>{const c=$o,C=vt,R=ae;return o(),i("div",za,[e(R,{open:q.value,"onUpdate:open":v[1]||(v[1]=U=>q.value=U),title:J.value,onOk:z,onCancel:S,width:"472px"},{footer:a(()=>[e(C,{type:"primary",onClick:z},{default:a(()=>[r("我知道了")]),_:1})]),default:a(()=>[t("div",Ha,[Ea,t("div",Ba,[Va,e(c,{checked:f.value,"onUpdate:checked":v[0]||(v[0]=U=>f.value=U)},{default:a(()=>[ja]),_:1},8,["checked"])])])]),_:1},8,["open","title"])])}}},Aa=we(Ga,[["__scopeId","data-v-d94a3a33"]]),Qa={__name:"edit-online-doc",emits:["ok"],setup(d,{expose:k,emit:w}){const q=w,f=ee({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),J=y({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),P=y(!1),z=c=>{c=JSON.parse(JSON.stringify(c)),f.id=c.id||"",f.file_name=c.file_name||"",f.doc_auto_renew_frequency=+c.doc_auto_renew_frequency||1,c.doc_auto_renew_minute>0&&(f.doc_auto_renew_minute=ke(c.doc_auto_renew_minute)),P.value=!0},S=y(!1),F=y(null),v=()=>{F.value.validate().then(()=>{S.value=!0,eo({...f,doc_auto_renew_minute:f.doc_auto_renew_minute?ke(f.doc_auto_renew_minute):0}).then(()=>{P.value=!1,S.value=!1,q("ok")})}).catch(()=>{S.value=!1})};return k({show:z}),(c,C)=>{const R=Ce,U=De,D=Re,b=Ne,x=yt,X=be,h=ae;return o(),i("div",null,[e(h,{open:P.value,"onUpdate:open":C[3]||(C[3]=l=>P.value=l),"confirm-loading":S.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:v},{default:a(()=>[e(X,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:F,model:f,rules:J.value},{default:a(()=>[e(U,{name:"file_name",label:"文件名称"},{default:a(()=>[e(R,{value:f.file_name,"onUpdate:value":C[0]||(C[0]=l=>f.file_name=l),placeholder:"请输入"},null,8,["value"])]),_:1}),e(U,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:a(()=>[e(b,{value:f.doc_auto_renew_frequency,"onUpdate:value":C[1]||(C[1]=l=>f.doc_auto_renew_frequency=l),style:{width:"100%"}},{default:a(()=>[e(D,{value:1},{default:a(()=>[r("不自动更新")]),_:1}),e(D,{value:2},{default:a(()=>[r("每天")]),_:1}),e(D,{value:3},{default:a(()=>[r("每3天")]),_:1}),e(D,{value:4},{default:a(()=>[r("每7天")]),_:1}),e(D,{value:5},{default:a(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),f.doc_auto_renew_frequency>1?(o(),T(U,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(x,{valueFormat:"HH:mm",value:f.doc_auto_renew_minute,"onUpdate:value":C[2]||(C[2]=l=>f.doc_auto_renew_minute=l),format:"HH:mm"},null,8,["value"])]),_:1})):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},G=d=>(Te("data-v-5ba0dc85"),d=d(),Me(),d),Ya={class:"details-library-page"},Ja={class:"list-tools"},Wa={class:"tools-items"},Xa={class:"tool-item"},Za={class:"dropdown-btn-menu"},Ka=G(()=>t("div",{class:"title"},"本地文档",-1)),en={key:0,class:"desc"},tn={key:1,class:"desc"},on={class:"dropdown-btn-menu"},an=G(()=>t("div",{class:"title"},"在线数据",-1)),nn=G(()=>t("div",{class:"desc"},"获取在线网页内容",-1)),sn={class:"dropdown-btn-menu"},ln=G(()=>t("div",{class:"title"},"自定义文档",-1)),un=G(()=>t("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1)),_n=G(()=>t("span",null,"添加内容",-1)),cn=G(()=>t("span",null,"嵌入模型：",-1)),rn=G(()=>t("span",null,"生成知识图谱：",-1)),dn={class:"right-box"},pn={key:0,class:"status-box"},mn={class:"status-item"},fn=G(()=>t("div",{class:"status-label"},"已学习：",-1)),vn={class:"status-content"},hn={class:"status-item"},gn=G(()=>t("div",{class:"status-label"},"，未学习：",-1)),yn={class:"status-content content-tip"},kn={class:"status-item"},bn=G(()=>t("div",{class:"status-label"},"，学习失败：",-1)),wn={class:"status-content content-tip"},Cn={key:1,class:"status-select-box"},xn={class:"tool-item"},On=G(()=>t("div",null,[t("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),t("p",null,"2、未学习的文档数据不会被检索到。")],-1)),$n={class:"list-content"},qn={key:0,class:"doc-name-td"},Sn=["href"],Fn=["onClick"],Ln={key:0},Pn={key:1},Un=["onClick"],In={key:0},Tn={key:1},Mn={key:2,class:"url-remark"},Dn=["onClick"],Rn={key:0,class:"pdf-progress-box"},Nn={class:"progress-title"},zn={class:"status-box"},Hn=["onClick"],En={class:"progress-bar"},Bn={class:"num-box"},Vn={key:0,class:"status-tag running"},jn={key:2,class:"status-tag running"},Gn={key:3,class:"status-tag complete"},An={class:"status-tag status-error"},Qn=["onClick"],Yn={class:"status-tag status-error"},Jn={class:"status-tag"},Wn=["onClick"],Xn={key:7,class:"status-tag"},Zn={key:8,class:"status-tag running"},Kn={class:"status-tag error"},es={key:10,class:"status-tag cancel"},ts={key:11,class:"status-tag subning"},os={class:"status-tag"},as=["onClick"],ns={key:1,class:"status-tag running"},ss={key:2,class:"status-tag complete"},ls={class:"status-tag error"},is=["onClick"],us={class:"zm-line1 reason-text"},_s={key:4,class:"status-tag running"},cs={class:"status-tag warning"},rs={class:"reason-text"},ds=["onClick"],ps={key:0},ms={key:1},fs={key:0,class:"text-block"},vs={class:"time-content-box"},hs={key:0},gs={key:1},ys={key:2},ks={key:3},bs={key:4},ws={key:5,class:"ml4"},Cs={key:6},xs=["onClick"],Os=G(()=>t("a",{class:"ml4 btn-hover-block"},"更新",-1)),$s={key:1},qs={key:0},Ss={key:1},Fs=["onClick"],Ls=["onClick"],Ps=["onClick"],Us=G(()=>t("span",null,"删除",-1)),Is={class:"upload-file-box"},Ts={class:"select-card-box"},Ms=["onClick"],Ds={class:"card-title"},Rs={key:0,class:"card-switch-box"},Ns={class:"card-desc"},zs={key:0,class:"card-switch"},Hs={__name:"knowledge-document",setup(d){const{setStorage:k}=po("localStorage"),w=to(),{changeGraphSwitch:q}=w,f=oo(),J=Oe(()=>{var s;return((s=f.companyInfo)==null?void 0:s.neo4j_status)=="true"}),P=Oe(()=>{var s;return((s=f.companyInfo)==null?void 0:s.ali_ocr_switch)=="1"}),z=ft(),S=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"},{key:4,title:"阿里云OCR解析",icon:"ali-ocr",desc:"通过阿里云文档智能接口解析提取图片和文字"}],F=Ie(),v=Ue(),c=F.query,C=y(!1),R=y(null),U=y(null),D=y(!1),b=y({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});ee({selectedRowKeys:[]});const x=ee({use_model:"",model_config_id:""}),X=(s,u)=>{let O=u.modelName,V=u.modelId;oe.value.length>0?ae.confirm({title:`确定切换模型为${O}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){x.use_model=O,x.model_config_id=V,h()},onCancel(){}}):(x.use_model=O,x.model_config_id=V,h())},h=(s=!0,u=null)=>{io({...Pe(b.value),use_model:x.use_model,model_config_id:x.model_config_id}).then(()=>{b.value.use_model=x.use_model,b.value.model_config_id=x.model_config_id,typeof u=="function"&&u(),s&&Y.success("保存成功")})},l=y([]),H=s=>{l.value=s},p=y([]),W=s=>{p.value=s,te()},te=()=>{if(!b.value.id){setTimeout(()=>{te()},100);return}if(p.value.length>0&&!b.value.use_model){let s=null,u=null;for(let O of p.value)if(O.model_define==="chatwiki"){s=O;for(let V of s.children)if(V.name==="text-embedding-v2"){u=V;break}break}s||(s=p.value[0],u=s.children[0]),s&&(x.use_model=u.name,x.model_config_id=u.model_config_id,h(!1))}},oe=y([]),g=ee({learned_err_count:0,learned_count:0,learned_wait_count:0}),N=ee({library_id:c.id,file_name:void 0,status:"",page:1,size:10,total:0}),B=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],ve=y([]),Be=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],kt=s=>{se()},bt=s=>{N.page=s.current,N.size=s.pageSize,A()},se=()=>{N.page=1,A()};let Ve=!1;const wt=({id:s})=>{oe.value.length==1&&(Ve=!0),uo({id:s}).then(()=>{Ve&&N.page>1&&N.page--,A(),Y.success("删除成功")})},le=(s,u={})=>{if(s.status=="4")return v.push({path:"/library/document-segmentation",query:{document_id:s.id,page:N.page}});if(s.status=="3"&&b.value.type!=2)return Y.error("学习失败,不可预览");if(s.status=="0")return Y.error("转换中,稍候可预览");if(s.status=="1")return Y.error("学习中,不可预览");if(s.status=="6")return Y.error("获取中,不可预览");if(s.status=="7")return Y.error("获取失败,不可预览");if(s.status=="10")return Y.error("正在分段,不可预览");v.push({name:"libraryPreview",query:{id:s.id,...u}})},A=()=>{let s=Pe(N);s.status==0&&(s.status=""),C.value=!0,ao(s).then(u=>{let O=u.data.info;!x.use_model&&x.use_model!=O.use_model&&(x.use_model=O.use_model,x.model_config_id=O.model_config_id),b.value={...O},D.value=O.graph_switch==1,O.graph_switch=="0"||!J.value?ve.value=Be.filter(Q=>!["graph_status","graph_entity_count"].includes(Q.key)):ve.value=Be;let V=u.data.list||[],Z=u.data.count_data||{};N.total=u.data.total,g.learned_count=Z.learned_count,g.learned_err_count=Z.learned_err_count,g.learned_wait_count=Z.learned_wait_count;let ie=!1;oe.value=V.map(Q=>(["1","6","0","5"].includes(Q.status)&&(ie=!0),Q.file_size_str=no(Q.file_size),Q.update_time=nt(Q.update_time*1e3).format("YYYY-MM-DD HH:mm"),Q.doc_last_renew_time_desc=Q.doc_last_renew_time>0?nt(Q.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",Q)),ie&&Ct(),!ie&&clearInterval(de.value)}).finally(()=>{C.value=!1})},de=y(null),Ct=()=>{clearInterval(de.value),de.value=setInterval(()=>{A()},1e3*5)},je=y(null),xt=s=>{if(p.value.length==0){ae.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){v.push({path:"/user/model"})}});return}let{key:u}=s;u==1&&St(),u==2&&Ot(),u==3&&je.value.add()},L=ee({open:!1,urls:"",library_id:c.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(s,u)=>it(u)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),Ot=()=>{L.open=!0,L.confirmLoading=!1,L.urls="",L.doc_auto_renew_minute="02:00",L.doc_auto_renew_frequency=1},Ge=y(null),$t=()=>{Ge.value.validate().then(()=>{L.confirmLoading=!0,ye({library_id:L.library_id,urls:JSON.stringify(it(L.urls)),doc_auto_renew_frequency:L.doc_auto_renew_frequency,doc_auto_renew_minute:ke(L.doc_auto_renew_minute),doc_type:2}).then(()=>{L.open=!1,L.confirmLoading=!1,se()})}).catch(()=>{L.confirmLoading=!1})},qt=()=>{L.open=!1},M=ee({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),Ae=Oe(()=>M.fileList.filter(s=>s.type==="application/pdf").length>0),Qe=y(null),St=()=>{if(b.value.type==2){Qe.value.show();return}M.fileList=[],M.open=!0},Ft=()=>{M.fileList=[]},Lt=s=>{M.fileList=s},Pt=()=>{if(R.value&&!z.getGuideLearningTips&&M.fileList.length>1&&R.value.show(),M.fileList.length==0){Y.error("请选择文件");return}M.confirmLoading=!0;let s=new FormData;s.append("library_id",N.library_id);let u=!1;M.fileList.forEach(O=>{(O.name.includes(".xlsx")||O.name.includes(".csv"))&&(u=!0),s.append("library_files",O)}),Ae.value&&s.append("pdf_parse_type",M.pdf_parse_type),ye(s).then(O=>{A(),M.open=!1,M.fileList=[],M.confirmLoading=!1,u&&O.data.file_ids.length==1&&v.push("/library/document-segmentation?document_id="+O.data.file_ids[0])}).catch(()=>{M.confirmLoading=!1})},Ye=y(null),Ut=s=>{Ye.value.show(s)},It=s=>{v.push({path:"/library/document-segmentation",query:{document_id:s.id}})},Je=s=>{_o({id:s.id}).then(()=>{A()})},Tt=()=>{if(D.value){D.value=!1;let s={graph_model_config_id:b.value.graph_model_config_id,graph_use_model:b.value.graph_use_model};if((!s.graph_model_config_id||!s.graph_use_model)&&l.value.length>0){let O=l.value[0].children[0];s.graph_use_model=O.name,s.graph_model_config_id=O.model_config_id}U.value.show(s)}else b.value.graph_switch=0,h(!1,()=>{A(),q(0)})},Mt=s=>{D.value=!0,b.value.graph_switch=1,b.value.graph_model_config_id=s.graph_model_config_id,b.value.graph_use_model=s.graph_use_model,h(!1,()=>{A(),q(1)})},Dt=s=>{if(s.key==4&&!P.value)return!1;M.pdf_parse_type=s.key},Rt=()=>{window.open("#/user/aliocr")},We=y(null),Xe=s=>{We.value.show({...s})},Nt=s=>{co({id:s.id}).then(u=>{Y.success("更新成功"),A()})},zt=s=>{ae.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){ro({id:s.id}).then(u=>{Y.success("取消成功"),A()})}})},Ht=s=>{k("graph:autoOpenFileId",s.id),v.push({path:"/library/details/knowledge-graph",query:{id:c.id}})};return fo(()=>{c.page&&(N.page=+c.page),A()}),vo(()=>{de.value&&clearInterval(de.value)}),(s,u)=>{const O=mt,V=Eo,Z=Po,ie=Uo,Q=vt,Ze=Io,Et=Bo,ue=Re,Ke=Ne,Bt=Ce,Vt=Vo,jt=To,pe=Mo,me=jo,et=Do,Gt=Go,At=Wt,fe=De,tt=be,ot=ae,Qt=Ao,Yt=yt,Jt=ho("copy");return o(),i("div",Ya,[e(At,{scrollbar:!1},{default:a(()=>[t("div",Ja,[t("div",Wa,[t("div",Xa,[e(Ze,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:a(()=>[e(ie,{onClick:xt},{default:a(()=>[(o(),T(Z,{key:1},{default:a(()=>[t("div",Za,[e(V,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"doc-icon"}),Ka]),_:1}),b.value.type==2?(o(),i("div",en," 上传本地 docx/csv/xlsx 等格式文件 ")):(o(),i("div",tn," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),b.value.type!=2?(o(),T(Z,{key:2},{default:a(()=>[t("div",on,[e(V,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"link-icon"}),an]),_:1}),nn])]),_:1})):_("",!0),(o(),T(Z,{key:3},{default:a(()=>[t("div",sn,[e(V,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"cu-doc-icon"}),ln]),_:1}),un])]),_:1}))]),_:1})]),default:a(()=>[e(Q,{type:"primary"},{icon:a(()=>[e(I(Ro))]),default:a(()=>[_n]),_:1})]),_:1})]),$e(e(V,{align:"center",class:"tool-item custom-select-box"},{default:a(()=>[cn,e(ut,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:x.use_model,modeId:x.model_config_id,style:{width:"240px"},onChange:X,onLoaded:W},null,8,["modeName","modeId"])]),_:1},512),[[lt,!1]]),J.value?(o(),T(V,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:a(()=>[$e(e(ut,{modelType:"LLM",onLoaded:H},null,512),[[lt,!1]]),rn,e(Et,{checked:D.value,"onUpdate:checked":u[0]||(u[0]=m=>D.value=m),onChange:Tt,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):_("",!0)]),t("div",dn,[b.value.type==0?(o(),i("div",pn,[t("div",mn,[fn,t("div",vn,$(g.learned_count),1)]),t("div",hn,[gn,t("div",yn,$(g.learned_wait_count),1)]),t("div",kn,[bn,t("div",wn,$(g.learned_err_count),1)])])):_("",!0),b.value.type==0?(o(),i("div",Cn,[e(Ke,{value:N.status,"onUpdate:value":u[1]||(u[1]=m=>N.status=m),style:{width:"150px"},placeholder:"请选择",onChange:kt},{default:a(()=>[(o(),i(E,null,re(B,m=>e(ue,{key:m.id,value:m.id},{default:a(()=>[r($(m.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):_("",!0),t("div",xn,[e(Bt,{style:{width:"282px"},value:N.file_name,"onUpdate:value":u[2]||(u[2]=m=>N.file_name=m),placeholder:"请输入文档名称搜索",onChange:se},{suffix:a(()=>[e(I(No),{onClick:se,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),b.value.type==0?(o(),T(Oo,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:a(()=>[On]),_:1})):_("",!0),t("div",$n,[e(Gt,{columns:ve.value,"data-source":oe.value,scroll:{x:1e3},"row-key":"id",pagination:{current:N.page,total:N.total,pageSize:N.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:bt},{bodyCell:a(({column:m,record:n})=>[m.key==="file_name"?(o(),i("div",qn,[n.doc_type==2?(o(),T(Vt,{key:0,title:null},{content:a(()=>[r(" 原链接："),t("a",{href:n.doc_url,target:"_blank"},$(n.doc_url),9,Sn),$e(e(I(Xo),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[Jt,`${n.doc_url}`]])]),default:a(()=>[t("a",{onClick:j=>le(n)},[["5","6","7"].includes(n.status)?(o(),i("span",Ln,$(n.doc_url),1)):(o(),i("span",Pn,$(n.file_name),1))],8,Fn)]),_:2},1024)):(o(),i("a",{key:1,onClick:j=>le(n)},[["5","6","7"].includes(n.status)?(o(),i("span",In,$(n.doc_url),1)):(o(),i("span",Tn,$(n.file_name),1))],8,Un)),n.doc_type==2&&n.remark?(o(),i("div",Mn," 备注："+$(n.remark),1)):_("",!0)])):_("",!0),m.key==="graph_entity_count"?(o(),i("a",{key:1,onClick:j=>Ht(n)},$(n.graph_entity_count),9,Dn)):_("",!0),m.key==="status"?(o(),i(E,{key:2},[n.file_ext=="pdf"&&n.pdf_parse_type>=2?(o(),i(E,{key:0},[n.status==0?(o(),i("div",Rn,[t("div",Nn,[t("span",zn,[e(I(so)),r("文档解析中")]),t("a",{onClick:j=>zt(n)},"取消",8,Hn)]),t("div",En,[e(jt,{size:"small",class:"progress-bar-box",percent:parseInt(n.ocr_pdf_index/n.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),t("div",Bn,$(n.ocr_pdf_index)+" / "+$(n.ocr_pdf_total),1)])])):_("",!0)],64)):(o(),i(E,{key:1},[n.status==0?(o(),i("span",Vn,[e(pe,{size:"small"}),r(" 转换中")])):_("",!0)],64)),n.status==1?(o(),i("span",jn,[e(pe,{size:"small"}),r(" 学习中")])):_("",!0),n.status==2?(o(),i("span",Gn,[e(I(xe)),r(" 学习完成")])):_("",!0),n.status==3?(o(),T(me,{key:4,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",An,[e(I(he)),r(" 转换失败")]),b.value.type==2?(o(),i("a",{key:0,class:"ml8",onClick:j=>le(n)},"学习",8,Qn)):_("",!0)])]),_:2},1024)):_("",!0),n.status==8?(o(),T(me,{key:5,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",Yn,[e(I(he)),r(" 转化异常")])])]),_:2},1024)):_("",!0),n.status==4?(o(),i(E,{key:6},[t("span",Jn,[e(I(Se)),r(" 待学习")]),t("a",{class:"ml8",onClick:j=>le(n)},"学习",8,Wn)],64)):_("",!0),n.status==5?(o(),i("span",Xn,[e(I(Se)),r(" 待获取")])):_("",!0),n.status==6?(o(),i("span",Zn,[e(pe,{size:"small"}),r(" 获取中")])):_("",!0),n.status==7?(o(),T(me,{key:9,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",Kn,[e(I(he)),r(" 获取失败")])]),_:2},1024)):_("",!0),n.status==9?(o(),i("span",es,[e(I(lo)),r(" 取消解析")])):_("",!0),n.status==10?(o(),i("span",ts,[e(pe,{size:"small"}),r(" 正在分段 ")])):_("",!0)],64)):_("",!0),m.key==="graph_status"?(o(),i(E,{key:3},[n.graph_status==0?(o(),i(E,{key:0},[t("span",os,[e(I(Se)),r(" 待生成")]),t("a",{class:"ml8",onClick:j=>Je(n)},"生成",8,as)],64)):n.graph_status==1?(o(),i("span",ns,[e(I(ta)),r(" 排队中")])):n.graph_status==2?(o(),i("span",ss,[e(I(xe)),r(" 生成完成")])):n.graph_status==3?(o(),i(E,{key:3},[t("span",ls,[e(I(he)),r(" 生成失败")]),t("a",{class:"ml8",onClick:j=>Je(n)},"生成",8,is),n.graph_err_msg?(o(),T(me,{key:0,title:n.graph_err_msg},{default:a(()=>[t("div",us,"原因："+$(n.graph_err_msg),1)]),_:2},1032,["title"])):_("",!0)],64)):n.graph_status==4?(o(),i("span",_s,[e(pe,{size:"small"}),r(" 生成中")])):n.graph_status==5?(o(),i(E,{key:5},[t("span",cs,[e(I(xe)),r(" 部分成功")]),t("div",rs,[r(" 失败数："+$(n.graph_err_count||0)+" ",1),t("a",{class:"ml8",onClick:j=>le(n,{graph_status:3})},"详情",8,ds)])],64)):_("",!0)],64)):_("",!0),m.key==="file_size"?(o(),i(E,{key:4},[n.doc_type==3?(o(),i("span",ps,"-")):(o(),i("span",ms,$(n.file_size_str),1))],64)):_("",!0),m.key==="doc_auto_renew_frequency"?(o(),i(E,{key:5},[n.doc_type==2?(o(),i("div",fs,[t("div",vs,[n.doc_auto_renew_frequency==1?(o(),i("span",hs,"不自动更新")):_("",!0),n.doc_auto_renew_frequency==2?(o(),i("span",gs,"每天")):_("",!0),n.doc_auto_renew_frequency==3?(o(),i("span",ys,"每3天")):_("",!0),n.doc_auto_renew_frequency==4?(o(),i("span",ks,"每7天")):_("",!0),n.doc_auto_renew_frequency==5?(o(),i("span",bs,"每30天")):_("",!0),n.doc_auto_renew_frequency>1&&n.doc_auto_renew_minute>0?(o(),i("span",ws,$(I(ke)(n.doc_auto_renew_minute)),1)):_("",!0),n.doc_auto_renew_frequency>1?(o(),i("span",Cs,"更新")):_("",!0),t("a",{class:"ml4 btn-hover-block",onClick:j=>Xe(n)},"修改",8,xs)]),e(V,{align:"center"},{default:a(()=>[r(" 最近更新: "+$(n.doc_last_renew_time_desc)+" ",1),e(et,{title:"确认更新?",onConfirm:j=>Nt(n)},{default:a(()=>[Os]),_:2},1032,["onConfirm"])]),_:2},1024)])):(o(),i("div",$s,"--"))],64)):_("",!0),m.key==="paragraph_count"?(o(),i(E,{key:6},[n.status==0||n.status==1?(o(),i("span",qs,"-")):(o(),i("span",Ss,$(n.paragraph_count),1))],64)):_("",!0),m.key==="action"?(o(),T(V,{key:7,gap:8},{default:a(()=>[e(me,null,{title:a(()=>[r("重新分段")]),default:a(()=>[e(I(zo),{class:"btn-hover-block",onClick:j=>It(n)},null,8,["onClick"])]),_:2},1024),e(Ze,null,{overlay:a(()=>[e(ie,null,{default:a(()=>[n.doc_type==2?(o(),T(Z,{key:0},{default:a(()=>[t("div",{onClick:j=>Xe(n)},"编辑",8,Fs)]),_:2},1024)):_("",!0),e(Z,{disabled:n.status==6||n.status==7||n.status==0},{default:a(()=>[t("div",{onClick:j=>le(n)},"预览",8,Ls)]),_:2},1032,["disabled"]),e(Z,null,{default:a(()=>[t("div",{onClick:j=>Ut(n)},"重命名",8,Ps)]),_:2},1024),e(Z,null,{default:a(()=>[e(et,{title:"确定要删除吗?",onConfirm:j=>wt(n)},{default:a(()=>[Us]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:a(()=>[t("div",{class:"table-btn",onClick:u[3]||(u[3]=qe(()=>{},["prevent"]))},[e(I(Ho),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):_("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),e(ot,{open:M.open,"onUpdate:open":u[5]||(u[5]=m=>M.open=m),"confirm-loading":M.confirmLoading,maskClosable:!1,title:"上传文档",onOk:Pt,onCancel:Ft,width:"740px"},{default:a(()=>[e(tt,{class:"mt24"},{default:a(()=>[e(fe,{required:"",label:""},{default:a(()=>[t("div",Is,[e(gt,{type:b.value.type,maxCount:20,value:M.fileList,"onUpdate:value":u[4]||(u[4]=m=>M.fileList=m),onChange:Lt},null,8,["type","value"])])]),_:1}),Ae.value?(o(),T(fe,{key:0,required:"",label:"PDF解析模式",class:"select-card-main"},{default:a(()=>[t("div",Ts,[(o(),i(E,null,re(S,m=>t("div",{key:m.key,class:ht(["select-card-item",{active:M.pdf_parse_type==m.key},{disabled:m.key==4&&!P.value}]),onClick:qe(n=>Dt(m),["stop"])},[e(O,{class:"check-arrow",name:"check-arrow-filled"}),t("div",Ds,[e(O,{name:m.icon,style:{"font-size":"16px"}},null,8,["name"]),r(" "+$(m.title)+" ",1),m.key==4&&!P.value?(o(),i("div",Rs,"未开启")):_("",!0)]),t("div",Ns,$(m.desc),1),m.key==4&&!P.value?(o(),i("div",zs,[r(" 未开启阿里云OCR "),t("div",{class:"card-switch-btn",onClick:qe(Rt,["stop"])},"去开启")])):_("",!0)],10,Ms)),64))])]),_:1})):_("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),e(Ra,{onOk:A,ref_key:"qaUploadModalRef",ref:Qe},null,512),e(ot,{open:L.open,"onUpdate:open":u[9]||(u[9]=m=>L.open=m),"confirm-loading":L.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:$t,onCancel:qt},{default:a(()=>[e(tt,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:Ge,model:L,rules:L.rules},{default:a(()=>[e(fe,{name:"urls",label:"网页链接"},{default:a(()=>[e(Qt,{style:{height:"120px"},value:L.urls,"onUpdate:value":u[6]||(u[6]=m=>L.urls=m),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),e(fe,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:a(()=>[e(Ke,{value:L.doc_auto_renew_frequency,"onUpdate:value":u[7]||(u[7]=m=>L.doc_auto_renew_frequency=m),style:{width:"100%"}},{default:a(()=>[e(ue,{value:1},{default:a(()=>[r("不自动更新")]),_:1}),e(ue,{value:2},{default:a(()=>[r("每天")]),_:1}),e(ue,{value:3},{default:a(()=>[r("每3天")]),_:1}),e(ue,{value:4},{default:a(()=>[r("每7天")]),_:1}),e(ue,{value:5},{default:a(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),L.doc_auto_renew_frequency>1?(o(),T(fe,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(Yt,{valueFormat:"HH:mm",value:L.doc_auto_renew_minute,"onUpdate:value":u[8]||(u[8]=m=>L.doc_auto_renew_minute=m),format:"HH:mm"},null,8,["value"])]),_:1})):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),e(ca,{libraryInfo:b.value,onOk:se,ref_key:"addCustomDocumentRef",ref:je},null,8,["libraryInfo"]),e(xo,{onOk:se,ref_key:"renameModalRef",ref:Ye},null,512),e(ko,{onOk:Mt,ref_key:"openGrapgModalRef",ref:U},null,512),e(Aa,{ref_key:"guideLearningTipsRef",ref:R},null,512),e(Qa,{onOk:A,ref_key:"editOnlineDocRef",ref:We},null,512)])}}},ii=we(Hs,[["__scopeId","data-v-5ba0dc85"]]);export{ii as default};
