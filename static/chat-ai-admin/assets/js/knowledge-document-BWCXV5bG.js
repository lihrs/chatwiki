import{_ as At}from"./cu-scroll-Bd7PzYPg.js";import{t as Z,S as Yt,V as ie,F as Qt,q as ue,y as Ze,I as ut,b as he,d as rt,M as oe,bS as ge,k as G,bM as dt,bT as Jt,h as _t,B as ct,bU as ye,bV as Wt,e as Xt,bW as Zt,bI as Kt,n as Ke,W as eo,a2 as we,br as fe,E as to,aD as oo,bX as no,bY as ao,bZ as so,b_ as lo,b$ as io}from"../../index-CptKfSUC.js";import{e as et,d as k,j as t,z as ee,a3 as Le,N as i,O as n,U as a,X as o,a6 as _,S as M,W as uo,u as I,F as H,a1 as re,a5 as pt,_ as O,a2 as Pe,Z as f,G as Fe,b as Ce,q as ro,D as _o,ag as co,H as xe,I as tt,a0 as Oe}from"./vue-chunks-BRsu9_To.js";import{U as mt}from"./upload-input-C8QvSZqz.js";import{t as ot}from"./validate-8MtiUsxW.js";import{F as ke,_ as Ue}from"./index-BdXFo1Yi.js";import"./index-CrGpUfGH.js";import{I as be}from"./Input-BFAHe0DY.js";import"./index-B0iUyVGC.js";import{_ as po,R as mo}from"./RadioButton-e2BmC77e.js";import{M as nt}from"./model-select-ClMVuS8r.js";import{O as fo}from"./open-grapg-modal-CJGO_HXh.js";import{D as vo}from"./DownOutlined-DkWiBss_.js";import{U as go}from"./UpOutlined-C2jweHdT.js";import{S as Te,a as Ie}from"./index-R3fGpy-Z.js";import{_ as yo}from"./index-fwiYl1aO.js";import{R as ko}from"./rename-modal-C14Nj2DU.js";import{_ as ho}from"./page-alert-CKLNQVT7.js";import{C as bo}from"./index-DN4kwDuY.js";import{g as wo,c as at,d as Co,r as xo,a as Oo}from"./index-r7NKfwc7.js";import{u as st}from"./FormItemContext-gpTH9eHq.js";import"./index-nIEZM5Jn.js";import{D as qo}from"./dropdown-DkTdpk0n.js";import{P as So}from"./PlusOutlined-BR72fkTP.js";import{M as $o,_ as Fo}from"./index-BMHN_ZHD.js";import{S as Lo}from"./SearchOutlined-BkABIbhb.js";import{g as Po}from"./index-hJ3NDJJa.js";import{S as Uo}from"./index-tAuPVUDA.js";import{C as qe}from"./ClockCircleFilled-Cbr6MCAP.js";import{_ as To}from"./index-XAx2VLNy.js";import{S as Io}from"./SyncOutlined-l95xVxUM.js";import{M as Mo}from"./MoreOutlined-Cp_BWUuk.js";import{_ as Do}from"./index-k-2TYXj4.js";import{_ as Ro}from"./index-CB2m4unW.js";import{a as No}from"./index-D3yXb4A5.js";import{_ as zo}from"./index-CAWZL4YD.js";import{_ as Ho}from"./index-SQEG4xim.js";import{_ as Eo}from"./TextArea-DZQUCnMF.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./InboxOutlined-Cfjq79m-.js";import"./Trigger-B5sPmMFr.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-iUjGA7o2.js";import"./responsiveObserve-BhysygCB.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-DXvm_sAY.js";import"./index-TvkCt6Hp.js";import"./Search-BuYDKTKT.js";import"./inputProps-DCrFQ5HR.js";import"./Password-BJfMc7qR.js";import"./Checkbox-iIXTQx8h.js";import"./index-DDsrBuja.js";import"./slide-D4Zk8vlN.js";import"./index-CreR3MX_.js";import"./CheckOutlined-CR4N2RZP.js";import"./move-Bc7ekOgk.js";import"./index-pWRbicsy.js";import"./index-DeXjdoSU.js";import"./colors-CB658H7g.js";import"./shallowequal-C0xnIuy8.js";import"./RightOutlined-Bjc8WMi4.js";import"./DownloadOutlined-H1KeEsM2.js";import"./index-6NVx8FNJ.js";import"./useMaxLevel-BNZ57_5u.js";import"./CaretDownFilled-D3E_EqQC.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-BEImUYMc.js";import"./CaretDownOutlined-sLMg0pHu.js";const Se=()=>({format:String,showNow:ie(),showHour:ie(),showMinute:ie(),showSecond:ie(),use12Hours:ie(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:ie(),popupClassName:String,status:Yt()});function jo(C){const h=wo(C,Z(Z({},Se()),{order:{type:Boolean,default:!0}})),{TimePicker:w,RangePicker:q}=h,v=et({name:"ATimePicker",inheritAttrs:!1,props:Z(Z(Z(Z({},at()),Co()),Se()),{addon:{type:Function}}),slots:Object,setup(P,z){let{slots:L,expose:y,emit:m,attrs:$}=z;const u=P,U=st();Qt(!(L.addon||u.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const T=k();y({focus:()=>{var r;(r=T.value)===null||r===void 0||r.focus()},blur:()=>{var r;(r=T.value)===null||r===void 0||r.blur()}});const R=(r,d)=>{m("update:value",r),m("change",r,d),U.onFieldChange()},b=r=>{m("update:open",r),m("openChange",r)},S=r=>{m("focus",r)},A=r=>{m("blur",r),U.onFieldBlur()},N=r=>{m("ok",r)};return()=>{const{id:r=U.id.value}=u;return t(w,ue(ue(ue({},$),Ze(u,["onUpdate:value","onUpdate:open"])),{},{id:r,dropdownClassName:u.popupClassName,mode:void 0,ref:T,renderExtraFooter:u.addon||L.addon||u.renderExtraFooter||L.renderExtraFooter,onChange:R,onOpenChange:b,onFocus:S,onBlur:A,onOk:N}),L)}}}),J=et({name:"ATimeRangePicker",inheritAttrs:!1,props:Z(Z(Z(Z({},at()),xo()),Se()),{order:{type:Boolean,default:!0}}),slots:Object,setup(P,z){let{slots:L,expose:y,emit:m,attrs:$}=z;const u=P,U=k(),T=st();y({focus:()=>{var p;(p=U.value)===null||p===void 0||p.focus()},blur:()=>{var p;(p=U.value)===null||p===void 0||p.blur()}});const R=(p,j)=>{m("update:value",p),m("change",p,j),T.onFieldChange()},b=p=>{m("update:open",p),m("openChange",p)},S=p=>{m("focus",p)},A=p=>{m("blur",p),T.onFieldBlur()},N=(p,j)=>{m("panelChange",p,j)},r=p=>{m("ok",p)},d=(p,j,te)=>{m("calendarChange",p,j,te)};return()=>{const{id:p=T.id.value}=u;return t(q,ue(ue(ue({},$),Ze(u,["onUpdate:open","onUpdate:value"])),{},{id:p,dropdownClassName:u.popupClassName,picker:"time",mode:void 0,ref:U,onChange:R,onOpenChange:b,onFocus:S,onBlur:A,onPanelChange:N,onOk:r,onCalendarChange:d}),L)}}});return{TimePicker:v,TimeRangePicker:J}}const{TimePicker:ve,TimeRangePicker:$e}=jo(Oo),ft=Z(ve,{TimePicker:ve,TimeRangePicker:$e,install:C=>(C.component(ve.name,ve),C.component($e.name,$e),C)});var Bo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};function lt(C){for(var h=1;h<arguments.length;h++){var w=arguments[h]!=null?Object(arguments[h]):{},q=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(q=q.concat(Object.getOwnPropertySymbols(w).filter(function(v){return Object.getOwnPropertyDescriptor(w,v).enumerable}))),q.forEach(function(v){Vo(C,v,w[v])})}return C}function Vo(C,h,w){return h in C?Object.defineProperty(C,h,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[h]=w,C}var Me=function(h,w){var q=lt({},h,w.attrs);return t(ut,lt({},q,{icon:Bo}),null)};Me.displayName="CopyOutlined";Me.inheritAttrs=!1;var Go={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};function it(C){for(var h=1;h<arguments.length;h++){var w=arguments[h]!=null?Object(arguments[h]):{},q=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(q=q.concat(Object.getOwnPropertySymbols(w).filter(function(v){return Object.getOwnPropertyDescriptor(w,v).enumerable}))),q.forEach(function(v){Ao(C,v,w[v])})}return C}function Ao(C,h,w){return h in C?Object.defineProperty(C,h,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[h]=w,C}var De=function(h,w){var q=it({},h,w.attrs);return t(ut,it({},q,{icon:Go}),null)};De.displayName="HourglassFilled";De.inheritAttrs=!1;const Yo={class:"form-box"},Qo={class:"upload-document-type-box"},Jo=["onClick"],Wo={class:"right-block"},Xo={class:"title-block"},Zo={class:"title-text"},Ko={class:"desc"},en={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(C,{expose:h,emit:w}){const q=Pe(),v=Le(),J=ke.useForm,P=k(!1),z=k("添加自定义文档"),L=C,y=ee({library_id:v.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),m=k([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),$=N=>{y.qa_index_type=N},u=ee({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:U,validate:T,validateInfos:R}=J(y,u),b=()=>{P.value=!0,U(),y.file_name="",y.is_qa_doc=0,y.qa_index_type=1,L.libraryInfo.type==2&&(y.is_qa_doc=1)},S=k(!1),A=()=>{T().then(()=>{let N={...Fe(y)};S.value=!0,ge(N).then(r=>{G.success(`${z.value}成功`),P.value=!1,q.push("/library/preview?id="+r.data.file_ids[0])}).finally(()=>{S.value=!1})})};return h({add:b}),(N,r)=>{const d=be,p=Ue,j=mo,te=po,W=rt,K=ke,c=oe;return n(),i("div",null,[t(c,{open:P.value,"onUpdate:open":r[2]||(r[2]=E=>P.value=E),title:z.value,onOk:A,width:"472px",confirmLoading:S.value},{default:a(()=>[o("div",Yo,[t(K,{layout:"vertical"},{default:a(()=>[t(p,uo({label:"文档名称"},I(R).file_name),{default:a(()=>[t(d,{type:"text",placeholder:"请输入文档名称",value:y.file_name,"onUpdate:value":r[0]||(r[0]=E=>y.file_name=E)},null,8,["value"])]),_:1},16),_("",!0),y.is_qa_doc==1?(n(),M(p,{key:1,label:"索引方式",required:""},{default:a(()=>[o("div",Qo,[(n(!0),i(H,null,re(m.value,E=>(n(),i("div",{class:pt(["type-item",{active:y.qa_index_type==E.value}]),key:E.value,onClick:me=>$(E.value)},[o("div",Wo,[o("div",Xo,[t(W,{name:y.qa_index_type==E.value?E.iconNameActive:E.iconName},null,8,["name"]),o("div",Zo,O(E.title),1)]),o("div",Ko,O(E.desc),1)]),y.qa_index_type==E.value?(n(),M(W,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):_("",!0)],10,Jo))),128))])]),_:1})):_("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},tn=he(en,[["__scopeId","data-v-80f3643f"]]),on={class:"alert-box"},nn={class:"upload-file-box"},an={key:0,class:"hight-set"},sn={key:0,class:"set-box"},ln={class:"form-item"},un={class:"form-item-body"},rn={class:"form-item"},dn={class:"form-item-body"},_n={class:"form-item"},cn={class:"form-item-body"},pn={key:1,class:"set-box"},mn={class:"form-item"},fn={class:"form-item-body"},vn={class:"form-item"},gn={class:"form-item-body"},yn={class:"form-item"},kn={class:"form-item-body"},hn={__name:"qa-upload-modal",emits:["ok"],setup(C,{expose:h,emit:w}){const q=dt(),{qa_index_type:v}=q;Pe();const P=Le().query,z=k(!1),L=k(!1),y=k([]),m=w,$=k([]),u=ee({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),U=k(!0),T=()=>{z.value=!0},R=()=>{let r=new FormData;y.value.forEach(d=>{r.append("library_files",d)}),Jt(r).then(d=>{let p=[];for(let j in d.data)p.push({lable:d.data[j],value:j});$.value=p})},b=()=>{if(y.value.length==0){G.error("请选择文件");return}L.value=!0;let r=new FormData;r.append("library_id",P.id);let d=!1;if(y.value.forEach(p=>{(p.name.includes(".xlsx")||p.name.includes(".csv"))&&(d=!0),r.append("library_files",p)}),d){if(!u.question_column)return L.value=!1,G.error("请选择问题所在列");if(!u.answer_column)return L.value=!1,G.error("请选择答案所在列");r.append("question_column",u.question_column),r.append("answer_column",u.answer_column),u.similar_column&&r.append("similar_column",u.similar_column)}else r.append("question_lable",u.question_lable),r.append("answer_lable",u.answer_lable),r.append("similar_label",u.similar_label);r.append("is_qa_doc",1),r.append("qa_index_type",v),ge(r).then(p=>{m("ok"),z.value=!1,y.value=[],L.value=!1}).catch(()=>{L.value=!1})},S=()=>{y.value=[]},A=k(1),N=r=>{u.question_column=void 0,u.answer_column=void 0,u.similar_column=void 0,u.question_lable="问题：",u.answer_lable="答案：",u.similar_label="相似问题：",y.value=r,r&&r.length>0&&(r[0].type.includes(".document")?A.value=2:(A.value=1,R()))};return h({show:T}),(r,d)=>{const p=yo,j=Ie,te=Te,W=be,K=oe;return n(),i("div",null,[t(K,{width:680,open:z.value,"onUpdate:open":d[8]||(d[8]=c=>z.value=c),"confirm-loading":L.value,maskClosable:!1,title:"上传文档",onOk:b,onCancel:S},{default:a(()=>[o("div",on,[t(p,{"show-icon":""},{message:a(()=>d[9]||(d[9]=[o("div",null,[f(" 通过word或者EXce形式导入问答对，建议您参考"),o("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),f("  "),o("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),f("创建导入文档 ")],-1),o("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)])),_:1})]),o("div",nn,[t(mt,{type:2,value:y.value,"onUpdate:value":d[0]||(d[0]=c=>y.value=c),onChange:N},null,8,["value"])]),y.value.length>0?(n(),i("div",an,[o("a",{onClick:d[1]||(d[1]=c=>U.value=!U.value)},[d[10]||(d[10]=f("高级设置： ")),U.value?(n(),M(I(go),{key:1})):(n(),M(I(vo),{key:0}))]),U.value?(n(),i(H,{key:0},[A.value==1?(n(),i("div",sn,[o("div",ln,[d[11]||(d[11]=o("div",{class:"form-item-label required"},"问题所在列：",-1)),o("div",un,[t(te,{value:u.question_column,"onUpdate:value":d[2]||(d[2]=c=>u.question_column=c),placeholder:"请选择列名",style:{width:"100%"}},{default:a(()=>[(n(!0),i(H,null,re($.value,c=>(n(),M(j,{value:c.value,key:c.value},{default:a(()=>[f(O(c.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),o("div",rn,[d[12]||(d[12]=o("div",{class:"form-item-label"},"相似问法所在列：",-1)),o("div",dn,[t(te,{value:u.similar_column,"onUpdate:value":d[3]||(d[3]=c=>u.similar_column=c),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:a(()=>[(n(!0),i(H,null,re($.value,c=>(n(),M(j,{value:c.value,key:c.value},{default:a(()=>[f(O(c.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),o("div",_n,[d[13]||(d[13]=o("div",{class:"form-item-label required"},"答案所在列：",-1)),o("div",cn,[t(te,{value:u.answer_column,"onUpdate:value":d[4]||(d[4]=c=>u.answer_column=c),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:a(()=>[(n(!0),i(H,null,re($.value,c=>(n(),M(j,{value:c.value,key:c.value},{default:a(()=>[f(O(c.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):_("",!0),A.value==2?(n(),i("div",pn,[o("div",mn,[d[14]||(d[14]=o("div",{class:"form-item-label"},"问题开始标识符：",-1)),o("div",fn,[t(W,{placeholder:"请输入标识符",value:u.question_lable,"onUpdate:value":d[5]||(d[5]=c=>u.question_lable=c)},null,8,["value"])])]),o("div",vn,[d[15]||(d[15]=o("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),o("div",gn,[t(W,{placeholder:"请输入标识符",value:u.similar_label,"onUpdate:value":d[6]||(d[6]=c=>u.similar_label=c)},null,8,["value"])])]),o("div",yn,[d[16]||(d[16]=o("div",{class:"form-item-label"},"答案开始标识符：",-1)),o("div",kn,[t(W,{placeholder:"请输入标识符",value:u.answer_lable,"onUpdate:value":d[7]||(d[7]=c=>u.answer_lable=c)},null,8,["value"])])])])):_("",!0)],64)):_("",!0)])):_("",!0)]),_:1},8,["open","confirm-loading"])])}}},bn=he(hn,[["__scopeId","data-v-ecac2491"]]),wn="/assets/img/guide-image-DSu20zRj.png",Cn={class:"container"},xn={class:"guide-content"},On={class:"content-box"},qn={__name:"guide-learning-tips",setup(C,{expose:h}){const w=_t(),q=k(!1),v=k(!1),J=k(""),P=()=>{setTimeout(()=>{q.value=!0},500)},z=()=>{w.setGuideLearningTips(v.value),q.value=!1},L=()=>{w.setGuideLearningTips(v.value),q.value=!1};return h({show:P}),(y,m)=>{const $=bo,u=ct,U=oe;return n(),i("div",Cn,[t(U,{open:q.value,"onUpdate:open":m[1]||(m[1]=T=>q.value=T),title:J.value,onOk:z,onCancel:L,width:"472px"},{footer:a(()=>[t(u,{type:"primary",onClick:z},{default:a(()=>m[5]||(m[5]=[f("我知道了")])),_:1,__:[5]})]),default:a(()=>[o("div",xn,[m[4]||(m[4]=o("img",{src:wn,alt:"操作引导",class:"guide-image"},null,-1)),o("div",On,[m[3]||(m[3]=o("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),t($,{checked:v.value,"onUpdate:checked":m[0]||(m[0]=T=>v.value=T)},{default:a(()=>m[2]||(m[2]=[o("div",{class:"content-check"},"不再显示此提示",-1)])),_:1,__:[2]},8,["checked"])])])]),_:1},8,["open","title"])])}}},Sn=he(qn,[["__scopeId","data-v-33a87814"]]),$n={__name:"edit-online-doc",emits:["ok"],setup(C,{expose:h,emit:w}){const q=w,v=ee({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),J=k({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),P=k(!1),z=$=>{$=JSON.parse(JSON.stringify($)),v.id=$.id||"",v.file_name=$.file_name||"",v.doc_auto_renew_frequency=+$.doc_auto_renew_frequency||1,$.doc_auto_renew_minute>0&&(v.doc_auto_renew_minute=ye($.doc_auto_renew_minute)),P.value=!0},L=k(!1),y=k(null),m=()=>{y.value.validate().then(()=>{L.value=!0,Wt({...v,doc_auto_renew_minute:v.doc_auto_renew_minute?ye(v.doc_auto_renew_minute):0}).then(()=>{P.value=!1,L.value=!1,q("ok")})}).catch(()=>{L.value=!1})};return h({show:z}),($,u)=>{const U=be,T=Ue,R=Ie,b=Te,S=ft,A=ke,N=oe;return n(),i("div",null,[t(N,{open:P.value,"onUpdate:open":u[3]||(u[3]=r=>P.value=r),"confirm-loading":L.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:m},{default:a(()=>[t(A,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:y,model:v,rules:J.value},{default:a(()=>[t(T,{name:"file_name",label:"文件名称"},{default:a(()=>[t(U,{value:v.file_name,"onUpdate:value":u[0]||(u[0]=r=>v.file_name=r),placeholder:"请输入"},null,8,["value"])]),_:1}),t(T,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:a(()=>[t(b,{value:v.doc_auto_renew_frequency,"onUpdate:value":u[1]||(u[1]=r=>v.doc_auto_renew_frequency=r),style:{width:"100%"}},{default:a(()=>[t(R,{value:1},{default:a(()=>u[4]||(u[4]=[f("不自动更新")])),_:1,__:[4]}),t(R,{value:2},{default:a(()=>u[5]||(u[5]=[f("每天")])),_:1,__:[5]}),t(R,{value:3},{default:a(()=>u[6]||(u[6]=[f("每3天")])),_:1,__:[6]}),t(R,{value:4},{default:a(()=>u[7]||(u[7]=[f("每7天")])),_:1,__:[7]}),t(R,{value:5},{default:a(()=>u[8]||(u[8]=[f("每30天")])),_:1,__:[8]})]),_:1},8,["value"])]),_:1}),v.doc_auto_renew_frequency>1?(n(),M(T,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[t(S,{valueFormat:"HH:mm",value:v.doc_auto_renew_minute,"onUpdate:value":u[2]||(u[2]=r=>v.doc_auto_renew_minute=r),format:"HH:mm"},null,8,["value"])]),_:1})):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},Fn={class:"details-library-page"},Ln={class:"list-tools"},Pn={class:"tools-items"},Un={class:"tool-item"},Tn={class:"dropdown-btn-menu"},In={key:0,class:"desc"},Mn={key:1,class:"desc"},Dn={class:"dropdown-btn-menu"},Rn={class:"dropdown-btn-menu"},Nn={class:"right-box"},zn={key:0,class:"status-box"},Hn={class:"status-item"},En={class:"status-content"},jn={class:"status-item"},Bn={class:"status-content content-tip"},Vn={class:"status-item"},Gn={class:"status-content content-tip"},An={key:1,class:"status-select-box"},Yn={class:"tool-item"},Qn={class:"list-content"},Jn={key:0,class:"doc-name-td"},Wn=["href"],Xn=["onClick"],Zn={key:0},Kn={key:1},ea=["onClick"],ta={key:0},oa={key:1},na={key:2,class:"url-remark"},aa=["onClick"],sa={key:0,class:"pdf-progress-box"},la={class:"progress-title"},ia={class:"status-box"},ua=["onClick"],ra={class:"progress-bar"},da={class:"num-box"},_a={key:0,class:"status-tag running"},ca={key:2,class:"status-tag running"},pa={key:3,class:"status-tag complete"},ma={class:"status-tag status-error"},fa=["onClick"],va={class:"status-tag status-error"},ga={class:"status-tag"},ya=["onClick"],ka={key:7,class:"status-tag"},ha={key:8,class:"status-tag running"},ba={class:"status-tag error"},wa={key:10,class:"status-tag cancel"},Ca={key:11,class:"status-tag subning"},xa={class:"status-tag"},Oa=["onClick"],qa={key:1,class:"status-tag running"},Sa={key:2,class:"status-tag complete"},$a={class:"status-tag error"},Fa=["onClick"],La={class:"zm-line1 reason-text"},Pa={key:4,class:"status-tag running"},Ua={class:"status-tag warning"},Ta={class:"reason-text"},Ia=["onClick"],Ma={key:0},Da={key:1},Ra={key:0,class:"text-block"},Na={class:"time-content-box"},za={key:0},Ha={key:1},Ea={key:2},ja={key:3},Ba={key:4},Va={key:5,class:"ml4"},Ga={key:6},Aa=["onClick"],Ya={key:1},Qa={key:0},Ja={key:1},Wa=["onClick"],Xa=["onClick"],Za=["onClick"],Ka={class:"upload-file-box"},es={class:"select-card-box"},ts=["onClick"],os={class:"card-title"},ns={key:0,class:"card-switch-box"},as={class:"card-desc"},ss={key:0,class:"card-switch"},ls={__name:"knowledge-document",setup(C){const{setStorage:h}=oo("localStorage"),w=dt(),{changeGraphSwitch:q}=w,v=Xt(),J=Ce(()=>{var l;return((l=v.companyInfo)==null?void 0:l.neo4j_status)=="true"}),P=Ce(()=>{var l;return((l=v.companyInfo)==null?void 0:l.ali_ocr_switch)=="1"}),z=_t(),L=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"},{key:4,title:"阿里云OCR解析",icon:"ali-ocr",desc:"通过阿里云文档智能接口解析提取图片和文字"}],y=Le(),m=Pe(),$=y.query,u=k(!1),U=k(null),T=k(null),R=k(!1),b=k({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});ee({selectedRowKeys:[]});const S=ee({use_model:"",model_config_id:""}),A=(l,e)=>{let x=e.modelName,B=e.modelId;W.value.length>0?oe.confirm({title:`确定切换模型为${x}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){S.use_model=x,S.model_config_id=B,N()},onCancel(){}}):(S.use_model=x,S.model_config_id=B,N())},N=(l=!0,e=null)=>{io({...Fe(b.value),use_model:S.use_model,model_config_id:S.model_config_id}).then(()=>{b.value.use_model=S.use_model,b.value.model_config_id=S.model_config_id,typeof e=="function"&&e(),l&&G.success("保存成功")})},r=k([]),d=l=>{r.value=l},p=k([]),j=l=>{p.value=l,te()},te=()=>{if(!b.value.id){setTimeout(()=>{te()},100);return}if(p.value.length>0&&!b.value.use_model){let l=null,e=null;for(let x of p.value)if(x.model_define==="chatwiki"){l=x;for(let B of l.children)if(B.name==="text-embedding-v2"){e=B;break}break}l||(l=p.value[0],e=l.children[0]),l&&(S.use_model=e.name,S.model_config_id=e.model_config_id,N(!1))}},W=k([]),K=ee({learned_err_count:0,learned_count:0,learned_wait_count:0}),c=ee({library_id:$.id,file_name:void 0,status:"",page:1,size:10,total:0}),E=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],me=k([]),Re=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],vt=l=>{ne()},gt=l=>{c.page=l.current,c.size=l.pageSize,Y()},ne=()=>{c.page=1,Y()};let Ne=!1;const yt=({id:l})=>{W.value.length==1&&(Ne=!0),lo({id:l}).then(()=>{Ne&&c.page>1&&c.page--,Y(),G.success("删除成功")})},ae=(l,e={})=>{if(l.status=="4")return m.push({path:"/library/document-segmentation",query:{document_id:l.id,page:c.page}});if(l.status=="3"&&b.value.type!=2)return G.error("学习失败,不可预览");if(l.status=="0")return G.error("转换中,稍候可预览");if(l.status=="1")return G.error("学习中,不可预览");if(l.status=="6")return G.error("获取中,不可预览");if(l.status=="7")return G.error("获取失败,不可预览");if(l.status=="10")return G.error("正在分段,不可预览");m.push({name:"libraryPreview",query:{id:l.id,...e}})},Y=()=>{let l=Fe(c);l.status==0&&(l.status=""),u.value=!0,Zt(l).then(e=>{let x=e.data.info;!S.use_model&&S.use_model!=x.use_model&&(S.use_model=x.use_model,S.model_config_id=x.model_config_id),b.value={...x},R.value=x.graph_switch==1,x.graph_switch=="0"||!J.value?me.value=Re.filter(Q=>!["graph_status","graph_entity_count"].includes(Q.key)):me.value=Re;let B=e.data.list||[],X=e.data.count_data||{};c.total=e.data.total,K.learned_count=X.learned_count,K.learned_err_count=X.learned_err_count,K.learned_wait_count=X.learned_wait_count;let se=!1;W.value=B.map(Q=>(["1","6","0","5"].includes(Q.status)&&(se=!0),Q.file_size_str=Kt(Q.file_size),Q.update_time=Ke(Q.update_time*1e3).format("YYYY-MM-DD HH:mm"),Q.doc_last_renew_time_desc=Q.doc_last_renew_time>0?Ke(Q.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",Q)),se&&kt(),!se&&clearInterval(de.value)}).finally(()=>{u.value=!1})},de=k(null),kt=()=>{clearInterval(de.value),de.value=setInterval(()=>{Y()},1e3*5)},ze=k(null),ht=l=>{if(p.value.length==0){oe.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){m.push({path:"/user/model"})}});return}let{key:e}=l;e==1&&xt(),e==2&&bt(),e==3&&ze.value.add()},F=ee({open:!1,urls:"",library_id:$.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(l,e)=>ot(e)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),bt=()=>{F.open=!0,F.confirmLoading=!1,F.urls="",F.doc_auto_renew_minute="02:00",F.doc_auto_renew_frequency=1},He=k(null),wt=()=>{He.value.validate().then(()=>{F.confirmLoading=!0,ge({library_id:F.library_id,urls:JSON.stringify(ot(F.urls)),doc_auto_renew_frequency:F.doc_auto_renew_frequency,doc_auto_renew_minute:ye(F.doc_auto_renew_minute),doc_type:2}).then(()=>{F.open=!1,F.confirmLoading=!1,ne()})}).catch(()=>{F.confirmLoading=!1})},Ct=()=>{F.open=!1},D=ee({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),Ee=Ce(()=>D.fileList.filter(l=>l.type==="application/pdf").length>0),je=k(null),xt=()=>{if(b.value.type==2){je.value.show();return}D.fileList=[],D.open=!0},Ot=()=>{D.fileList=[]},qt=l=>{D.fileList=l},St=()=>{if(U.value&&!z.getGuideLearningTips&&D.fileList.length>1&&U.value.show(),D.fileList.length==0){G.error("请选择文件");return}D.confirmLoading=!0;let l=new FormData;l.append("library_id",c.library_id);let e=!1;D.fileList.forEach(x=>{(x.name.includes(".xlsx")||x.name.includes(".csv"))&&(e=!0),l.append("library_files",x)}),Ee.value&&l.append("pdf_parse_type",D.pdf_parse_type),ge(l).then(x=>{Y(),D.open=!1,D.fileList=[],D.confirmLoading=!1,e&&x.data.file_ids.length==1&&m.push("/library/document-segmentation?document_id="+x.data.file_ids[0])}).catch(()=>{D.confirmLoading=!1})},Be=k(null),$t=l=>{Be.value.show(l)},Ft=l=>{m.push({path:"/library/document-segmentation",query:{document_id:l.id}})},Ve=l=>{ao({id:l.id}).then(()=>{Y()})},Lt=()=>{if(R.value){R.value=!1;let l={graph_model_config_id:b.value.graph_model_config_id,graph_use_model:b.value.graph_use_model};if((!l.graph_model_config_id||!l.graph_use_model)&&r.value.length>0){let x=r.value[0].children[0];l.graph_use_model=x.name,l.graph_model_config_id=x.model_config_id}T.value.show(l)}else b.value.graph_switch=0,N(!1,()=>{Y(),q(0)})},Pt=l=>{R.value=!0,b.value.graph_switch=1,b.value.graph_model_config_id=l.graph_model_config_id,b.value.graph_use_model=l.graph_use_model,N(!1,()=>{Y(),q(1)})},Ut=l=>{if(l.key==4&&!P.value)return!1;D.pdf_parse_type=l.key},Tt=()=>{window.open("#/user/aliocr")},Ge=k(null),Ae=l=>{Ge.value.show({...l})},It=l=>{so({id:l.id}).then(e=>{G.success("更新成功"),Y()})},Mt=l=>{oe.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){no({id:l.id}).then(e=>{G.success("取消成功"),Y()})}})},Dt=l=>{h("graph:autoOpenFileId",l.id),m.push({path:"/library/details/knowledge-graph",query:{id:$.id}})};return ro(()=>{$.page&&(c.page=+$.page),Y()}),_o(()=>{de.value&&clearInterval(de.value)}),(l,e)=>{const x=rt,B=Do,X=Fo,se=$o,Q=ct,Ye=qo,Rt=Ro,le=Ie,Qe=Te,Nt=be,zt=zo,Ht=Po,_e=Uo,ce=Ho,Je=To,Et=No,jt=At,pe=Ue,We=ke,Xe=oe,Bt=Eo,Vt=ft,Gt=co("copy");return n(),i("div",Fn,[t(jt,{scrollbar:!1},{default:a(()=>[o("div",Ln,[o("div",Pn,[o("div",Un,[t(Ye,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:a(()=>[t(se,{onClick:ht},{default:a(()=>[(n(),M(X,{key:1},{default:a(()=>[o("div",Tn,[t(B,{class:"title-block",gap:4},{default:a(()=>[t(x,{name:"doc-icon"}),e[10]||(e[10]=o("div",{class:"title"},"本地文档",-1))]),_:1,__:[10]}),b.value.type==2?(n(),i("div",In," 上传本地 docx/csv/xlsx 等格式文件 ")):(n(),i("div",Mn," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),b.value.type!=2?(n(),M(X,{key:2},{default:a(()=>[o("div",Dn,[t(B,{class:"title-block",gap:4},{default:a(()=>[t(x,{name:"link-icon"}),e[11]||(e[11]=o("div",{class:"title"},"在线数据",-1))]),_:1,__:[11]}),e[12]||(e[12]=o("div",{class:"desc"},"获取在线网页内容",-1))])]),_:1})):_("",!0),(n(),M(X,{key:3},{default:a(()=>[o("div",Rn,[t(B,{class:"title-block",gap:4},{default:a(()=>[t(x,{name:"cu-doc-icon"}),e[13]||(e[13]=o("div",{class:"title"},"自定义文档",-1))]),_:1,__:[13]}),e[14]||(e[14]=o("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1))])]),_:1}))]),_:1})]),default:a(()=>[t(Q,{type:"primary"},{icon:a(()=>[t(I(So))]),default:a(()=>[e[15]||(e[15]=o("span",null,"添加内容",-1))]),_:1,__:[15]})]),_:1})]),xe(t(B,{align:"center",class:"tool-item custom-select-box"},{default:a(()=>[e[16]||(e[16]=o("span",null,"嵌入模型：",-1)),t(nt,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:S.use_model,modeId:S.model_config_id,style:{width:"240px"},onChange:A,onLoaded:j},null,8,["modeName","modeId"])]),_:1,__:[16]},512),[[tt,!1]]),J.value?(n(),M(B,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:a(()=>[xe(t(nt,{modelType:"LLM",onLoaded:d},null,512),[[tt,!1]]),e[17]||(e[17]=o("span",null,"生成知识图谱：",-1)),t(Rt,{checked:R.value,"onUpdate:checked":e[0]||(e[0]=g=>R.value=g),onChange:Lt,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1,__:[17]})):_("",!0)]),o("div",Nn,[b.value.type==0?(n(),i("div",zn,[o("div",Hn,[e[18]||(e[18]=o("div",{class:"status-label"},"已学习：",-1)),o("div",En,O(K.learned_count),1)]),o("div",jn,[e[19]||(e[19]=o("div",{class:"status-label"},"，未学习：",-1)),o("div",Bn,O(K.learned_wait_count),1)]),o("div",Vn,[e[20]||(e[20]=o("div",{class:"status-label"},"，学习失败：",-1)),o("div",Gn,O(K.learned_err_count),1)])])):_("",!0),b.value.type==0?(n(),i("div",An,[t(Qe,{value:c.status,"onUpdate:value":e[1]||(e[1]=g=>c.status=g),style:{width:"150px"},placeholder:"请选择",onChange:vt},{default:a(()=>[(n(),i(H,null,re(E,g=>t(le,{key:g.id,value:g.id},{default:a(()=>[f(O(g.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):_("",!0),o("div",Yn,[t(Nt,{style:{width:"282px"},value:c.file_name,"onUpdate:value":e[2]||(e[2]=g=>c.file_name=g),placeholder:"请输入文档名称搜索",onChange:ne},{suffix:a(()=>[t(I(Lo),{onClick:ne,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),b.value.type==0?(n(),M(ho,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:a(()=>e[21]||(e[21]=[o("div",null,[o("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),o("p",null,"2、未学习的文档数据不会被检索到。")],-1)])),_:1,__:[21]})):_("",!0),o("div",Qn,[t(Et,{columns:me.value,"data-source":W.value,scroll:{x:1e3},"row-key":"id",pagination:{current:c.page,total:c.total,pageSize:c.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:gt},{bodyCell:a(({column:g,record:s})=>[g.key==="file_name"?(n(),i("div",Jn,[s.doc_type==2?(n(),M(zt,{key:0,title:null},{content:a(()=>[e[22]||(e[22]=f(" 原链接：")),o("a",{href:s.doc_url,target:"_blank"},O(s.doc_url),9,Wn),xe(t(I(Me),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[Gt,`${s.doc_url}`]])]),default:a(()=>[o("a",{onClick:V=>ae(s)},[["5","6","7"].includes(s.status)?(n(),i("span",Zn,O(s.doc_url),1)):(n(),i("span",Kn,O(s.file_name),1))],8,Xn)]),_:2},1024)):(n(),i("a",{key:1,onClick:V=>ae(s)},[["5","6","7"].includes(s.status)?(n(),i("span",ta,O(s.doc_url),1)):(n(),i("span",oa,O(s.file_name),1))],8,ea)),s.doc_type==2&&s.remark?(n(),i("div",na," 备注："+O(s.remark),1)):_("",!0)])):_("",!0),g.key==="graph_entity_count"?(n(),i("a",{key:1,onClick:V=>Dt(s)},O(s.graph_entity_count),9,aa)):_("",!0),g.key==="status"?(n(),i(H,{key:2},[s.file_ext=="pdf"&&s.pdf_parse_type>=2?(n(),i(H,{key:0},[s.status==0?(n(),i("div",sa,[o("div",la,[o("span",ia,[t(I(eo)),e[23]||(e[23]=f("文档解析中"))]),o("a",{onClick:V=>Mt(s)},"取消",8,ua)]),o("div",ra,[t(Ht,{size:"small",class:"progress-bar-box",percent:parseInt(s.ocr_pdf_index/s.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),o("div",da,O(s.ocr_pdf_index)+" / "+O(s.ocr_pdf_total),1)])])):_("",!0)],64)):(n(),i(H,{key:1},[s.status==0?(n(),i("span",_a,[t(_e,{size:"small"}),e[24]||(e[24]=f(" 转换中"))])):_("",!0)],64)),s.status==1?(n(),i("span",ca,[t(_e,{size:"small"}),e[25]||(e[25]=f(" 学习中"))])):_("",!0),s.status==2?(n(),i("span",pa,[t(I(we)),e[26]||(e[26]=f(" 学习完成"))])):_("",!0),s.status==3?(n(),M(ce,{key:4,placement:"top"},{title:a(()=>[o("span",null,O(s.errmsg),1)]),default:a(()=>[o("span",null,[o("span",ma,[t(I(fe)),e[27]||(e[27]=f(" 转换失败"))]),b.value.type==2?(n(),i("a",{key:0,class:"ml8",onClick:V=>ae(s)},"学习",8,fa)):_("",!0)])]),_:2},1024)):_("",!0),s.status==8?(n(),M(ce,{key:5,placement:"top"},{title:a(()=>[o("span",null,O(s.errmsg),1)]),default:a(()=>[o("span",null,[o("span",va,[t(I(fe)),e[28]||(e[28]=f(" 转化异常"))])])]),_:2},1024)):_("",!0),s.status==4?(n(),i(H,{key:6},[o("span",ga,[t(I(qe)),e[29]||(e[29]=f(" 待学习"))]),o("a",{class:"ml8",onClick:V=>ae(s)},"学习",8,ya)],64)):_("",!0),s.status==5?(n(),i("span",ka,[t(I(qe)),e[30]||(e[30]=f(" 待获取"))])):_("",!0),s.status==6?(n(),i("span",ha,[t(_e,{size:"small"}),e[31]||(e[31]=f(" 获取中"))])):_("",!0),s.status==7?(n(),M(ce,{key:9,placement:"top"},{title:a(()=>[o("span",null,O(s.errmsg),1)]),default:a(()=>[o("span",ba,[t(I(fe)),e[32]||(e[32]=f(" 获取失败"))])]),_:2},1024)):_("",!0),s.status==9?(n(),i("span",wa,[t(I(to)),e[33]||(e[33]=f(" 取消解析"))])):_("",!0),s.status==10?(n(),i("span",Ca,[t(_e,{size:"small"}),e[34]||(e[34]=f(" 正在分段 "))])):_("",!0)],64)):_("",!0),g.key==="graph_status"?(n(),i(H,{key:3},[s.graph_status==0?(n(),i(H,{key:0},[o("span",xa,[t(I(qe)),e[35]||(e[35]=f(" 待生成"))]),o("a",{class:"ml8",onClick:V=>Ve(s)},"生成",8,Oa)],64)):s.graph_status==1?(n(),i("span",qa,[t(I(De)),e[36]||(e[36]=f(" 排队中"))])):s.graph_status==2?(n(),i("span",Sa,[t(I(we)),e[37]||(e[37]=f(" 生成完成"))])):s.graph_status==3?(n(),i(H,{key:3},[o("span",$a,[t(I(fe)),e[38]||(e[38]=f(" 生成失败"))]),o("a",{class:"ml8",onClick:V=>Ve(s)},"生成",8,Fa),s.graph_err_msg?(n(),M(ce,{key:0,title:s.graph_err_msg},{default:a(()=>[o("div",La,"原因："+O(s.graph_err_msg),1)]),_:2},1032,["title"])):_("",!0)],64)):s.graph_status==4?(n(),i("span",Pa,[t(_e,{size:"small"}),e[39]||(e[39]=f(" 生成中"))])):s.graph_status==5?(n(),i(H,{key:5},[o("span",Ua,[t(I(we)),e[40]||(e[40]=f(" 部分成功"))]),o("div",Ta,[f(" 失败数："+O(s.graph_err_count||0)+" ",1),o("a",{class:"ml8",onClick:V=>ae(s,{graph_status:3})},"详情",8,Ia)])],64)):_("",!0)],64)):_("",!0),g.key==="file_size"?(n(),i(H,{key:4},[s.doc_type==3?(n(),i("span",Ma,"-")):(n(),i("span",Da,O(s.file_size_str),1))],64)):_("",!0),g.key==="doc_auto_renew_frequency"?(n(),i(H,{key:5},[s.doc_type==2?(n(),i("div",Ra,[o("div",Na,[s.doc_auto_renew_frequency==1?(n(),i("span",za,"不自动更新")):_("",!0),s.doc_auto_renew_frequency==2?(n(),i("span",Ha,"每天")):_("",!0),s.doc_auto_renew_frequency==3?(n(),i("span",Ea,"每3天")):_("",!0),s.doc_auto_renew_frequency==4?(n(),i("span",ja,"每7天")):_("",!0),s.doc_auto_renew_frequency==5?(n(),i("span",Ba,"每30天")):_("",!0),s.doc_auto_renew_frequency>1&&s.doc_auto_renew_minute>0?(n(),i("span",Va,O(I(ye)(s.doc_auto_renew_minute)),1)):_("",!0),s.doc_auto_renew_frequency>1?(n(),i("span",Ga,"更新")):_("",!0),o("a",{class:"ml4 btn-hover-block",onClick:V=>Ae(s)},"修改",8,Aa)]),t(B,{align:"center"},{default:a(()=>[f(" 最近更新: "+O(s.doc_last_renew_time_desc)+" ",1),t(Je,{title:"确认更新?",onConfirm:V=>It(s)},{default:a(()=>e[41]||(e[41]=[o("a",{class:"ml4 btn-hover-block"},"更新",-1)])),_:2,__:[41]},1032,["onConfirm"])]),_:2},1024)])):(n(),i("div",Ya,"--"))],64)):_("",!0),g.key==="paragraph_count"?(n(),i(H,{key:6},[s.status==0||s.status==1?(n(),i("span",Qa,"-")):(n(),i("span",Ja,O(s.paragraph_count),1))],64)):_("",!0),g.key==="action"?(n(),M(B,{key:7,gap:8},{default:a(()=>[t(ce,null,{title:a(()=>e[42]||(e[42]=[f("重新分段")])),default:a(()=>[t(I(Io),{class:"btn-hover-block",onClick:V=>Ft(s)},null,8,["onClick"])]),_:2},1024),t(Ye,null,{overlay:a(()=>[t(se,null,{default:a(()=>[s.doc_type==2?(n(),M(X,{key:0},{default:a(()=>[o("div",{onClick:V=>Ae(s)},"编辑",8,Wa)]),_:2},1024)):_("",!0),t(X,{disabled:s.status==6||s.status==7||s.status==0},{default:a(()=>[o("div",{onClick:V=>ae(s)},"预览",8,Xa)]),_:2},1032,["disabled"]),t(X,null,{default:a(()=>[o("div",{onClick:V=>$t(s)},"重命名",8,Za)]),_:2},1024),t(X,null,{default:a(()=>[t(Je,{title:"确定要删除吗?",onConfirm:V=>yt(s)},{default:a(()=>e[43]||(e[43]=[o("span",null,"删除",-1)])),_:2,__:[43]},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:a(()=>[o("div",{class:"table-btn",onClick:e[3]||(e[3]=Oe(()=>{},["prevent"]))},[t(I(Mo),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):_("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),t(Xe,{open:D.open,"onUpdate:open":e[5]||(e[5]=g=>D.open=g),"confirm-loading":D.confirmLoading,maskClosable:!1,title:"上传文档",onOk:St,onCancel:Ot,width:"740px"},{default:a(()=>[t(We,{class:"mt24"},{default:a(()=>[t(pe,{required:"",label:""},{default:a(()=>[o("div",Ka,[t(mt,{type:b.value.type,maxCount:20,value:D.fileList,"onUpdate:value":e[4]||(e[4]=g=>D.fileList=g),onChange:qt},null,8,["type","value"])])]),_:1}),Ee.value?(n(),M(pe,{key:0,required:"",label:"PDF解析模式",class:"select-card-main"},{default:a(()=>[o("div",es,[(n(),i(H,null,re(L,g=>o("div",{key:g.key,class:pt(["select-card-item",{active:D.pdf_parse_type==g.key},{disabled:g.key==4&&!P.value}]),onClick:Oe(s=>Ut(g),["stop"])},[t(x,{class:"check-arrow",name:"check-arrow-filled"}),o("div",os,[t(x,{name:g.icon,style:{"font-size":"16px"}},null,8,["name"]),f(" "+O(g.title)+" ",1),g.key==4&&!P.value?(n(),i("div",ns,"未开启")):_("",!0)]),o("div",as,O(g.desc),1),g.key==4&&!P.value?(n(),i("div",ss,[e[44]||(e[44]=f(" 未开启阿里云OCR ")),o("div",{class:"card-switch-btn",onClick:Oe(Tt,["stop"])},"去开启")])):_("",!0)],10,ts)),64))])]),_:1})):_("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),t(bn,{onOk:Y,ref_key:"qaUploadModalRef",ref:je},null,512),t(Xe,{open:F.open,"onUpdate:open":e[9]||(e[9]=g=>F.open=g),"confirm-loading":F.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:wt,onCancel:Ct},{default:a(()=>[t(We,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:He,model:F,rules:F.rules},{default:a(()=>[t(pe,{name:"urls",label:"网页链接"},{default:a(()=>[t(Bt,{style:{height:"120px"},value:F.urls,"onUpdate:value":e[6]||(e[6]=g=>F.urls=g),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),t(pe,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:a(()=>[t(Qe,{value:F.doc_auto_renew_frequency,"onUpdate:value":e[7]||(e[7]=g=>F.doc_auto_renew_frequency=g),style:{width:"100%"}},{default:a(()=>[t(le,{value:1},{default:a(()=>e[45]||(e[45]=[f("不自动更新")])),_:1,__:[45]}),t(le,{value:2},{default:a(()=>e[46]||(e[46]=[f("每天")])),_:1,__:[46]}),t(le,{value:3},{default:a(()=>e[47]||(e[47]=[f("每3天")])),_:1,__:[47]}),t(le,{value:4},{default:a(()=>e[48]||(e[48]=[f("每7天")])),_:1,__:[48]}),t(le,{value:5},{default:a(()=>e[49]||(e[49]=[f("每30天")])),_:1,__:[49]})]),_:1},8,["value"])]),_:1}),F.doc_auto_renew_frequency>1?(n(),M(pe,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[t(Vt,{valueFormat:"HH:mm",value:F.doc_auto_renew_minute,"onUpdate:value":e[8]||(e[8]=g=>F.doc_auto_renew_minute=g),format:"HH:mm"},null,8,["value"])]),_:1})):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),t(tn,{libraryInfo:b.value,onOk:ne,ref_key:"addCustomDocumentRef",ref:ze},null,8,["libraryInfo"]),t(ko,{onOk:ne,ref_key:"renameModalRef",ref:Be},null,512),t(fo,{onOk:Pt,ref_key:"openGrapgModalRef",ref:T},null,512),t(Sn,{ref_key:"guideLearningTipsRef",ref:U},null,512),t($n,{onOk:Y,ref_key:"editOnlineDocRef",ref:Ge},null,512)])}}},ql=he(ls,[["__scopeId","data-v-f202948c"]]);export{ql as default};
