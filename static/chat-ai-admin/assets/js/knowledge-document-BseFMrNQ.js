import{_ as Gt}from"./cu-scroll-CGL6fhO0.js";import{q as Z,Q as At,U as ie,C as Qt,p as ue,x as Ze,I as ut,b as he,d as rt,M as oe,bR as ge,k as Q,bS as Yt,h as dt,B as _t,bT as ye,bU as Jt,bL as Xt,e as Wt,bV as Zt,bH as Kt,n as Ke,V as eo,a1 as we,bq as fe,E as to,aC as oo,bW as no,bX as ao,bY as so,bZ as lo,b_ as io}from"../../index-DGlN_gTP.js";import{e as et,d as k,j as t,z as K,a3 as Fe,N as u,O as n,U as s,X as o,a6 as r,S as I,W as uo,u as T,F as E,a1 as re,a5 as ct,_ as q,a2 as Pe,Z as c,G as Le,b as Ce,q as ro,D as _o,ag as co,H as xe,I as tt,a0 as Oe}from"./vue-chunks-BRsu9_To.js";import{U as pt}from"./upload-input-DndaNAuR.js";import{t as ot}from"./validate-8MtiUsxW.js";import{F as ke,_ as Ue}from"./index-vDDFetvc.js";import"./index-JAP4Oum8.js";import{I as be}from"./Input-BpI49rDY.js";import"./index-SBg8gFw7.js";import{_ as po,R as mo}from"./RadioButton-Bnx6tN7r.js";import{M as nt}from"./model-select-7nrl0gxH.js";import{O as fo}from"./open-grapg-modal-CxpWe9UJ.js";import{D as vo}from"./DownOutlined-BUKGfKlO.js";import{U as go}from"./UpOutlined-CR2jjLrd.js";import{S as Te,a as Ie}from"./index-BlDgRIYn.js";import{_ as yo}from"./index-CNkxcL4v.js";import{R as ko}from"./rename-modal-B81O1QGz.js";import{_ as ho}from"./page-alert-Bz3nV4Vs.js";import{C as bo}from"./index-CVsoyaFF.js";import{g as wo,c as at,d as Co,r as xo,a as Oo}from"./index-Bm8PAQv0.js";import{u as st}from"./FormItemContext-DAoPsdM7.js";import"./index-Jd-vOpFR.js";import{D as qo}from"./dropdown-0QsfqJqV.js";import{P as So}from"./PlusOutlined-D8SGrPLQ.js";import{M as $o,_ as Lo}from"./index-D35sYO_B.js";import{S as Fo}from"./SearchOutlined-DSY7YbKD.js";import{g as Po}from"./index-3U3efXj8.js";import{S as Uo}from"./index-DBSnNVJY.js";import{C as qe}from"./ClockCircleFilled-BeddiC3T.js";import{_ as To}from"./index-Cv6OeQmI.js";import{S as Io}from"./SyncOutlined-DW7e_W_D.js";import{M as Mo}from"./MoreOutlined-Cb_2geQ0.js";import{_ as Do}from"./index-DasxHN4l.js";import{_ as Ro}from"./index-C1MdRggi.js";import{a as No}from"./index-DIzQ-2kQ.js";import{_ as zo}from"./index-DpIV4w7P.js";import{_ as Ho}from"./index-BQDPftJ3.js";import{_ as Eo}from"./TextArea-BNOG6RQ7.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./InboxOutlined-DHedphF3.js";import"./Trigger-oBKhEx1B.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-51jSOJKV.js";import"./responsiveObserve-BLoLQTqt.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-Bvo9_S3-.js";import"./index-C0cXlrXm.js";import"./Search-CH76L-gx.js";import"./inputProps-Bu_dzA3C.js";import"./Password-B9FCv-aw.js";import"./Checkbox-B8J-JVwM.js";import"./index-D9KRCCIf.js";import"./slide-Ccxw2gRU.js";import"./index-k9nX7Zez.js";import"./CheckOutlined-B_Hs0-OP.js";import"./move-BSoEcIoa.js";import"./index-Cf43OwEB.js";import"./index-BiKG4PZA.js";import"./colors-DKWwHq2l.js";import"./shallowequal-C0xnIuy8.js";import"./RightOutlined-TchQhXHc.js";import"./DownloadOutlined-3aTO680L.js";import"./index-Bar3uf0o.js";import"./useMaxLevel-CkEcKQq6.js";import"./CaretDownFilled-7wQJySwA.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-D6kSS-Pc.js";import"./CaretDownOutlined-Cx15LuFR.js";const Se=()=>({format:String,showNow:ie(),showHour:ie(),showMinute:ie(),showSecond:ie(),use12Hours:ie(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:ie(),popupClassName:String,status:At()});function jo(x){const h=wo(x,Z(Z({},Se()),{order:{type:Boolean,default:!0}})),{TimePicker:w,RangePicker:S}=h,v=et({name:"ATimePicker",inheritAttrs:!1,props:Z(Z(Z(Z({},at()),Co()),Se()),{addon:{type:Function}}),slots:Object,setup(P,z){let{slots:$,expose:L,emit:_,attrs:d}=z;const p=P,R=st();Qt(!($.addon||p.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const U=k();L({focus:()=>{var a;(a=U.value)===null||a===void 0||a.focus()},blur:()=>{var a;(a=U.value)===null||a===void 0||a.blur()}});const D=(a,H)=>{_("update:value",a),_("change",a,H),R.onFieldChange()},b=a=>{_("update:open",a),_("openChange",a)},C=a=>{_("focus",a)},X=a=>{_("blur",a),R.onFieldBlur()},g=a=>{_("ok",a)};return()=>{const{id:a=R.id.value}=p;return t(w,ue(ue(ue({},d),Ze(p,["onUpdate:value","onUpdate:open"])),{},{id:a,dropdownClassName:p.popupClassName,mode:void 0,ref:U,renderExtraFooter:p.addon||$.addon||p.renderExtraFooter||$.renderExtraFooter,onChange:D,onOpenChange:b,onFocus:C,onBlur:X,onOk:g}),$)}}}),Y=et({name:"ATimeRangePicker",inheritAttrs:!1,props:Z(Z(Z(Z({},at()),xo()),Se()),{order:{type:Boolean,default:!0}}),slots:Object,setup(P,z){let{slots:$,expose:L,emit:_,attrs:d}=z;const p=P,R=k(),U=st();L({focus:()=>{var m;(m=R.value)===null||m===void 0||m.focus()},blur:()=>{var m;(m=R.value)===null||m===void 0||m.blur()}});const D=(m,J)=>{_("update:value",m),_("change",m,J),U.onFieldChange()},b=m=>{_("update:open",m),_("openChange",m)},C=m=>{_("focus",m)},X=m=>{_("blur",m),U.onFieldBlur()},g=(m,J)=>{_("panelChange",m,J)},a=m=>{_("ok",m)},H=(m,J,ee)=>{_("calendarChange",m,J,ee)};return()=>{const{id:m=U.id.value}=p;return t(S,ue(ue(ue({},d),Ze(p,["onUpdate:open","onUpdate:value"])),{},{id:m,dropdownClassName:p.popupClassName,picker:"time",mode:void 0,ref:R,onChange:D,onOpenChange:b,onFocus:C,onBlur:X,onPanelChange:g,onOk:a,onCalendarChange:H}),$)}}});return{TimePicker:v,TimeRangePicker:Y}}const{TimePicker:ve,TimeRangePicker:$e}=jo(Oo),mt=Z(ve,{TimePicker:ve,TimeRangePicker:$e,install:x=>(x.component(ve.name,ve),x.component($e.name,$e),x)});var Bo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};function lt(x){for(var h=1;h<arguments.length;h++){var w=arguments[h]!=null?Object(arguments[h]):{},S=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(S=S.concat(Object.getOwnPropertySymbols(w).filter(function(v){return Object.getOwnPropertyDescriptor(w,v).enumerable}))),S.forEach(function(v){Vo(x,v,w[v])})}return x}function Vo(x,h,w){return h in x?Object.defineProperty(x,h,{value:w,enumerable:!0,configurable:!0,writable:!0}):x[h]=w,x}var Me=function(h,w){var S=lt({},h,w.attrs);return t(ut,lt({},S,{icon:Bo}),null)};Me.displayName="CopyOutlined";Me.inheritAttrs=!1;var Go={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};function it(x){for(var h=1;h<arguments.length;h++){var w=arguments[h]!=null?Object(arguments[h]):{},S=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(S=S.concat(Object.getOwnPropertySymbols(w).filter(function(v){return Object.getOwnPropertyDescriptor(w,v).enumerable}))),S.forEach(function(v){Ao(x,v,w[v])})}return x}function Ao(x,h,w){return h in x?Object.defineProperty(x,h,{value:w,enumerable:!0,configurable:!0,writable:!0}):x[h]=w,x}var De=function(h,w){var S=it({},h,w.attrs);return t(ut,it({},S,{icon:Go}),null)};De.displayName="HourglassFilled";De.inheritAttrs=!1;const Qo={class:"form-box"},Yo={class:"upload-document-type-box"},Jo=["onClick"],Xo={class:"right-block"},Wo={class:"title-block"},Zo={class:"title-text"},Ko={class:"desc"},en={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(x,{expose:h,emit:w}){const S=Pe(),v=Fe(),Y=ke.useForm,P=k(!1),z=k("添加自定义文档"),$=x,L=K({library_id:v.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),_=k([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),d=g=>{L.qa_index_type=g},p=K({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:R,validate:U,validateInfos:D}=Y(L,p),b=()=>{P.value=!0,R(),L.file_name="",L.is_qa_doc=0,L.qa_index_type=1,$.libraryInfo.type==2&&(L.is_qa_doc=1)},C=k(!1),X=()=>{U().then(()=>{let g={...Le(L)};C.value=!0,ge(g).then(a=>{Q.success(`${z.value}成功`),P.value=!1,S.push("/library/preview?id="+a.data.file_ids[0])}).finally(()=>{C.value=!1})})};return h({add:b}),(g,a)=>{const H=be,m=Ue,J=mo,ee=po,te=rt,y=ke,N=oe;return n(),u("div",null,[t(N,{open:P.value,"onUpdate:open":a[2]||(a[2]=j=>P.value=j),title:z.value,onOk:X,width:"472px",confirmLoading:C.value},{default:s(()=>[o("div",Qo,[t(y,{layout:"vertical"},{default:s(()=>[t(m,uo({label:"文档名称"},T(D).file_name),{default:s(()=>[t(H,{type:"text",placeholder:"请输入文档名称",value:L.file_name,"onUpdate:value":a[0]||(a[0]=j=>L.file_name=j)},null,8,["value"])]),_:1},16),r("",!0),L.is_qa_doc==1?(n(),I(m,{key:1,label:"索引方式",required:""},{default:s(()=>[o("div",Yo,[(n(!0),u(E,null,re(_.value,j=>(n(),u("div",{class:ct(["type-item",{active:L.qa_index_type==j.value}]),key:j.value,onClick:me=>d(j.value)},[o("div",Xo,[o("div",Wo,[t(te,{name:L.qa_index_type==j.value?j.iconNameActive:j.iconName},null,8,["name"]),o("div",Zo,q(j.title),1)]),o("div",Ko,q(j.desc),1)]),L.qa_index_type==j.value?(n(),I(te,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):r("",!0)],10,Jo))),128))])]),_:1})):r("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},tn=he(en,[["__scopeId","data-v-80f3643f"]]),on={class:"alert-box"},nn={class:"upload-file-box"},an={key:0,class:"hight-set"},sn={key:0,class:"set-box"},ln={class:"form-item"},un={class:"form-item-body"},rn={class:"form-item"},dn={class:"form-item-body"},_n={class:"form-item"},cn={class:"form-item-body"},pn={key:1,class:"set-box"},mn={class:"form-item"},fn={class:"form-item-body"},vn={class:"form-item"},gn={class:"form-item-body"},yn={class:"form-item"},kn={class:"form-item-body"},hn={__name:"qa-upload-modal",emits:["ok"],setup(x,{expose:h,emit:w}){const S=Pe(),Y=Fe().query,P=k(!1),z=k(!1),$=k([]),L=w,_=k([]),d=K({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),p=k(!0),R=()=>{P.value=!0},U=()=>{let g=new FormData;$.value.forEach(a=>{g.append("library_files",a)}),Yt(g).then(a=>{let H=[];for(let m in a.data)H.push({lable:a.data[m],value:m});_.value=H})},D=()=>{if($.value.length==0){Q.error("请选择文件");return}z.value=!0;let g=new FormData;g.append("library_id",Y.id);let a=!1;$.value.forEach(H=>{(H.name.includes(".xlsx")||H.name.includes(".csv"))&&(a=!0),g.append("library_files",H)}),a?(g.append("question_column",d.question_column),g.append("answer_column",d.answer_column),d.similar_column&&g.append("similar_column",d.similar_column)):(g.append("question_lable",d.question_lable),g.append("answer_lable",d.answer_lable),g.append("similar_label",d.similar_label)),g.append("is_qa_doc",1),ge(g).then(H=>{L("ok"),P.value=!1,$.value=[],z.value=!1,a&&S.push("/library/document-segmentation?document_id="+H.data.file_ids[0])}).catch(()=>{z.value=!1})},b=()=>{$.value=[]},C=k(1),X=g=>{d.question_column=void 0,d.answer_column=void 0,d.similar_column=void 0,d.question_lable="问题：",d.answer_lable="答案：",d.similar_label="相似问题：",$.value=g,g&&g.length>0&&(g[0].type.includes(".document")?C.value=2:(C.value=1,U()))};return h({show:R}),(g,a)=>{const H=yo,m=Ie,J=Te,ee=be,te=oe;return n(),u("div",null,[t(te,{width:680,open:P.value,"onUpdate:open":a[8]||(a[8]=y=>P.value=y),"confirm-loading":z.value,maskClosable:!1,title:"上传文档",onOk:D,onCancel:b},{default:s(()=>[o("div",on,[t(H,{"show-icon":""},{message:s(()=>a[9]||(a[9]=[o("div",null,[c(" 通过word或者EXce形式导入问答对，建议您参考"),o("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),c("  "),o("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),c("创建导入文档 ")],-1),o("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)])),_:1})]),o("div",nn,[t(pt,{type:2,value:$.value,"onUpdate:value":a[0]||(a[0]=y=>$.value=y),onChange:X},null,8,["value"])]),$.value.length>0?(n(),u("div",an,[o("a",{onClick:a[1]||(a[1]=y=>p.value=!p.value)},[a[10]||(a[10]=c("高级设置： ")),p.value?(n(),I(T(go),{key:1})):(n(),I(T(vo),{key:0}))]),p.value?(n(),u(E,{key:0},[C.value==1?(n(),u("div",sn,[o("div",ln,[a[11]||(a[11]=o("div",{class:"form-item-label"},"问题所在列：",-1)),o("div",un,[t(J,{value:d.question_column,"onUpdate:value":a[2]||(a[2]=y=>d.question_column=y),placeholder:"请选择列名",style:{width:"100%"}},{default:s(()=>[(n(!0),u(E,null,re(_.value,y=>(n(),I(m,{value:y.value,key:y.value},{default:s(()=>[c(q(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),o("div",rn,[a[12]||(a[12]=o("div",{class:"form-item-label"},"相似问法所在列：",-1)),o("div",dn,[t(J,{value:d.similar_column,"onUpdate:value":a[3]||(a[3]=y=>d.similar_column=y),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:s(()=>[(n(!0),u(E,null,re(_.value,y=>(n(),I(m,{value:y.value,key:y.value},{default:s(()=>[c(q(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),o("div",_n,[a[13]||(a[13]=o("div",{class:"form-item-label"},"答案所在列：",-1)),o("div",cn,[t(J,{value:d.answer_column,"onUpdate:value":a[4]||(a[4]=y=>d.answer_column=y),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:s(()=>[(n(!0),u(E,null,re(_.value,y=>(n(),I(m,{value:y.value,key:y.value},{default:s(()=>[c(q(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):r("",!0),C.value==2?(n(),u("div",pn,[o("div",mn,[a[14]||(a[14]=o("div",{class:"form-item-label"},"问题开始标识符：",-1)),o("div",fn,[t(ee,{placeholder:"请输入标识符",value:d.question_lable,"onUpdate:value":a[5]||(a[5]=y=>d.question_lable=y)},null,8,["value"])])]),o("div",vn,[a[15]||(a[15]=o("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),o("div",gn,[t(ee,{placeholder:"请输入标识符",value:d.similar_label,"onUpdate:value":a[6]||(a[6]=y=>d.similar_label=y)},null,8,["value"])])]),o("div",yn,[a[16]||(a[16]=o("div",{class:"form-item-label"},"答案开始标识符：",-1)),o("div",kn,[t(ee,{placeholder:"请输入标识符",value:d.answer_lable,"onUpdate:value":a[7]||(a[7]=y=>d.answer_lable=y)},null,8,["value"])])])])):r("",!0)],64)):r("",!0)])):r("",!0)]),_:1},8,["open","confirm-loading"])])}}},bn=he(hn,[["__scopeId","data-v-a625c25c"]]),wn="/assets/img/guide-image-DSu20zRj.png",Cn={class:"container"},xn={class:"guide-content"},On={class:"content-box"},qn={__name:"guide-learning-tips",setup(x,{expose:h}){const w=dt(),S=k(!1),v=k(!1),Y=k(""),P=()=>{setTimeout(()=>{S.value=!0},500)},z=()=>{w.setGuideLearningTips(v.value),S.value=!1},$=()=>{w.setGuideLearningTips(v.value),S.value=!1};return h({show:P}),(L,_)=>{const d=bo,p=_t,R=oe;return n(),u("div",Cn,[t(R,{open:S.value,"onUpdate:open":_[1]||(_[1]=U=>S.value=U),title:Y.value,onOk:z,onCancel:$,width:"472px"},{footer:s(()=>[t(p,{type:"primary",onClick:z},{default:s(()=>_[5]||(_[5]=[c("我知道了")])),_:1,__:[5]})]),default:s(()=>[o("div",xn,[_[4]||(_[4]=o("img",{src:wn,alt:"操作引导",class:"guide-image"},null,-1)),o("div",On,[_[3]||(_[3]=o("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),t(d,{checked:v.value,"onUpdate:checked":_[0]||(_[0]=U=>v.value=U)},{default:s(()=>_[2]||(_[2]=[o("div",{class:"content-check"},"不再显示此提示",-1)])),_:1,__:[2]},8,["checked"])])])]),_:1},8,["open","title"])])}}},Sn=he(qn,[["__scopeId","data-v-33a87814"]]),$n={__name:"edit-online-doc",emits:["ok"],setup(x,{expose:h,emit:w}){const S=w,v=K({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),Y=k({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),P=k(!1),z=d=>{d=JSON.parse(JSON.stringify(d)),v.id=d.id||"",v.file_name=d.file_name||"",v.doc_auto_renew_frequency=+d.doc_auto_renew_frequency||1,d.doc_auto_renew_minute>0&&(v.doc_auto_renew_minute=ye(d.doc_auto_renew_minute)),P.value=!0},$=k(!1),L=k(null),_=()=>{L.value.validate().then(()=>{$.value=!0,Jt({...v,doc_auto_renew_minute:v.doc_auto_renew_minute?ye(v.doc_auto_renew_minute):0}).then(()=>{P.value=!1,$.value=!1,S("ok")})}).catch(()=>{$.value=!1})};return h({show:z}),(d,p)=>{const R=be,U=Ue,D=Ie,b=Te,C=mt,X=ke,g=oe;return n(),u("div",null,[t(g,{open:P.value,"onUpdate:open":p[3]||(p[3]=a=>P.value=a),"confirm-loading":$.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:_},{default:s(()=>[t(X,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:L,model:v,rules:Y.value},{default:s(()=>[t(U,{name:"file_name",label:"文件名称"},{default:s(()=>[t(R,{value:v.file_name,"onUpdate:value":p[0]||(p[0]=a=>v.file_name=a),placeholder:"请输入"},null,8,["value"])]),_:1}),t(U,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:s(()=>[t(b,{value:v.doc_auto_renew_frequency,"onUpdate:value":p[1]||(p[1]=a=>v.doc_auto_renew_frequency=a),style:{width:"100%"}},{default:s(()=>[t(D,{value:1},{default:s(()=>p[4]||(p[4]=[c("不自动更新")])),_:1,__:[4]}),t(D,{value:2},{default:s(()=>p[5]||(p[5]=[c("每天")])),_:1,__:[5]}),t(D,{value:3},{default:s(()=>p[6]||(p[6]=[c("每3天")])),_:1,__:[6]}),t(D,{value:4},{default:s(()=>p[7]||(p[7]=[c("每7天")])),_:1,__:[7]}),t(D,{value:5},{default:s(()=>p[8]||(p[8]=[c("每30天")])),_:1,__:[8]})]),_:1},8,["value"])]),_:1}),v.doc_auto_renew_frequency>1?(n(),I(U,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:s(()=>[t(C,{valueFormat:"HH:mm",value:v.doc_auto_renew_minute,"onUpdate:value":p[2]||(p[2]=a=>v.doc_auto_renew_minute=a),format:"HH:mm"},null,8,["value"])]),_:1})):r("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},Ln={class:"details-library-page"},Fn={class:"list-tools"},Pn={class:"tools-items"},Un={class:"tool-item"},Tn={class:"dropdown-btn-menu"},In={key:0,class:"desc"},Mn={key:1,class:"desc"},Dn={class:"dropdown-btn-menu"},Rn={class:"dropdown-btn-menu"},Nn={class:"right-box"},zn={key:0,class:"status-box"},Hn={class:"status-item"},En={class:"status-content"},jn={class:"status-item"},Bn={class:"status-content content-tip"},Vn={class:"status-item"},Gn={class:"status-content content-tip"},An={key:1,class:"status-select-box"},Qn={class:"tool-item"},Yn={class:"list-content"},Jn={key:0,class:"doc-name-td"},Xn=["href"],Wn=["onClick"],Zn={key:0},Kn={key:1},ea=["onClick"],ta={key:0},oa={key:1},na={key:2,class:"url-remark"},aa=["onClick"],sa={key:0,class:"pdf-progress-box"},la={class:"progress-title"},ia={class:"status-box"},ua=["onClick"],ra={class:"progress-bar"},da={class:"num-box"},_a={key:0,class:"status-tag running"},ca={key:2,class:"status-tag running"},pa={key:3,class:"status-tag complete"},ma={class:"status-tag status-error"},fa=["onClick"],va={class:"status-tag status-error"},ga={class:"status-tag"},ya=["onClick"],ka={key:7,class:"status-tag"},ha={key:8,class:"status-tag running"},ba={class:"status-tag error"},wa={key:10,class:"status-tag cancel"},Ca={key:11,class:"status-tag subning"},xa={class:"status-tag"},Oa=["onClick"],qa={key:1,class:"status-tag running"},Sa={key:2,class:"status-tag complete"},$a={class:"status-tag error"},La=["onClick"],Fa={class:"zm-line1 reason-text"},Pa={key:4,class:"status-tag running"},Ua={class:"status-tag warning"},Ta={class:"reason-text"},Ia=["onClick"],Ma={key:0},Da={key:1},Ra={key:0,class:"text-block"},Na={class:"time-content-box"},za={key:0},Ha={key:1},Ea={key:2},ja={key:3},Ba={key:4},Va={key:5,class:"ml4"},Ga={key:6},Aa=["onClick"],Qa={key:1},Ya={key:0},Ja={key:1},Xa=["onClick"],Wa=["onClick"],Za=["onClick"],Ka={class:"upload-file-box"},es={class:"select-card-box"},ts=["onClick"],os={class:"card-title"},ns={key:0,class:"card-switch-box"},as={class:"card-desc"},ss={key:0,class:"card-switch"},ls={__name:"knowledge-document",setup(x){const{setStorage:h}=oo("localStorage"),w=Xt(),{changeGraphSwitch:S}=w,v=Wt(),Y=Ce(()=>{var i;return((i=v.companyInfo)==null?void 0:i.neo4j_status)=="true"}),P=Ce(()=>{var i;return((i=v.companyInfo)==null?void 0:i.ali_ocr_switch)=="1"}),z=dt(),$=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"},{key:4,title:"阿里云OCR解析",icon:"ali-ocr",desc:"通过阿里云文档智能接口解析提取图片和文字"}],L=Fe(),_=Pe(),d=L.query,p=k(!1),R=k(null),U=k(null),D=k(!1),b=k({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});K({selectedRowKeys:[]});const C=K({use_model:"",model_config_id:""}),X=(i,e)=>{let O=e.modelName,B=e.modelId;te.value.length>0?oe.confirm({title:`确定切换模型为${O}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){C.use_model=O,C.model_config_id=B,g()},onCancel(){}}):(C.use_model=O,C.model_config_id=B,g())},g=(i=!0,e=null)=>{io({...Le(b.value),use_model:C.use_model,model_config_id:C.model_config_id}).then(()=>{b.value.use_model=C.use_model,b.value.model_config_id=C.model_config_id,typeof e=="function"&&e(),i&&Q.success("保存成功")})},a=k([]),H=i=>{a.value=i},m=k([]),J=i=>{m.value=i,ee()},ee=()=>{if(!b.value.id){setTimeout(()=>{ee()},100);return}if(m.value.length>0&&!b.value.use_model){let i=null,e=null;for(let O of m.value)if(O.model_define==="chatwiki"){i=O;for(let B of i.children)if(B.name==="text-embedding-v2"){e=B;break}break}i||(i=m.value[0],e=i.children[0]),i&&(C.use_model=e.name,C.model_config_id=e.model_config_id,g(!1))}},te=k([]),y=K({learned_err_count:0,learned_count:0,learned_wait_count:0}),N=K({library_id:d.id,file_name:void 0,status:"",page:1,size:10,total:0}),j=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],me=k([]),Re=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],ft=i=>{ne()},vt=i=>{N.page=i.current,N.size=i.pageSize,G()},ne=()=>{N.page=1,G()};let Ne=!1;const gt=({id:i})=>{te.value.length==1&&(Ne=!0),lo({id:i}).then(()=>{Ne&&N.page>1&&N.page--,G(),Q.success("删除成功")})},ae=(i,e={})=>{if(i.status=="4")return _.push({path:"/library/document-segmentation",query:{document_id:i.id,page:N.page}});if(i.status=="3"&&b.value.type!=2)return Q.error("学习失败,不可预览");if(i.status=="0")return Q.error("转换中,稍候可预览");if(i.status=="1")return Q.error("学习中,不可预览");if(i.status=="6")return Q.error("获取中,不可预览");if(i.status=="7")return Q.error("获取失败,不可预览");if(i.status=="10")return Q.error("正在分段,不可预览");_.push({name:"libraryPreview",query:{id:i.id,...e}})},G=()=>{let i=Le(N);i.status==0&&(i.status=""),p.value=!0,Zt(i).then(e=>{let O=e.data.info;!C.use_model&&C.use_model!=O.use_model&&(C.use_model=O.use_model,C.model_config_id=O.model_config_id),b.value={...O},D.value=O.graph_switch==1,O.graph_switch=="0"||!Y.value?me.value=Re.filter(A=>!["graph_status","graph_entity_count"].includes(A.key)):me.value=Re;let B=e.data.list||[],W=e.data.count_data||{};N.total=e.data.total,y.learned_count=W.learned_count,y.learned_err_count=W.learned_err_count,y.learned_wait_count=W.learned_wait_count;let se=!1;te.value=B.map(A=>(["1","6","0","5"].includes(A.status)&&(se=!0),A.file_size_str=Kt(A.file_size),A.update_time=Ke(A.update_time*1e3).format("YYYY-MM-DD HH:mm"),A.doc_last_renew_time_desc=A.doc_last_renew_time>0?Ke(A.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",A)),se&&yt(),!se&&clearInterval(de.value)}).finally(()=>{p.value=!1})},de=k(null),yt=()=>{clearInterval(de.value),de.value=setInterval(()=>{G()},1e3*5)},ze=k(null),kt=i=>{if(m.value.length==0){oe.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){_.push({path:"/user/model"})}});return}let{key:e}=i;e==1&&Ct(),e==2&&ht(),e==3&&ze.value.add()},F=K({open:!1,urls:"",library_id:d.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(i,e)=>ot(e)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),ht=()=>{F.open=!0,F.confirmLoading=!1,F.urls="",F.doc_auto_renew_minute="02:00",F.doc_auto_renew_frequency=1},He=k(null),bt=()=>{He.value.validate().then(()=>{F.confirmLoading=!0,ge({library_id:F.library_id,urls:JSON.stringify(ot(F.urls)),doc_auto_renew_frequency:F.doc_auto_renew_frequency,doc_auto_renew_minute:ye(F.doc_auto_renew_minute),doc_type:2}).then(()=>{F.open=!1,F.confirmLoading=!1,ne()})}).catch(()=>{F.confirmLoading=!1})},wt=()=>{F.open=!1},M=K({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),Ee=Ce(()=>M.fileList.filter(i=>i.type==="application/pdf").length>0),je=k(null),Ct=()=>{if(b.value.type==2){je.value.show();return}M.fileList=[],M.open=!0},xt=()=>{M.fileList=[]},Ot=i=>{M.fileList=i},qt=()=>{if(R.value&&!z.getGuideLearningTips&&M.fileList.length>1&&R.value.show(),M.fileList.length==0){Q.error("请选择文件");return}M.confirmLoading=!0;let i=new FormData;i.append("library_id",N.library_id);let e=!1;M.fileList.forEach(O=>{(O.name.includes(".xlsx")||O.name.includes(".csv"))&&(e=!0),i.append("library_files",O)}),Ee.value&&i.append("pdf_parse_type",M.pdf_parse_type),ge(i).then(O=>{G(),M.open=!1,M.fileList=[],M.confirmLoading=!1,e&&O.data.file_ids.length==1&&_.push("/library/document-segmentation?document_id="+O.data.file_ids[0])}).catch(()=>{M.confirmLoading=!1})},Be=k(null),St=i=>{Be.value.show(i)},$t=i=>{_.push({path:"/library/document-segmentation",query:{document_id:i.id}})},Ve=i=>{ao({id:i.id}).then(()=>{G()})},Lt=()=>{if(D.value){D.value=!1;let i={graph_model_config_id:b.value.graph_model_config_id,graph_use_model:b.value.graph_use_model};if((!i.graph_model_config_id||!i.graph_use_model)&&a.value.length>0){let O=a.value[0].children[0];i.graph_use_model=O.name,i.graph_model_config_id=O.model_config_id}U.value.show(i)}else b.value.graph_switch=0,g(!1,()=>{G(),S(0)})},Ft=i=>{D.value=!0,b.value.graph_switch=1,b.value.graph_model_config_id=i.graph_model_config_id,b.value.graph_use_model=i.graph_use_model,g(!1,()=>{G(),S(1)})},Pt=i=>{if(i.key==4&&!P.value)return!1;M.pdf_parse_type=i.key},Ut=()=>{window.open("#/user/aliocr")},Ge=k(null),Ae=i=>{Ge.value.show({...i})},Tt=i=>{so({id:i.id}).then(e=>{Q.success("更新成功"),G()})},It=i=>{oe.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){no({id:i.id}).then(e=>{Q.success("取消成功"),G()})}})},Mt=i=>{h("graph:autoOpenFileId",i.id),_.push({path:"/library/details/knowledge-graph",query:{id:d.id}})};return ro(()=>{d.page&&(N.page=+d.page),G()}),_o(()=>{de.value&&clearInterval(de.value)}),(i,e)=>{const O=rt,B=Do,W=Lo,se=$o,A=_t,Qe=qo,Dt=Ro,le=Ie,Ye=Te,Rt=be,Nt=zo,zt=Po,_e=Uo,ce=Ho,Je=To,Ht=No,Et=Gt,pe=Ue,Xe=ke,We=oe,jt=Eo,Bt=mt,Vt=co("copy");return n(),u("div",Ln,[t(Et,{scrollbar:!1},{default:s(()=>[o("div",Fn,[o("div",Pn,[o("div",Un,[t(Qe,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:s(()=>[t(se,{onClick:kt},{default:s(()=>[(n(),I(W,{key:1},{default:s(()=>[o("div",Tn,[t(B,{class:"title-block",gap:4},{default:s(()=>[t(O,{name:"doc-icon"}),e[10]||(e[10]=o("div",{class:"title"},"本地文档",-1))]),_:1,__:[10]}),b.value.type==2?(n(),u("div",In," 上传本地 docx/csv/xlsx 等格式文件 ")):(n(),u("div",Mn," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),b.value.type!=2?(n(),I(W,{key:2},{default:s(()=>[o("div",Dn,[t(B,{class:"title-block",gap:4},{default:s(()=>[t(O,{name:"link-icon"}),e[11]||(e[11]=o("div",{class:"title"},"在线数据",-1))]),_:1,__:[11]}),e[12]||(e[12]=o("div",{class:"desc"},"获取在线网页内容",-1))])]),_:1})):r("",!0),(n(),I(W,{key:3},{default:s(()=>[o("div",Rn,[t(B,{class:"title-block",gap:4},{default:s(()=>[t(O,{name:"cu-doc-icon"}),e[13]||(e[13]=o("div",{class:"title"},"自定义文档",-1))]),_:1,__:[13]}),e[14]||(e[14]=o("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1))])]),_:1}))]),_:1})]),default:s(()=>[t(A,{type:"primary"},{icon:s(()=>[t(T(So))]),default:s(()=>[e[15]||(e[15]=o("span",null,"添加内容",-1))]),_:1,__:[15]})]),_:1})]),xe(t(B,{align:"center",class:"tool-item custom-select-box"},{default:s(()=>[e[16]||(e[16]=o("span",null,"嵌入模型：",-1)),t(nt,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:C.use_model,modeId:C.model_config_id,style:{width:"240px"},onChange:X,onLoaded:J},null,8,["modeName","modeId"])]),_:1,__:[16]},512),[[tt,!1]]),Y.value?(n(),I(B,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:s(()=>[xe(t(nt,{modelType:"LLM",onLoaded:H},null,512),[[tt,!1]]),e[17]||(e[17]=o("span",null,"生成知识图谱：",-1)),t(Dt,{checked:D.value,"onUpdate:checked":e[0]||(e[0]=f=>D.value=f),onChange:Lt,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1,__:[17]})):r("",!0)]),o("div",Nn,[b.value.type==0?(n(),u("div",zn,[o("div",Hn,[e[18]||(e[18]=o("div",{class:"status-label"},"已学习：",-1)),o("div",En,q(y.learned_count),1)]),o("div",jn,[e[19]||(e[19]=o("div",{class:"status-label"},"，未学习：",-1)),o("div",Bn,q(y.learned_wait_count),1)]),o("div",Vn,[e[20]||(e[20]=o("div",{class:"status-label"},"，学习失败：",-1)),o("div",Gn,q(y.learned_err_count),1)])])):r("",!0),b.value.type==0?(n(),u("div",An,[t(Ye,{value:N.status,"onUpdate:value":e[1]||(e[1]=f=>N.status=f),style:{width:"150px"},placeholder:"请选择",onChange:ft},{default:s(()=>[(n(),u(E,null,re(j,f=>t(le,{key:f.id,value:f.id},{default:s(()=>[c(q(f.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):r("",!0),o("div",Qn,[t(Rt,{style:{width:"282px"},value:N.file_name,"onUpdate:value":e[2]||(e[2]=f=>N.file_name=f),placeholder:"请输入文档名称搜索",onChange:ne},{suffix:s(()=>[t(T(Fo),{onClick:ne,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),b.value.type==0?(n(),I(ho,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:s(()=>e[21]||(e[21]=[o("div",null,[o("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),o("p",null,"2、未学习的文档数据不会被检索到。")],-1)])),_:1,__:[21]})):r("",!0),o("div",Yn,[t(Ht,{columns:me.value,"data-source":te.value,scroll:{x:1e3},"row-key":"id",pagination:{current:N.page,total:N.total,pageSize:N.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:vt},{bodyCell:s(({column:f,record:l})=>[f.key==="file_name"?(n(),u("div",Jn,[l.doc_type==2?(n(),I(Nt,{key:0,title:null},{content:s(()=>[e[22]||(e[22]=c(" 原链接：")),o("a",{href:l.doc_url,target:"_blank"},q(l.doc_url),9,Xn),xe(t(T(Me),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[Vt,`${l.doc_url}`]])]),default:s(()=>[o("a",{onClick:V=>ae(l)},[["5","6","7"].includes(l.status)?(n(),u("span",Zn,q(l.doc_url),1)):(n(),u("span",Kn,q(l.file_name),1))],8,Wn)]),_:2},1024)):(n(),u("a",{key:1,onClick:V=>ae(l)},[["5","6","7"].includes(l.status)?(n(),u("span",ta,q(l.doc_url),1)):(n(),u("span",oa,q(l.file_name),1))],8,ea)),l.doc_type==2&&l.remark?(n(),u("div",na," 备注："+q(l.remark),1)):r("",!0)])):r("",!0),f.key==="graph_entity_count"?(n(),u("a",{key:1,onClick:V=>Mt(l)},q(l.graph_entity_count),9,aa)):r("",!0),f.key==="status"?(n(),u(E,{key:2},[l.file_ext=="pdf"&&l.pdf_parse_type>=2?(n(),u(E,{key:0},[l.status==0?(n(),u("div",sa,[o("div",la,[o("span",ia,[t(T(eo)),e[23]||(e[23]=c("文档解析中"))]),o("a",{onClick:V=>It(l)},"取消",8,ua)]),o("div",ra,[t(zt,{size:"small",class:"progress-bar-box",percent:parseInt(l.ocr_pdf_index/l.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),o("div",da,q(l.ocr_pdf_index)+" / "+q(l.ocr_pdf_total),1)])])):r("",!0)],64)):(n(),u(E,{key:1},[l.status==0?(n(),u("span",_a,[t(_e,{size:"small"}),e[24]||(e[24]=c(" 转换中"))])):r("",!0)],64)),l.status==1?(n(),u("span",ca,[t(_e,{size:"small"}),e[25]||(e[25]=c(" 学习中"))])):r("",!0),l.status==2?(n(),u("span",pa,[t(T(we)),e[26]||(e[26]=c(" 学习完成"))])):r("",!0),l.status==3?(n(),I(ce,{key:4,placement:"top"},{title:s(()=>[o("span",null,q(l.errmsg),1)]),default:s(()=>[o("span",null,[o("span",ma,[t(T(fe)),e[27]||(e[27]=c(" 转换失败"))]),b.value.type==2?(n(),u("a",{key:0,class:"ml8",onClick:V=>ae(l)},"学习",8,fa)):r("",!0)])]),_:2},1024)):r("",!0),l.status==8?(n(),I(ce,{key:5,placement:"top"},{title:s(()=>[o("span",null,q(l.errmsg),1)]),default:s(()=>[o("span",null,[o("span",va,[t(T(fe)),e[28]||(e[28]=c(" 转化异常"))])])]),_:2},1024)):r("",!0),l.status==4?(n(),u(E,{key:6},[o("span",ga,[t(T(qe)),e[29]||(e[29]=c(" 待学习"))]),o("a",{class:"ml8",onClick:V=>ae(l)},"学习",8,ya)],64)):r("",!0),l.status==5?(n(),u("span",ka,[t(T(qe)),e[30]||(e[30]=c(" 待获取"))])):r("",!0),l.status==6?(n(),u("span",ha,[t(_e,{size:"small"}),e[31]||(e[31]=c(" 获取中"))])):r("",!0),l.status==7?(n(),I(ce,{key:9,placement:"top"},{title:s(()=>[o("span",null,q(l.errmsg),1)]),default:s(()=>[o("span",ba,[t(T(fe)),e[32]||(e[32]=c(" 获取失败"))])]),_:2},1024)):r("",!0),l.status==9?(n(),u("span",wa,[t(T(to)),e[33]||(e[33]=c(" 取消解析"))])):r("",!0),l.status==10?(n(),u("span",Ca,[t(_e,{size:"small"}),e[34]||(e[34]=c(" 正在分段 "))])):r("",!0)],64)):r("",!0),f.key==="graph_status"?(n(),u(E,{key:3},[l.graph_status==0?(n(),u(E,{key:0},[o("span",xa,[t(T(qe)),e[35]||(e[35]=c(" 待生成"))]),o("a",{class:"ml8",onClick:V=>Ve(l)},"生成",8,Oa)],64)):l.graph_status==1?(n(),u("span",qa,[t(T(De)),e[36]||(e[36]=c(" 排队中"))])):l.graph_status==2?(n(),u("span",Sa,[t(T(we)),e[37]||(e[37]=c(" 生成完成"))])):l.graph_status==3?(n(),u(E,{key:3},[o("span",$a,[t(T(fe)),e[38]||(e[38]=c(" 生成失败"))]),o("a",{class:"ml8",onClick:V=>Ve(l)},"生成",8,La),l.graph_err_msg?(n(),I(ce,{key:0,title:l.graph_err_msg},{default:s(()=>[o("div",Fa,"原因："+q(l.graph_err_msg),1)]),_:2},1032,["title"])):r("",!0)],64)):l.graph_status==4?(n(),u("span",Pa,[t(_e,{size:"small"}),e[39]||(e[39]=c(" 生成中"))])):l.graph_status==5?(n(),u(E,{key:5},[o("span",Ua,[t(T(we)),e[40]||(e[40]=c(" 部分成功"))]),o("div",Ta,[c(" 失败数："+q(l.graph_err_count||0)+" ",1),o("a",{class:"ml8",onClick:V=>ae(l,{graph_status:3})},"详情",8,Ia)])],64)):r("",!0)],64)):r("",!0),f.key==="file_size"?(n(),u(E,{key:4},[l.doc_type==3?(n(),u("span",Ma,"-")):(n(),u("span",Da,q(l.file_size_str),1))],64)):r("",!0),f.key==="doc_auto_renew_frequency"?(n(),u(E,{key:5},[l.doc_type==2?(n(),u("div",Ra,[o("div",Na,[l.doc_auto_renew_frequency==1?(n(),u("span",za,"不自动更新")):r("",!0),l.doc_auto_renew_frequency==2?(n(),u("span",Ha,"每天")):r("",!0),l.doc_auto_renew_frequency==3?(n(),u("span",Ea,"每3天")):r("",!0),l.doc_auto_renew_frequency==4?(n(),u("span",ja,"每7天")):r("",!0),l.doc_auto_renew_frequency==5?(n(),u("span",Ba,"每30天")):r("",!0),l.doc_auto_renew_frequency>1&&l.doc_auto_renew_minute>0?(n(),u("span",Va,q(T(ye)(l.doc_auto_renew_minute)),1)):r("",!0),l.doc_auto_renew_frequency>1?(n(),u("span",Ga,"更新")):r("",!0),o("a",{class:"ml4 btn-hover-block",onClick:V=>Ae(l)},"修改",8,Aa)]),t(B,{align:"center"},{default:s(()=>[c(" 最近更新: "+q(l.doc_last_renew_time_desc)+" ",1),t(Je,{title:"确认更新?",onConfirm:V=>Tt(l)},{default:s(()=>e[41]||(e[41]=[o("a",{class:"ml4 btn-hover-block"},"更新",-1)])),_:2,__:[41]},1032,["onConfirm"])]),_:2},1024)])):(n(),u("div",Qa,"--"))],64)):r("",!0),f.key==="paragraph_count"?(n(),u(E,{key:6},[l.status==0||l.status==1?(n(),u("span",Ya,"-")):(n(),u("span",Ja,q(l.paragraph_count),1))],64)):r("",!0),f.key==="action"?(n(),I(B,{key:7,gap:8},{default:s(()=>[t(ce,null,{title:s(()=>e[42]||(e[42]=[c("重新分段")])),default:s(()=>[t(T(Io),{class:"btn-hover-block",onClick:V=>$t(l)},null,8,["onClick"])]),_:2},1024),t(Qe,null,{overlay:s(()=>[t(se,null,{default:s(()=>[l.doc_type==2?(n(),I(W,{key:0},{default:s(()=>[o("div",{onClick:V=>Ae(l)},"编辑",8,Xa)]),_:2},1024)):r("",!0),t(W,{disabled:l.status==6||l.status==7||l.status==0},{default:s(()=>[o("div",{onClick:V=>ae(l)},"预览",8,Wa)]),_:2},1032,["disabled"]),t(W,null,{default:s(()=>[o("div",{onClick:V=>St(l)},"重命名",8,Za)]),_:2},1024),t(W,null,{default:s(()=>[t(Je,{title:"确定要删除吗?",onConfirm:V=>gt(l)},{default:s(()=>e[43]||(e[43]=[o("span",null,"删除",-1)])),_:2,__:[43]},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:s(()=>[o("div",{class:"table-btn",onClick:e[3]||(e[3]=Oe(()=>{},["prevent"]))},[t(T(Mo),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):r("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),t(We,{open:M.open,"onUpdate:open":e[5]||(e[5]=f=>M.open=f),"confirm-loading":M.confirmLoading,maskClosable:!1,title:"上传文档",onOk:qt,onCancel:xt,width:"740px"},{default:s(()=>[t(Xe,{class:"mt24"},{default:s(()=>[t(pe,{required:"",label:""},{default:s(()=>[o("div",Ka,[t(pt,{type:b.value.type,maxCount:20,value:M.fileList,"onUpdate:value":e[4]||(e[4]=f=>M.fileList=f),onChange:Ot},null,8,["type","value"])])]),_:1}),Ee.value?(n(),I(pe,{key:0,required:"",label:"PDF解析模式",class:"select-card-main"},{default:s(()=>[o("div",es,[(n(),u(E,null,re($,f=>o("div",{key:f.key,class:ct(["select-card-item",{active:M.pdf_parse_type==f.key},{disabled:f.key==4&&!P.value}]),onClick:Oe(l=>Pt(f),["stop"])},[t(O,{class:"check-arrow",name:"check-arrow-filled"}),o("div",os,[t(O,{name:f.icon,style:{"font-size":"16px"}},null,8,["name"]),c(" "+q(f.title)+" ",1),f.key==4&&!P.value?(n(),u("div",ns,"未开启")):r("",!0)]),o("div",as,q(f.desc),1),f.key==4&&!P.value?(n(),u("div",ss,[e[44]||(e[44]=c(" 未开启阿里云OCR ")),o("div",{class:"card-switch-btn",onClick:Oe(Ut,["stop"])},"去开启")])):r("",!0)],10,ts)),64))])]),_:1})):r("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),t(bn,{onOk:G,ref_key:"qaUploadModalRef",ref:je},null,512),t(We,{open:F.open,"onUpdate:open":e[9]||(e[9]=f=>F.open=f),"confirm-loading":F.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:bt,onCancel:wt},{default:s(()=>[t(Xe,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:He,model:F,rules:F.rules},{default:s(()=>[t(pe,{name:"urls",label:"网页链接"},{default:s(()=>[t(jt,{style:{height:"120px"},value:F.urls,"onUpdate:value":e[6]||(e[6]=f=>F.urls=f),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),t(pe,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:s(()=>[t(Ye,{value:F.doc_auto_renew_frequency,"onUpdate:value":e[7]||(e[7]=f=>F.doc_auto_renew_frequency=f),style:{width:"100%"}},{default:s(()=>[t(le,{value:1},{default:s(()=>e[45]||(e[45]=[c("不自动更新")])),_:1,__:[45]}),t(le,{value:2},{default:s(()=>e[46]||(e[46]=[c("每天")])),_:1,__:[46]}),t(le,{value:3},{default:s(()=>e[47]||(e[47]=[c("每3天")])),_:1,__:[47]}),t(le,{value:4},{default:s(()=>e[48]||(e[48]=[c("每7天")])),_:1,__:[48]}),t(le,{value:5},{default:s(()=>e[49]||(e[49]=[c("每30天")])),_:1,__:[49]})]),_:1},8,["value"])]),_:1}),F.doc_auto_renew_frequency>1?(n(),I(pe,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:s(()=>[t(Bt,{valueFormat:"HH:mm",value:F.doc_auto_renew_minute,"onUpdate:value":e[8]||(e[8]=f=>F.doc_auto_renew_minute=f),format:"HH:mm"},null,8,["value"])]),_:1})):r("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),t(tn,{libraryInfo:b.value,onOk:ne,ref_key:"addCustomDocumentRef",ref:ze},null,8,["libraryInfo"]),t(ko,{onOk:ne,ref_key:"renameModalRef",ref:Be},null,512),t(fo,{onOk:Ft,ref_key:"openGrapgModalRef",ref:U},null,512),t(Sn,{ref_key:"guideLearningTipsRef",ref:R},null,512),t($n,{onOk:G,ref_key:"editOnlineDocRef",ref:Ge},null,512)])}}},ql=he(ls,[["__scopeId","data-v-f202948c"]]);export{ql as default};
