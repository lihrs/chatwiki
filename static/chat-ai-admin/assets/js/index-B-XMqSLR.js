import{n as m,b as F,h as T,V,a1 as q,bq as M}from"../../index-DGlN_gTP.js";import{d as x,z as O,q as N,w as U,N as r,O as o,X as f,j as l,U as D,F as z,a1 as B,u as v,S as Y,Z as k,_ as E,a3 as L,a6 as p}from"./vue-chunks-BRsu9_To.js";import{a as Q,_ as R}from"./RadioButton-Bnx6tN7r.js";import{R as j}from"./dayjs-BdOaYb8P.js";import{g as H}from"./index-3HgauxnH.js";import{C as P}from"./ClockCircleFilled-BeddiC3T.js";import{Q as A}from"./QuestionCircleOutlined-Bvo9_S3-.js";import{_ as J}from"./index-CNkxcL4v.js";import{a as X}from"./index-DIzQ-2kQ.js";import{_ as Z}from"./index-BQDPftJ3.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./FormItemContext-DAoPsdM7.js";import"./Checkbox-B8J-JVwM.js";import"./index-Bm8PAQv0.js";import"./index-BiKG4PZA.js";import"./colors-DKWwHq2l.js";import"./CheckOutlined-B_Hs0-OP.js";import"./Trigger-oBKhEx1B.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./index-BlDgRIYn.js";import"./index-C0cXlrXm.js";import"./slide-Ccxw2gRU.js";import"./index-k9nX7Zez.js";import"./DownOutlined-BUKGfKlO.js";import"./SearchOutlined-DSY7YbKD.js";import"./move-BSoEcIoa.js";import"./shallowequal-C0xnIuy8.js";import"./index-Bar3uf0o.js";import"./useMaxLevel-CkEcKQq6.js";import"./collapseMotion-Brd6xpAT.js";import"./CaretDownFilled-7wQJySwA.js";import"./index-Cf43OwEB.js";import"./responsiveObserve-BLoLQTqt.js";import"./fromPairs-Dx9PT-t0.js";import"./index-DBSnNVJY.js";import"./LeftOutlined-D6kSS-Pc.js";import"./RightOutlined-TchQhXHc.js";import"./index-CVsoyaFF.js";import"./index-Jd-vOpFR.js";import"./dropdown-0QsfqJqV.js";import"./index-D35sYO_B.js";import"./index-SBg8gFw7.js";import"./CaretDownOutlined-Cx15LuFR.js";import"./index-JAP4Oum8.js";import"./Input-BpI49rDY.js";import"./inputProps-Bu_dzA3C.js";import"./Search-CH76L-gx.js";import"./isPlainObject-51jSOJKV.js";import"./TextArea-BNOG6RQ7.js";import"./Password-B9FCv-aw.js";const G={class:"zm-date"},K={class:"date-btn"},W={class:"date-content"},tt={__name:"date",props:{datekey:{type:String,default:""}},emits:["dateChange"],setup(I,{emit:S}){const c=I,d=x(1),n=S;let w=O([{label:"近7日",value:!0,key:2,start_date:m().subtract(6,"day"),end_date:m().subtract(0,"day")},{label:"近14日",value:!1,key:3,start_date:m().subtract(13,"day"),end_date:m().subtract(0,"day")},{label:"近30日",value:!1,key:4,start_date:m().subtract(29,"day"),end_date:m().subtract(0,"day")}]);const b=x(null),h=x(null),y=x([]),$=a=>a>=m().subtract(0,"day"),C=()=>{let a=d.value,t=null;w.forEach(_=>{_.key==a&&(t=_)}),y.value=[t.start_date,t.end_date],b.value=t.start_date.startOf("day").unix(),h.value=t.end_date.endOf("day").unix(),e()},s=(a,t)=>{b.value=a[0].startOf("day").unix(),h.value=a[1].endOf("day").unix(),d.value=1,e()},e=()=>{n("dateChange",{start_time:b.value,end_time:h.value})};return N(()=>{d.value=parseInt(c.datekey),C()}),U(()=>c.datekey,(a,t)=>{d.value=parseInt(c.datekey.split("-")[0]),C()}),(a,t)=>{const _=Q,g=R,i=j;return o(),r("div",G,[f("div",K,[l(g,{value:d.value,"onUpdate:value":t[0]||(t[0]=u=>d.value=u),onChange:C},{default:D(()=>[(o(!0),r(z,null,B(v(w),u=>(o(),Y(_,{class:"date-btn-button",value:u.key,key:u.key},{default:D(()=>[k(E(u.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),f("div",W,[l(i,{value:y.value,"onUpdate:value":t[1]||(t[1]=u=>y.value=u),onChange:s,format:"YYYY-MM-DD",disabledDate:$,allowClear:!1},null,8,["value"])])])}}},et={class:"user-model-page"},at={class:"list-wrapper"},st={class:"content-wrapper"},ot={class:"search-block"},nt={key:0,class:"status-item status-0"},rt={key:1,class:"status-item status-1"},it={key:2,class:"status-item status-2"},lt={key:3,class:"status-item status-3"},dt=["onClick"],_t={key:1},ut={__name:"index",setup(I){const S=T(),c=L().query,d=x([]),n=O({robot_id:c.id,page:1,size:10,total:0,start_time:"",end_time:""}),w=s=>{n.page=s.current,n.size=s.pageSize,y()},b=()=>{n.page=1,y()},h=s=>{n.start_time=s.start_time,n.end_time=s.end_time,b()},y=()=>{H({...n}).then(s=>{let e=s.data.list,a=s.data.map;e.forEach(t=>{var _;t.create_time_desc=m(t.create_time*1e3).format("YYYY/MM/DD HH:mm"),t.source_desc=(_=a.filter(g=>g.source==t.source)[0])==null?void 0:_.source_name,t.is_over_7_days=t.create_time<Date.now()/1e3-7*24*60*60}),d.value=e,n.total=+s.data.total})},$=s=>{let e=`/manage/downloadExportFile?id=${s.id}&robot_id=${c.id}&token=${S.getToken}`;var a=document.createElement("a");a.href=e,a.style.display="none",a.click()},C=[{title:"导出时间",dataIndex:"create_time_desc",key:"create_time_desc"},{title:"导出文件名称",dataIndex:"file_name",key:"file_name"},{title:"来源",key:"source_desc",dataIndex:"source_desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action"}];return(s,e)=>{const a=J,t=Z,_=X;return o(),r("div",et,[e[4]||(e[4]=f("div",{class:"page-title"},"导出记录",-1)),f("div",at,[f("div",st,[l(a,{"show-icon":"",message:"导出文件仅保留7天，7天后自动删除，请及时下载到本地"}),f("div",ot,[l(tt,{datekey:"2",onDateChange:h})]),l(_,{class:"table-list",columns:C,"data-source":d.value,pagination:{current:n.page,total:n.total,pageSize:n.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:w},{bodyCell:D(({column:g,record:i})=>[g.key==="status"?(o(),r(z,{key:0},[i.status==0?(o(),r("div",nt,[l(v(P)),e[0]||(e[0]=k("等待导出 "))])):p("",!0),i.status==1?(o(),r("div",rt,[l(v(V)),e[1]||(e[1]=k("导出中 "))])):p("",!0),i.status==2?(o(),r("div",it,[l(v(q)),e[2]||(e[2]=k("导出成功 "))])):p("",!0),i.status==3?(o(),r("div",lt,[l(v(M)),e[3]||(e[3]=k("导出失败 ")),i.err_msg?(o(),Y(t,{key:0},{title:D(()=>[k(E(i.err_msg),1)]),default:D(()=>[l(v(A))]),_:2},1024)):p("",!0)])):p("",!0)],64)):p("",!0),g.key==="action"?(o(),r(z,{key:1},[i.is_over_7_days?(o(),r("span",_t,"--")):(o(),r("a",{key:0,onClick:u=>$(i)},"下载",8,dt))],64)):p("",!0)]),_:1},8,["data-source","pagination"])])])])}}},ue=F(ut,[["__scopeId","data-v-bb16126b"]]);export{ue as default};
