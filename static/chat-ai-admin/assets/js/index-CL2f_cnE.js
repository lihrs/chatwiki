import{e as u,w as O,M as d,N as f,k as p,W as i,S as P,a0 as F,F as I,$ as B,u as b,a6 as J}from"./vue-chunks-BjMuQ6KD.js";import{u as h}from"./index-BLNMWHkL.js";import{b as V,k as s,da as $}from"../../index-CfxQ5aRu.js";import{D as z,U as A}from"./index-DqFgAaLP.js";import"./index-DcUUFn-g.js";import{I as G}from"./Input-C5WaaE9Z.js";import{E as R}from"./Password-BCnVcrNJ.js";const S={class:"upload-box"},q={class:"mask-box"},W=["src"],k=3,H={__name:"index",props:{value:{type:[String,Array],default:""}},emits:["update:value"],setup(y,{emit:D}){const m=D,g=u([]),t=u([]),v=u(""),w=y;O(()=>w.value,e=>{t.value=e},{immediate:!0});const x=e=>{if(!(e.type==="image/jpeg"||e.type==="image/png"))return s.error("只支持JPG、PNG格式的图片"),!1;const o=e.size/1024<1024*2;return t.value.length>=k?s.error("最多上传三张图片"):o?(h({category:"library_image",file:e}).then(l=>{t.value.push(l.data.link),m("update:value",t.value)}),!1):(s.error("图片大小不能超过2M"),!1)},U=e=>{$({images:[e]})},M=e=>{t.value.splice(e,1)};let n=!1;const C=async e=>{if(t.value.length>=k)return s.error("最多上传三张图片");if(!(e.clipboardData&&e.clipboardData.items)){s.error("当前浏览器不支持粘贴上传操作！");return}if(!n)try{if(e.clipboardData||e.originalEvent||window.clipboardData){var r=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData,o=r.items;let l=null;for(let a=0;a<o.length;a++)if(o[a].type.indexOf("image")!==-1){l=o[a].getAsFile();break}v.value="",l?(e.preventDefault(),n=!0,h({category:"library_image",file:l}).then(a=>{n=!1,t.value.push(a.data.link),m("update:value",t.value)})):(error("请粘贴正确图片"),n=!1,v.value="")}}catch{n=!1,s.error("上传失败")}},c=u(null),L=()=>{c.value.focus()},E=()=>{c.value.blur()};function j(e){}return(e,r)=>{const o=G,l=A;return d(),f("div",S,[p(o,{class:"hidden-input",ref_key:"inputRef",ref:c,onPaste:C},null,512),i("div",{onMouseenter:L,onMouseleave:E},[p(l,{fileList:g.value,"onUpdate:fileList":r[1]||(r[1]=a=>g.value=a),name:"file",multiple:!1,"list-type":"picture","show-upload-list":!1,accept:".jpg,.png,.jpeg","before-upload":x,onDrop:j},{default:P(()=>[i("div",{class:"img-list-box",onClick:r[0]||(r[0]=F(()=>{},["stop"]))},[(d(!0),f(I,null,B(t.value,(a,_)=>(d(),f("div",{class:"img-item",key:_},[i("div",q,[p(b(R),{onClick:N=>U(a)},null,8,["onClick"]),p(b(z),{onClick:N=>M(_)},null,8,["onClick"])]),i("img",{src:a,alt:""},null,8,W)]))),128))]),i("p",{class:J(["upload-text",{"center-content":t.value.length==0}])}," 支持点击空白处、拖拽、粘贴图片，上传图片不得超过2M，仅支持png、jpg、jpeg格式 ",2)]),_:1},8,["fileList"])],32)])}}},ae=V(H,[["__scopeId","data-v-61b33e35"]]);export{ae as U};
