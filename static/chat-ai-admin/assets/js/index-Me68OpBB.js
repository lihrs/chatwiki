import{n as y,k as W,b as I,bu as Z,d as j,bv as G,bw as K,B as X,bx as ee}from"../../index-CfxQ5aRu.js";import{e as g,B as L,x as N,w as te,M as c,N as u,W as e,k as o,S as h,F as S,$ as F,u as E,Q as B,Y as x,Z as _,a4 as se,a7 as M,a1 as R,a2 as T,a5 as J}from"./vue-chunks-BjMuQ6KD.js";import{a as ae,_ as oe}from"./RadioButton-_iRIgmgW.js";import{R as ne}from"./dayjs-CE2mlg3S.js";import{_ as le}from"./index-Ch1-3QsQ.js";import{S as ie,_ as ce}from"./index-BuS_bfCI.js";import{_ as de}from"./index-D8Y0HnA5.js";import{_ as _e,a as re}from"./index-P3IiyBCy.js";import"./axios-Cm0UX6qg.js";import"./qs-DjdPq-RR.js";import"./crypto-js-BemCeW_6.js";import"./dayjs-DK4rpucX.js";import"./FormItemContext-DQ1b1ToO.js";import"./Checkbox-DQe8ZxR1.js";import"./index-BGu3mc-Q.js";import"./index-C3Es6Ui_.js";import"./colors-C9XVGyX_.js";import"./CheckOutlined-BLsT0eZM.js";import"./Trigger-Dy6Dc2CN.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./shallowequal-B6gQS78g.js";import"./index-D6-G2N0k.js";import"./move-BjmscfYf.js";import"./slide-BYYxYcj9.js";import"./index-CXSrVsd0.js";import"./DownOutlined-Gk0UBxct.js";import"./SearchOutlined-B7dGgS_P.js";import"./index-C38XHIGB.js";import"./useMaxLevel-C9fYQrQA.js";import"./collapseMotion-BH6Vz7El.js";import"./CaretDownFilled-CgS0_Akm.js";import"./index-BSl1-tWC.js";import"./responsiveObserve-X1b6Czsg.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-BLP-Fxny.js";import"./LeftOutlined-qzkQKHcF.js";import"./RightOutlined-BHf0iqSq.js";import"./index-D1MiuDW_.js";import"./index-CxLzlFzW.js";import"./index-CBvtIVuM.js";import"./dropdown-DsYo-imx.js";import"./index-Bx_z5H0C.js";import"./index-DPiF7UEG.js";import"./CaretDownOutlined-Qu8nVykI.js";import"./index-DcUUFn-g.js";import"./Input-C5WaaE9Z.js";import"./inputProps-D7qr__m5.js";import"./Search-DozVr2pE.js";import"./isPlainObject-xAKL-sfk.js";import"./TextArea-CN_AI7y7.js";import"./Password-BCnVcrNJ.js";const pe={class:"zm-date"},ue={class:"date-btn"},me={class:"date-content"},ve={__name:"date",props:{datekey:{type:String,default:"1"}},emits:["dateChange"],setup(f,{emit:D}){const $=f,m=g(1),s=D;let C=L([{label:"今日",value:!0,key:2,start_time:y().startOf("day"),end_time:y().endOf("day")},{label:"昨日",value:!1,key:3,start_time:y().subtract(1,"day").startOf("day"),end_time:y().startOf("day").subtract(1,"millisecond")},{label:"近7日",value:!1,key:4,start_time:y().subtract(6,"day").startOf("day"),end_time:y().endOf("day").subtract(1,"millisecond")}]);const t=g(null),n=g(null),r=g([]),l=a=>a>=y().subtract(0,"day"),i=()=>{let a=m.value,p=null;C.forEach(d=>{d.key==a&&(p=d)}),p?(r.value=[p.start_time,p.end_time],t.value=p.start_time.format("YYYY-MM-DD"),n.value=p.end_time.format("YYYY-MM-DD")):(r.value=[],t.value=null,n.value=null),O()},Y=a=>{const p=y(a[0]).startOf("day");if(y(a[1]).endOf("day").diff(p,"days")>29)r.value[0]=a[0].startOf("day"),r.value[1]=p.add(29,"days").endOf("day"),t.value=r.value[0].format("YYYY-MM-DD"),n.value=r.value[1].format("YYYY-MM-DD"),W.error("最多只能选择30天");else{const k=y(a[0]).startOf("day").format("YYYY-MM-DD"),w=y(a[1]).endOf("day").format("YYYY-MM-DD");r.value=a,t.value=k,n.value=w}m.value=1,O()},O=()=>{s("dateChange",{start_date:t.value,end_date:n.value})};return N(()=>{m.value=parseInt($.datekey),i()}),te(()=>$.datekey,(a,p)=>{m.value=parseInt($.datekey.split("-")[0]),i()}),(a,p)=>{const d=ae,k=oe,w=ne;return c(),u("div",pe,[e("div",ue,[o(k,{value:m.value,"onUpdate:value":p[0]||(p[0]=b=>m.value=b),onChange:i},{default:h(()=>[(c(!0),u(S,null,F(E(C),b=>(c(),B(d,{class:"date-btn-button",value:b.key,key:b.key},{default:h(()=>[x(_(b.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),e("div",me,[o(w,{value:r.value,"onUpdate:value":p[1]||(p[1]=b=>r.value=b),onChange:Y,format:"YYYY-MM-DD",disabledDate:l,allowClear:!1},null,8,["value"])])])}}},z=f=>(R("data-v-3949ccd6"),f=f(),T(),f),fe={class:"feedbacks-log-content"},be={class:"feedbacks-log-items"},he=z(()=>e("div",{class:"feedbacks-log-label"},[e("span",null,"问题 ")],-1)),ye={class:"feedbacks-log-item"},ke={class:"feedbacks-log-items"},ge=z(()=>e("div",{class:"feedbacks-log-label"},[e("span",null,"回答 ")],-1)),xe={class:"feedbacks-log-item"},$e={class:"feedbacks-log-items"},Ce=z(()=>e("div",{class:"feedbacks-log-label"},[e("span",null,"反馈 ")],-1)),Ye={class:"feedbacks-log-item"},we={key:0,class:"item-type"},De={key:1,class:"item-type"},Oe={class:"feedbacks-log-label"},Me={class:"feedbacks-log-item"},qe={class:"quotes-box"},ze={key:0,class:"document-content"},Se={key:1},Fe={class:"document-content"},Ie={class:"document-content"},je=["onClick"],Le={class:"feedbacks-log-items"},Ne=z(()=>e("div",{class:"feedbacks-log-label"},[e("span",null,"聊天模式 ")],-1)),Be={class:"feedbacks-log-item"},Re={key:0},Te={key:1},Ae={key:2},Qe={class:"feedbacks-log-items"},Ve=z(()=>e("div",{class:"feedbacks-log-label"},[e("span",null,"使用模型 ")],-1)),Ue={class:"feedbacks-log-item"},Ee={__name:"feedbacks-log-alert",setup(f,{expose:D}){const $=se(),m=g(!1),s=L({question:"",library:[],context_qa:[],cur_question:"",cur_answer:"",error:""}),C=()=>{m.value=!1},t=()=>{s.question="",s.library=[],s.context_qa=[],s.cur_question="",s.cur_answer="",s.error=""},n=l=>{t();for(const i in l)s[i]=l[i],i=="robot"&&(s[i]=JSON.parse(l[i])),i=="quotes"&&(s[i]=JSON.parse(l[i]));m.value=!0},r=l=>{$.push("/library/preview?id="+l.FileId)};return D({open:n}),(l,i)=>{const Y=j,O=le;return c(),B(O,{class:"feedbacks-log-alert",open:m.value,"onUpdate:open":i[0]||(i[0]=a=>m.value=a),title:"反馈详情",placement:"right",width:"746px",closable:!1},{extra:h(()=>[e("span",{class:"close-btn",onClick:C},[o(E(Z))])]),default:h(()=>[e("div",fe,[e("div",be,[he,e("div",ye,[e("p",null,_(s.question),1)])]),e("div",ke,[ge,e("div",xe,[e("p",null,_(s.answer),1)])]),e("div",$e,[Ce,e("div",Ye,[s.type=="1"?(c(),u("div",we,[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"like-active"}),x("点赞")])):M("",!0),s.type=="2"?(c(),u("div",De,[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"dislike-active"}),x("点踩")])):M("",!0),e("p",null,_(s.content),1)])]),(c(!0),u(S,null,F(s.quotes,(a,p)=>(c(),u("div",{class:"feedbacks-log-items",key:a.FileId},[e("div",Oe,[e("span",null,"参考内容"+_(p+1),1)]),e("div",Me,[e("div",qe,[a.Type==1?(c(),u("div",ze,_(a.Content),1)):a.Type==2?(c(),u("div",Se,[e("div",Fe,"Q："+_(a.Question),1),e("div",Ie,"A："+_(a.Answer),1)])):M("",!0),e("div",{class:"quotes-title",onClick:d=>r(a)},[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"quotes"}),x(_(a.FileName),1)],8,je)])])]))),128)),e("div",Le,[Ne,e("div",Be,[s.robot.chat_type=="1"?(c(),u("p",Re,"仅知识库")):s.robot.chat_type=="2"?(c(),u("p",Te,"直连")):s.robot.chat_type=="3"?(c(),u("p",Ae,"混合")):M("",!0)])]),e("div",Qe,[Ve,e("div",Ue,[e("p",null,_(s.robot.use_model)+"("+_(s.robot.corp_name)+")",1)])])])]),_:1},8,["open"])}}},Je=I(Ee,[["__scopeId","data-v-3949ccd6"]]),A=f=>(R("data-v-e51b0e6b"),f=f(),T(),f),He={class:"team-members-pages"},Pe={class:"total"},We=A(()=>e("div",{class:"label total-label"},"共计：",-1)),Ze={class:"total-num"},Ge={class:"set-model"},Ke=A(()=>e("div",{class:"label set-model-label"},"类型：",-1)),Xe={class:"set-model-body"},et={class:"set-date"},tt=A(()=>e("div",{class:"label set-date-label"},[e("span",null,"日期：")],-1)),st={class:"set-date-body"},at={class:"set-reset"},ot={class:"list-box"},nt={class:"user-box"},lt={class:"name-info"},it={class:"user-name"},ct={class:"user-info"},dt={key:0,class:"item-type"},_t={key:1,class:"item-type"},rt={class:"item-content"},pt={class:"item-date"},ut={__name:"qa-feedback",setup(f){const D=g(null),$=J(),m=g("1"),s=$.query,C=g([{key:"all",id:"all",label:"全部类型",title:"全部类型"},{key:"1",id:"1",label:"点赞",title:"点赞"},{key:"2",id:"2",label:"点踩",title:"点踩"}]),t=L({robot_id:s.id,page:1,size:20,total:0,type:"all",start_date:"",end_date:""}),n=d=>{t.start_date=d.start_date,t.end_date=d.end_date,Y()},r=async d=>{const k=await G({id:d.id});D.value.open(k.data)},l=()=>{t.type="all",t.start_date="",t.end_date="",m.value="1-"+Math.random()},i=d=>{t.page=d.current,t.size=d.pageSize,a()},Y=()=>{t.page=1,a()},O=g([]),a=()=>{let d={robot_id:t.robot_id,page:t.page,size:t.size,start_date:t.start_date,end_date:t.end_date};t.type!="all"&&(d.type=t.type),K(d).then(k=>{let w=k.data.list;w.forEach(b=>{b.create_time=b.create_time>0?y(b.create_time*1e3).format("YYYY-MM-DD HH:mm"):"--",b.content=b.content?b.content:"--"}),O.value=w,t.total=+k.data.total})},p=d=>{t.type=d,Y()};return N(()=>{}),(d,k)=>{const w=ie,b=ce,Q=X,V=de,q=_e,U=j,P=re;return c(),u("div",He,[o(V,{justify:"flex-end"},{default:h(()=>[e("div",Pe,[We,e("div",Ze,_(t.total)+"条",1)]),e("div",Ge,[Ke,e("div",Xe,[o(b,{value:t.type,"onUpdate:value":k[0]||(k[0]=v=>t.type=v),placeholder:"全部类型",onChange:p,style:{width:"130px"}},{default:h(()=>[(c(!0),u(S,null,F(C.value,v=>(c(),B(w,{key:v.key,value:v.id},{default:h(()=>[e("span",null,_(v.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),e("div",et,[tt,e("div",st,[o(ve,{onDateChange:n,datekey:m.value},null,8,["datekey"])])]),e("div",at,[o(Q,{onClick:l},{default:h(()=>[x("重置")]),_:1})])]),_:1}),e("div",ot,[o(P,{"data-source":O.value,pagination:t.total>t.size?{current:t.page,total:t.total,pageSize:t.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}:!1,onChange:i},{default:h(()=>[o(q,{title:"问答","data-index":"question",width:"411px"},{default:h(({record:v})=>[e("div",nt,[e("div",lt,[e("div",it,_(v.question),1),e("div",ct,_(v.answer),1)])])]),_:1}),o(q,{title:"回答反馈","data-index":"type",width:"160px"},{default:h(({record:v})=>[v.type=="1"?(c(),u("div",dt,[o(U,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),x("点赞")])):M("",!0),v.type=="2"?(c(),u("div",_t,[o(U,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),x("点踩")])):M("",!0)]),_:1}),o(q,{title:"反馈内容","data-index":"content",width:"264px"},{default:h(({record:v})=>[e("div",rt,_(v.content),1)]),_:1}),o(q,{title:"时间","data-index":"create_time",width:"200px"},{default:h(({record:v})=>[e("div",pt,_(v.create_time),1)]),_:1}),o(q,{title:"操作","data-index":"action",width:"88px"},{default:h(({record:v})=>[o(V,{gap:16,class:"action-box"},{default:h(()=>[o(Q,{type:"link",onClick:Ct=>r(v)},{default:h(()=>[x("查看详情")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),o(Je,{ref_key:"feedbacksLogAlertRef",ref:D},null,512)])}}},mt=I(ut,[["__scopeId","data-v-e51b0e6b"]]),H=f=>(R("data-v-80174709"),f=f(),T(),f),vt={class:"user-model-page"},ft=H(()=>e("div",{class:"page-title"},"数据概览",-1)),bt={class:"overview-box"},ht={class:"item-info"},yt={class:"item-icon-content item-like"},kt={class:"item-icon-content item-dislike"},gt=H(()=>e("div",{class:"page-title"},"反馈记录",-1)),xt={class:"list-wrapper"},$t={__name:"index",setup(f){const $=J().query,m=g([]),s=t=>{let n={title:"",id:0};switch(t){case"today_stats":n.title="今日",n.id=1;break;case"yesterday_stats":n.title="昨日",n.id=2;break;case"week_stats":n.title="近7日",n.id=3;break;case"total_stats":n.title="总计",n.id=4;break}return n},C=()=>{let t={robot_id:$.id};ee(t).then(n=>{const r=[];for(const l in n.data){const i=n.data[l];r.push({key:l,dislike:i.dislike,like_count:i.like_count,titleObj:s(l)})}m.value=r.sort((l,i)=>l.titleObj.id-i.titleObj.id)})};return N(()=>{C()}),(t,n)=>{const r=j;return c(),u("div",vt,[ft,e("div",bt,[(c(!0),u(S,null,F(m.value,l=>(c(),u("div",{class:"item-box",key:l.titleObj.id},[e("div",ht,_(l.titleObj.title),1),e("div",yt,[o(r,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),x(_(l.like_count),1)]),e("div",kt,[o(r,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),x(_(l.dislike),1)])]))),128))]),gt,e("div",xt,[o(mt)])])}}},$s=I($t,[["__scopeId","data-v-80174709"]]);export{$s as default};
