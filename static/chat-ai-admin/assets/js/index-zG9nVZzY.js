import{b as F,k as U,M as I,ac as Y,ad as j,ae as G,af as H,B as J,Z as K,E as X,ag as oo}from"../../index-CfxQ5aRu.js";import{_ as eo}from"./index-DcUUFn-g.js";import{I as E}from"./Input-C5WaaE9Z.js";import{e as _,B as M,M as L,Q as R,S as r,W as n,k as l,N as O,$ as to,Z as B,F as ao,a1 as N,a2 as q,aa as A,u as no,Y as lo,a7 as so}from"./vue-chunks-BjMuQ6KD.js";import{S as io,_ as co}from"./index-BuS_bfCI.js";import{_ as z,F as P}from"./index-xqeVJHPz.js";import{_ as W}from"./TextArea-CN_AI7y7.js";import{_ as ro}from"./index-Capld-U4.js";import{a as po}from"./index-P3IiyBCy.js";import"./axios-Cm0UX6qg.js";import"./qs-DjdPq-RR.js";import"./crypto-js-BemCeW_6.js";import"./dayjs-DK4rpucX.js";import"./FormItemContext-DQ1b1ToO.js";import"./index-D6-G2N0k.js";import"./Search-DozVr2pE.js";import"./SearchOutlined-B7dGgS_P.js";import"./isPlainObject-xAKL-sfk.js";import"./inputProps-D7qr__m5.js";import"./Password-BCnVcrNJ.js";import"./Trigger-Dy6Dc2CN.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./slide-BYYxYcj9.js";import"./index-CXSrVsd0.js";import"./CheckOutlined-BLsT0eZM.js";import"./DownOutlined-Gk0UBxct.js";import"./move-BjmscfYf.js";import"./responsiveObserve-X1b6Czsg.js";import"./collapseMotion-BH6Vz7El.js";import"./index-D1MiuDW_.js";import"./colors-C9XVGyX_.js";import"./QuestionCircleOutlined-Deh272L3.js";import"./index-C38XHIGB.js";import"./useMaxLevel-C9fYQrQA.js";import"./CaretDownFilled-CgS0_Akm.js";import"./index-BSl1-tWC.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-BLP-Fxny.js";import"./LeftOutlined-qzkQKHcF.js";import"./RightOutlined-BHf0iqSq.js";import"./index-CxLzlFzW.js";import"./Checkbox-DQe8ZxR1.js";import"./index-CBvtIVuM.js";import"./dropdown-DsYo-imx.js";import"./index-Bx_z5H0C.js";import"./shallowequal-B6gQS78g.js";import"./index-DPiF7UEG.js";import"./RadioButton-_iRIgmgW.js";import"./CaretDownOutlined-Qu8nVykI.js";const Z=d=>(N("data-v-bac76e5e"),d=d(),q(),d),uo={class:"add-domain-form"},_o={class:"form-item"},mo=Z(()=>n("div",{class:"form-label"},"配置域名：",-1)),fo={class:"form-input-box"},vo=Z(()=>n("div",{class:"form-tip"}," 配置域名只需要填写域名部分,比如kf.xxx.com.您可以根据需求选择http或https协议 ",-1)),ho={__name:"add-domain-modal ",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(d,{expose:v,emit:h}){const S=d;function x(t){return t=t.replace("。",".").toLowerCase(),t=t.replace(/\/$/,""),t=t.replace(/(^\s*)|(\s*$)/g,""),t=t.replace("http://",""),t=t.replace("https://",""),t}const k=h,a=_(!1),g=_("添加自定义域名"),p=_([{label:"http",value:"http:"},{label:"https",value:"https:"}]),e=M({id:null,url:"",protocol:"http:"}),$=()=>{try{if(e.url){const t=new URL(e.url);t.protocol=="http:"||t.protocol=="https:"?e.protocol=t.protocol:e.protocol="http:",e.url=t.hostname}}catch{e.url=x(e.url)}},w=()=>{if(!e.url)return U.error("请输入配置域名");e.url=x(e.url),k("ok",{...e})};return v({open:t=>{t?(e.url=t.url,e.protocol=t.protocol,e.id=t.id,g.value="修改自定义域名"):(e.id=null,e.url="",e.protocol="http:",g.value="添加自定义域名"),a.value=!0},close:()=>{a.value=!1}}),(t,u)=>{const b=io,m=co,o=E,i=eo,y=I;return L(),R(y,{open:a.value,"onUpdate:open":u[2]||(u[2]=f=>a.value=f),title:g.value,onOk:w,confirmLoading:S.confirmLoading},{default:r(()=>[n("div",uo,[n("div",_o,[mo,n("div",fo,[l(i,{compact:"",style:{width:"100%"}},{default:r(()=>[l(m,{value:e.protocol,"onUpdate:value":u[0]||(u[0]=f=>e.protocol=f),style:{width:"20%"}},{default:r(()=>[(L(!0),O(ao,null,to(p.value,f=>(L(),R(b,{value:f.value,key:f.value},{default:r(()=>[n("span",null,B(f.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),l(o,{value:e.url,"onUpdate:value":u[1]||(u[1]=f=>e.url=f),style:{width:"80%"},placeholder:"请输入配置域名",onBlur:$},null,8,["value"])]),_:1})])]),vo])]),_:1},8,["open","title","confirmLoading"])}}},ko=F(ho,[["__scopeId","data-v-bac76e5e"]]),go={class:"upload-ssl-form"},yo={class:"domain"},Lo={__name:"upload-ssl",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(d,{expose:v,emit:h}){const S=h,x=d,k=_(),a=M({id:"",domain:"",ssl_certificate:"",ssl_certificate_key:""}),g={ssl_certificate:[{required:!0,message:"请输入证书文件(.crt或.pem)"}],ssl_certificate_key:[{required:!0,message:"请输入私钥文件(.key)"}]},p=_(!1),e=c=>{a.id=c.id,a.domain=c.url,a.ssl_certificate="",a.ssl_certificate_key="",p.value=!0},$=()=>{p.value=!1},w=()=>{k.value.validate().then(()=>{S("ok",A(a))}).catch(c=>{})};return v({open:e,close:$}),(c,s)=>{const t=W,u=z,b=P,m=I;return L(),R(m,{open:p.value,"onUpdate:open":s[2]||(s[2]=o=>p.value=o),title:"上传证书",onOk:w,confirmLoading:x.confirmLoading},{default:r(()=>[n("div",go,[n("div",yo,"域名："+B(c.domain),1),l(b,{ref_key:"formRef",ref:k,model:a,rules:g,autocomplete:"off",layout:"vertical"},{default:r(()=>[l(u,{label:"证书文件(.crt或.pem)",name:"ssl_certificate"},{default:r(()=>[l(t,{rows:5,value:a.ssl_certificate,"onUpdate:value":s[0]||(s[0]=o=>a.ssl_certificate=o)},null,8,["value"])]),_:1}),l(u,{label:"私钥文件(.key)",name:"ssl_certificate_key"},{default:r(()=>[l(t,{rows:5,value:a.ssl_certificate_key,"onUpdate:value":s[1]||(s[1]=o=>a.ssl_certificate_key=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},xo=F(Lo,[["__scopeId","data-v-e93ea490"]]),bo={class:"upload-ssl-form"},So={__name:"upload-validation-file",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(d,{expose:v,emit:h}){const S=h,x=d,k=_(),a=M({id:"",file_name:"",file_content:""}),g={file_name:[{required:!0,message:"请输入文件名"}],file_content:[{required:!0,message:"请输入文件内容"}]},p=_(!1),e=c=>{a.id=c.id,a.file_name="",a.file_content="",p.value=!0},$=()=>{p.value=!1},w=()=>{k.value.validate().then(()=>{S("ok",A(a))}).catch(c=>{})};return v({open:e,close:$}),(c,s)=>{const t=E,u=z,b=W,m=P,o=I;return L(),R(o,{open:p.value,"onUpdate:open":s[2]||(s[2]=i=>p.value=i),title:"上传证书",onOk:w,confirmLoading:x.confirmLoading},{default:r(()=>[n("div",bo,[l(m,{ref_key:"formRef",ref:k,model:a,rules:g,autocomplete:"off",layout:"vertical"},{default:r(()=>[l(u,{label:"文件名（含文件后缀，比如 mzkAzOpb6L.txt）",name:"file_name"},{default:r(()=>[l(t,{value:a.file_name,"onUpdate:value":s[0]||(s[0]=i=>a.file_name=i)},null,8,["value"])]),_:1}),l(u,{label:"文件内容",name:"file_content"},{default:r(()=>[l(b,{rows:5,value:a.file_content,"onUpdate:value":s[1]||(s[1]=i=>a.file_content=i)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},$o=F(So,[["__scopeId","data-v-a24b293f"]]),Q=d=>(N("data-v-2e1d3b14"),d=d(),q(),d),wo={class:"domain-page"},Co={class:"page-container"},Uo=Q(()=>n("div",{class:"page-title"},"自定义域名设置",-1)),Oo={class:"domain-tips"},Ro=Q(()=>n("div",{class:"tip-text"},[n("div",null,"将域名解析到ChatWiki服务器，可以通过自由域名访问对外文档和对外服务web APP。"),n("div",null," 1、域名解析请参考帮助文档，目前只支持阿里云备案的域名，将域名cname到wiki.aishipinhao.com。 "),n("div",null,"2、如需使用https,请在添加域名后，上传证书文件，包括公钥和私钥(ky文件)。")],-1)),Bo={class:"list-action-box"},Fo={class:"list-box"},Io={key:0},Do={key:1},Vo={key:2,class:"action-box"},Mo=["onClick"],Eo=["onClick"],No=["onClick"],qo=["onClick"],Ao={__name:"index",setup(d){const v=_(null),h=_(!1),S=[{title:"域名",dataIndex:"url",key:"url"},{title:"证书",dataIndex:"is_upload",key:"is_upload",width:300},{title:"操作",key:"action"}],x=()=>{v.value.open()},k=o=>{let i={id:o.id,url:o.url,protocol:"http:"};try{const y=new URL(o.url);y.protocol=="http:"||y.protocol=="https:"?i.protocol=y.protocol:i.protocol="http:",i.url=y.hostname}catch{}v.value.open(i)},a=o=>{h.value=!0;let i=`${o.protocol}//${o.url}`;Y({url:i,id:o.id||void 0}).then(()=>{U.success("保存成功"),h.value=!1,v.value.close(),m()}).catch(()=>{h.value=!1})},g=o=>{I.confirm({title:"删除",icon:l(X),content:"确定要删除吗？",onOk(){oo({id:o.id}).then(()=>{U.success("删除成功"),m()})},onCancel(){}})},p=_(null),e=_(!1),$=o=>{p.value.open(o)},w=o=>{e.value=!0;let i={id:o.id,ssl_certificate:o.ssl_certificate,ssl_certificate_key:o.ssl_certificate_key};j(i).then(()=>{e.value=!1,p.value.close(),U.success("上传成功"),m()}).catch(()=>{e.value=!1})},c=_(null),s=_(!1),t=o=>{c.value.open(o)},u=o=>{s.value=!0,G({...o}).then(()=>{s.value=!1,c.value.close(),U.success("上传成功"),m()}).catch(()=>{s.value=!1})},b=_([]),m=async()=>{const o=await H();b.value=o.data||[]};return m(),(o,i)=>{const y=ro,f=J,T=po;return L(),O("div",wo,[n("div",Co,[Uo,n("div",Oo,[l(y,{type:"info","show-icon":""},{icon:r(()=>[n("div",null,[l(no(K),{style:{"font-size":"16px"}})])]),description:r(()=>[Ro]),_:1})]),n("div",Bo,[n("div",null,[l(f,{type:"primary",onClick:x},{default:r(()=>[lo("添加自定义域名")]),_:1})])]),n("div",Fo,[l(T,{columns:S,"data-source":b.value},{bodyCell:r(({column:D,record:C})=>[D.key==="url"?(L(),O("span",Io,B(C.url),1)):D.key==="is_upload"?(L(),O("span",Do,B(C.is_upload?"已上传":"未上传"),1)):D.key==="action"?(L(),O("span",Vo,[n("a",{class:"action-btn",onClick:V=>$(C)},"上传证书",8,Mo),n("a",{class:"action-btn",onClick:V=>t(C)},"上传验证文件",8,Eo),n("a",{class:"action-btn",onClick:V=>k(C)},"编辑",8,No),n("a",{class:"action-btn",onClick:V=>g(C)},"删除",8,qo)])):so("",!0)]),_:1},8,["data-source"])])]),l(ko,{ref_key:"addDomainModalRef",ref:v,confirmLoading:h.value,onOk:a},null,8,["confirmLoading"]),l(xo,{ref_key:"uploadSSLRef",ref:p,"confirm-loading":e.value,onOk:w},null,8,["confirm-loading"]),l($o,{ref_key:"uploadValidationFileRef",ref:c,"confirm-loading":s.value,onOk:u},null,8,["confirm-loading"])])}}},Ee=F(Ao,[["__scopeId","data-v-2e1d3b14"]]);export{Ee as default};
