import{b as A,k as I,bL as M,d as P,B as z,dj as E,b$ as T}from"../../index-CptKfSUC.js";import{d as g,z as y,w as D,q as k,N as B,O as F,X as i,j as o,U as n,W as h,u as L,a0 as G,Z as W,G as C,b as X,a3 as Y}from"./vue-chunks-BRsu9_To.js";import{C as Z}from"./config-page-menu-BZFeD0pM.js";import{A as H}from"./avatar-input-Db9TqF7X.js";import{F as w,_ as J}from"./index-BdXFo1Yi.js";import"./index-CrGpUfGH.js";import{I as K}from"./Input-BFAHe0DY.js";import{_ as Q}from"./TextArea-DZQUCnMF.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-BMHN_ZHD.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-B5sPmMFr.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-D4Zk8vlN.js";import"./index-CreR3MX_.js";import"./index-SQEG4xim.js";import"./colors-CB658H7g.js";import"./PlusOutlined-BR72fkTP.js";import"./index-hJ3NDJJa.js";import"./Password-BJfMc7qR.js";import"./inputProps-DCrFQ5HR.js";import"./DownloadOutlined-H1KeEsM2.js";import"./CheckOutlined-CR4N2RZP.js";import"./FormItemContext-gpTH9eHq.js";import"./isPlainObject-iUjGA7o2.js";import"./responsiveObserve-BhysygCB.js";import"./QuestionCircleOutlined-DXvm_sAY.js";import"./index-TvkCt6Hp.js";import"./Search-BuYDKTKT.js";import"./SearchOutlined-BkABIbhb.js";const aa={class:"form-box"},ea={class:"form-box-header"},ta={class:"form-box-label"},oa={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(d,{emit:u}){I.config({duration:2});const f=u,r=d,s=g(1),c=w.useForm,v=g(!1),m=M,a=y({type:s.value,access_rights:0,library_name:"",library_intro:"",use_model:"",avatar:m,avatar_file:"",is_offline:!1,model_config_id:""}),_=y({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),b=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:U,validateInfos:x}=c(a,_),$=()=>{U().then(()=>{j()}).catch(e=>{})},j=()=>{let e=C(a);f("submit",e)},N=e=>{v.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:m,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return D(r.value,e=>{N({...e})}),k(()=>{}),(e,t)=>{const O=P,R=K,p=J,S=Q,q=z,V=w;return F(),B("div",aa,[i("div",ea,[i("div",ta,[o(O,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),t[3]||(t[3]=i("span",{class:"form-box-label-text"},"知识库信息",-1))]),t[4]||(t[4]=i("div",null,null,-1))]),o(V,{"label-col":{span:6},style:{width:"600px"}},{default:n(()=>[o(p,h({ref:"name",label:"知识库名称"},L(x).library_name),{default:n(()=>[o(R,{value:a.library_name,"onUpdate:value":t[0]||(t[0]=l=>a.library_name=l),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),o(p,{label:"知识库简介"},{default:n(()=>[o(S,{value:a.library_intro,"onUpdate:value":t[1]||(t[1]=l=>a.library_intro=l),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),o(p,h({ref:"name",label:"知识库封面"},L(x).avatar),{default:n(()=>[o(H,{value:a.avatar,"onUpdate:value":t[2]||(t[2]=l=>a.avatar=l),onChange:b},null,8,["value"]),t[5]||(t[5]=i("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[5]},16),o(p,{"wrapper-col":{offset:6,span:8}},{default:n(()=>[o(q,{type:"primary",style:{"margin-left":"8px"},loading:d.saveLoading,onClick:G($,["prevent"])},{default:n(()=>t[6]||(t[6]=[W("保存")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})])}}},ra=A(oa,[["__scopeId","data-v-377531e7"]]),ia={class:"add-library-page"},sa={class:"page-container"},na={class:"form-box-wrapper"},la={__name:"index",setup(d){const u=Y(),f=X(()=>u.query.library_id),r=y({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),s=g(!1),c=a=>{Object.assign(r,a),s.value=!0,v().then(()=>{s.value=!1}).catch(()=>{s.value=!1})},v=async()=>{let a={...C(r)};delete a.library_key,a.avatar_file?(a.avatar=a.avatar_file,delete a.avatar_file):(delete a.avatar,delete a.avatar_file),await T(a),I.success("修改成功")},m=()=>{E({id:f.value}).then(a=>{Object.assign(r,a.data)})};return k(()=>{m()}),(a,_)=>(F(),B("div",ia,[o(Z),i("div",sa,[i("div",na,[o(ra,{value:r,"onUpdate:value":_[0]||(_[0]=b=>r=b),saveLoading:s.value,onSubmit:c},null,8,["value","saveLoading"])])])]))}},Ta=A(la,[["__scopeId","data-v-d762895e"]]);export{Ta as default};
