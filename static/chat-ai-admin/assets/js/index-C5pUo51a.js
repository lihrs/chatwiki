import{b as L,di as U,am as w,B as q,M as E,b_ as J,k as R}from"../../index-CvfGQnmW.js";import{b as z,a3 as j,d as r,z as A,q as F,N as G,j as l,X as b,U as m,O as _,S as D,a6 as h,Z as s,u as C,G as X}from"./vue-chunks-BRsu9_To.js";import{C as P}from"./config-page-menu-GpmoLGlQ.js";import{C as V}from"./index-D4B36xuZ.js";import{F as Z,_ as $}from"./index-CeLDnZbi.js";import{_ as H}from"./index-ChS1NVDw.js";import{_ as K}from"./index-B-ykUzgY.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-Cn6_tPQQ.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-C5a0DMKm.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-vrDadJH3.js";import"./index-DaOSj_2K.js";import"./index-CiT4vUhP.js";import"./isPlainObject-C_BoBcyP.js";import"./responsiveObserve-4wudV-W8.js";import"./QuestionCircleOutlined-DsT-V90y.js";import"./FormItemContext-CFzzmp00.js";import"./colors-Cy2bPHOW.js";const Q={class:"ai-config-page"},W={class:"page-container"},Y={class:"ai-config-form"},ee={__name:"index",setup(ae){const M=j(),x=z(()=>M.query.library_id),u=r(),d=r(!1);let i={};const a=A({library_name:"",library_intro:"",ai_summary:"",ai_summary_model:"",access_rights:"",model_config_id:"",use_model:"",use_model_icon:"",use_model_name:"",use_model_switch:"",statistics_set:"",summary_model_icon:"",summary_model_name:"",summary_model_config_id:""}),c=["azure","ollama","xinference","openaiAgent"],p=["azure"],f=r(""),y=r(""),N=e=>{a.use_model=c.includes(e.rawData.model_define)&&e.rawData.deployment_name?e.rawData.deployment_name:e.rawData.name,a.use_model_icon=e.icon,a.use_model_name=e.use_model_name,a.model_config_id=e.rawData.id,f.value=e.rawData.model_define},O=e=>{a.ai_summary_model=c.includes(e.rawData.model_define)&&e.rawData.deployment_name?e.rawData.deployment_name:e.rawData.name,a.summary_model_icon=e.icon,a.summary_model_name=e.summary_model_name,a.summary_model_config_id=e.rawData.id,y.value=e.rawData.model_define},S=async()=>{try{await u.value.validate(),i.use_model!=a.use_model?E.confirm({title:"确定切换模型为"+a.use_model+"吗？",content:"切换模型后，文档会重新向量化，会消耗token",okText:"确定",cancelText:"取消",onOk(){g()}}):g()}catch(e){console.error("表单验证失败:",e)}},g=()=>{let e={...X(a)};p.indexOf(f.value)>-1&&(e.use_model="默认"),p.indexOf(y.value)>-1&&(e.ai_summary_model="默认"),d.value=!0,J(e).then(()=>{R.success("保存成功"),d.value=!1,i=JSON.parse(JSON.stringify(e))}).catch(()=>{d.value=!1})},B=()=>{U({id:x.value}).then(e=>{let o=e.data||{};o.use_model=o.use_model||void 0,o.ai_summary_model=o.ai_summary_model||void 0,i=JSON.parse(JSON.stringify(o)),Object.assign(a,o)})};return F(()=>{B()}),(e,o)=>{const k=K,v=H,t=$,T=q,I=Z;return _(),G("div",Q,[l(P),b("div",W,[b("div",Y,[l(I,{ref_key:"formRef",ref:u,model:a,"label-col":{span:2},"wrapper-col":{span:8}},{default:m(()=>[l(t,null,{label:m(()=>[o[5]||(o[5]=s(" 嵌入  ")),l(k,null,{title:m(()=>o[4]||(o[4]=[s("开启嵌入功能后，才能在机器人中关联本知识库。")])),default:m(()=>[l(C(w))]),_:1})]),default:m(()=>[l(v,{checked:a.use_model_switch,"onUpdate:checked":o[0]||(o[0]=n=>a.use_model_switch=n),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),a.use_model_switch==1?(_(),D(t,{key:0,label:"嵌入模型",name:"use_model",rules:[{required:!0,message:"请选择嵌入模型"}]},{default:m(()=>[l(V,{modelValue:a.use_model,"onUpdate:modelValue":o[1]||(o[1]=n=>a.use_model=n),placeholder:"请选择嵌入模型","label-key":"use_model_name","value-key":"value",modelType:"TEXT EMBEDDING","model-config-id":a.model_config_id,onChange:N},null,8,["modelValue","model-config-id"])]),_:1})):h("",!0),l(t,null,{label:m(()=>[o[7]||(o[7]=s(" AI智能总结  ")),l(k,null,{title:m(()=>o[6]||(o[6]=[s("开启后，搜索知识库时，由大模型自动总结文档，并给出总结后的结果")])),default:m(()=>[l(C(w))]),_:1})]),default:m(()=>[l(v,{checked:a.ai_summary,"onUpdate:checked":o[2]||(o[2]=n=>a.ai_summary=n),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),a.ai_summary==1?(_(),D(t,{key:1,label:"总结模型",name:"ai_summary_model",rules:[{required:!0,message:"请选择总结模型"}]},{default:m(()=>[l(V,{modelValue:a.ai_summary_model,"onUpdate:modelValue":o[3]||(o[3]=n=>a.ai_summary_model=n),placeholder:"请选择总结模型","label-key":"summary_model_name","value-key":"value",modelType:"LLM","model-config-id":a.summary_model_config_id,onChange:O},null,8,["modelValue","model-config-id"])]),_:1})):h("",!0),l(t,{"wrapper-col":{offset:2,span:8}},{default:m(()=>[l(T,{type:"primary",loading:d.value,onClick:S},{default:m(()=>o[8]||(o[8]=[s("保存")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},8,["model"])])])])}}},Me=L(ee,[["__scopeId","data-v-cb156714"]]);export{Me as default};
