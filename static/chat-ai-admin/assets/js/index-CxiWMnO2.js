import{K as Ae,p as $e,q as Q,t as ua,v as _a,w as Ft,x as Ze,P as je,y as pa,z as Ut,C as va,F as ut,G as ma,H as fa,I as ha,J as ga,L as Et,N as ya,O as _t,Q as ba,S as ka,T as wa,U as pt,b as he,h as xa,V as Ca,k as oe,M as fe,W as Ht,n as Ve,X as Sa,Y as kt,r as $a,Z as Bt,E as Je,B as et,$ as Ia,a0 as zt,a1 as La,a2 as Da,a3 as Oa,a4 as Ta,d as Pa,a5 as Va,a6 as Ea,a7 as Ra,a8 as Ka}from"../../index-CfxQ5aRu.js";import{d as Na,p as Ma,f as wt,e as C,b as G,w as Re,z as Xe,s as ye,aa as we,k as t,j as xt,af as Ee,ag as Aa,M as y,N as D,F as _e,$ as qe,a6 as Wt,Z as j,u as W,S as l,Q as se,W as r,a1 as Ke,a2 as Ne,B as pe,V as ge,Y as O,a7 as te,a0 as Ge,x as ja}from"./vue-chunks-BjMuQ6KD.js";import{_ as Fa}from"./cu-scroll-ClwfOnpN.js";import{g as Yt}from"./index-W8wCYhw3.js";import{g as Jt}from"./index-BERrfq5W.js";import{v as qt}from"./validate-8MtiUsxW.js";import{F as Ie,_ as tt}from"./index-xqeVJHPz.js";import{P as at}from"./PlusOutlined-xiVHYVI8.js";import{_ as Ua}from"./index-DqFgAaLP.js";import{d as ht}from"./role_avatar-DL0r08JY.js";import{g as lt,b as Ha,a as Qt,s as Ba,d as za,c as Wa,e as Ya,f as Ja,h as qa}from"./index-OIK33vUW.js";import"./index-DcUUFn-g.js";import{I as Ct}from"./Input-C5WaaE9Z.js";import{u as Qa,a as Ga,b as Xa,c as Za,d as el,t as Rt,B as tl,e as al,f as ll,g as nl,S as Gt,_ as Xt}from"./index-BuS_bfCI.js";import{T as sl,g as ol,r as il,_ as rl}from"./index-C38XHIGB.js";import{c as dl,a as gt,u as cl}from"./useMaxLevel-C9fYQrQA.js";import{u as Kt,C as vt}from"./CheckOutlined-BLsT0eZM.js";import{u as ul,F as _l}from"./FormItemContext-DQ1b1ToO.js";import{g as pl,a as vl}from"./index-D6-G2N0k.js";import{g as ml}from"./index-BSl1-tWC.js";import"./index-DPiF7UEG.js";import{R as Zt,_ as St,a as fl}from"./RadioButton-_iRIgmgW.js";import{D as hl}from"./dayjs-CE2mlg3S.js";import{_ as ea,E as gl}from"./Password-BCnVcrNJ.js";import{_ as ta}from"./index-DJgb7gGJ.js";import{_ as $t,a as nt}from"./index-P3IiyBCy.js";import{C as yl}from"./CaretDownOutlined-Qu8nVykI.js";import{M as bl}from"./MoreOutlined-DLVu09bY.js";import{_ as It}from"./Search-DozVr2pE.js";import{_ as aa,M as la}from"./index-Bx_z5H0C.js";import"./index-CBvtIVuM.js";import{D as na}from"./dropdown-DsYo-imx.js";import{_ as sa}from"./index-D1MiuDW_.js";import{U as kl}from"./UserOutlined-kSSEuP4H.js";import{E as wl}from"./EditOutlined-COZMcG4o.js";import{D as xl}from"./DownOutlined-Gk0UBxct.js";import{_ as Cl}from"./index-C-uK-k7U.js";import{Q as mt}from"./QuestionCircleOutlined-Deh272L3.js";import{_ as Sl}from"./index-BCGkuM1J.js";import{_ as Lt}from"./index-D8Y0HnA5.js";import{_ as $l}from"./TextArea-CN_AI7y7.js";import{C as Il,_ as Ll}from"./index-CxLzlFzW.js";import{_ as Dl,a as Ol}from"./index-CeT0BIQm.js";import"./axios-Cm0UX6qg.js";import"./qs-DjdPq-RR.js";import"./crypto-js-BemCeW_6.js";import"./dayjs-DK4rpucX.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./Trigger-Dy6Dc2CN.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-xAKL-sfk.js";import"./responsiveObserve-X1b6Czsg.js";import"./collapseMotion-BH6Vz7El.js";import"./DownloadOutlined-BrqGknZq.js";import"./inputProps-D7qr__m5.js";import"./slide-BYYxYcj9.js";import"./index-CXSrVsd0.js";import"./SearchOutlined-B7dGgS_P.js";import"./move-BjmscfYf.js";import"./CaretDownFilled-CgS0_Akm.js";import"./Checkbox-DQe8ZxR1.js";import"./index-BGu3mc-Q.js";import"./index-C3Es6Ui_.js";import"./colors-C9XVGyX_.js";import"./shallowequal-B6gQS78g.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-BLP-Fxny.js";import"./LeftOutlined-qzkQKHcF.js";import"./RightOutlined-BHf0iqSq.js";function Tl(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Pl(e){const{label:_,value:g,children:s}=e||{},i=g||"value";return{_title:_?[_]:["title","label"],value:i,key:i,children:s||"children"}}function yt(e){return e.disabled||e.disableCheckbox||e.checkable===!1}function Vl(e,_){const g=[];function s(i){i.forEach(n=>{g.push(n[_.value]);const o=n[_.children];o&&s(o)})}return s(e),g}function Nt(e){return e==null}const oa=Symbol("TreeSelectContextPropsKey");function El(e){return Ma(oa,e)}function Rl(){return Na(oa,{})}const Kl={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Nl=wt({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(e,_){let{slots:g,expose:s}=_;const i=Qa(),n=Ga(),o=Rl(),a=C(),w=Xa(()=>o.treeData,[()=>i.open,()=>o.treeData],d=>d[0]),u=G(()=>{const{checkable:d,halfCheckedKeys:p,checkedKeys:R}=n;return d?{checked:R,halfChecked:p}:null});Re(()=>i.open,()=>{Xe(()=>{var d;i.open&&!i.multiple&&n.checkedKeys.length&&((d=a.value)===null||d===void 0||d.scrollTo({key:n.checkedKeys[0]}))})},{immediate:!0,flush:"post"});const f=G(()=>String(i.searchValue).toLowerCase()),$=d=>f.value?String(d[n.treeNodeFilterProp]).toLowerCase().includes(f.value):!1,k=ye(n.treeDefaultExpandedKeys),S=ye(null);Re(()=>i.searchValue,()=>{i.searchValue&&(S.value=Vl(we(o.treeData),we(o.fieldNames)))},{immediate:!0});const P=G(()=>n.treeExpandedKeys?n.treeExpandedKeys.slice():i.searchValue?S.value:k.value),h=d=>{var p;k.value=d,S.value=d,(p=n.onTreeExpand)===null||p===void 0||p.call(n,d)},v=d=>{d.preventDefault()},c=(d,p)=>{let{node:R}=p;var N,F;const{checkable:x,checkedKeys:L}=n;x&&yt(R)||((N=o.onSelect)===null||N===void 0||N.call(o,R.key,{selected:!L.includes(R.key)}),i.multiple||(F=i.toggleOpen)===null||F===void 0||F.call(i,!1))},V=C(null),E=G(()=>n.keyEntities[V.value]),H=d=>{V.value=d};return s({scrollTo:function(){for(var d,p,R=arguments.length,N=new Array(R),F=0;F<R;F++)N[F]=arguments[F];return(p=(d=a.value)===null||d===void 0?void 0:d.scrollTo)===null||p===void 0?void 0:p.call(d,...N)},onKeydown:d=>{var p;const{which:R}=d;switch(R){case Ae.UP:case Ae.DOWN:case Ae.LEFT:case Ae.RIGHT:(p=a.value)===null||p===void 0||p.onKeydown(d);break;case Ae.ENTER:{if(E.value){const{selectable:N,value:F}=E.value.node||{};N!==!1&&c(null,{node:{key:V.value},selected:!n.checkedKeys.includes(F)})}break}case Ae.ESC:i.toggleOpen(!1)}},onKeyup:()=>{}}),()=>{var d;const{prefixCls:p,multiple:R,searchValue:N,open:F,notFoundContent:x=(d=g.notFoundContent)===null||d===void 0?void 0:d.call(g)}=i,{listHeight:L,listItemHeight:b,virtual:T,dropdownMatchSelectWidth:M,treeExpandAction:B}=o,{checkable:X,treeDefaultExpandAll:q,treeIcon:m,showTreeIcon:Z,switcherIcon:xe,treeLine:A,loadData:J,treeLoadedKeys:ie,treeMotion:K,onTreeLoad:ee,checkedKeys:ce}=n;if(w.value.length===0)return t("div",{role:"listbox",class:`${p}-empty`,onMousedown:v},[x]);const Ce={fieldNames:o.fieldNames};return ie&&(Ce.loadedKeys=ie),P.value&&(Ce.expandedKeys=P.value),t("div",{onMousedown:v},[E.value&&F&&t("span",{style:Kl,"aria-live":"assertive"},[E.value.node.value]),t(sl,$e($e({ref:a,focusable:!1,prefixCls:`${p}-tree`,treeData:w.value,height:L,itemHeight:b,virtual:T!==!1&&M!==!1,multiple:R,icon:m,showIcon:Z,switcherIcon:xe,showLine:A,loadData:N?null:J,motion:K,activeKey:V.value,checkable:X,checkStrictly:!0,checkedKeys:u.value,selectedKeys:X?[]:ce,defaultExpandAll:q},Ce),{},{onActiveChange:H,onSelect:c,onCheck:c,onExpand:h,onLoad:ee,filterTreeNode:$,expandAction:B}),Q(Q({},g),{checkable:n.customSlots.treeCheckable}))])}}}),Ml="SHOW_ALL",ia="SHOW_PARENT",Dt="SHOW_CHILD";function Mt(e,_,g,s){const i=new Set(e);return _===Dt?e.filter(n=>{const o=g[n];return!(o&&o.children&&o.children.some(a=>{let{node:w}=a;return i.has(w[s.value])})&&o.children.every(a=>{let{node:w}=a;return yt(w)||i.has(w[s.value])}))}):_===ia?e.filter(n=>{const o=g[n],a=o?o.parent:null;return!(a&&!yt(a.node)&&i.has(a.key))}):e}const st=()=>null;st.inheritAttrs=!1;st.displayName="ATreeSelectNode";st.isTreeSelectNode=!0;const Ot=st;var Al=function(e,_){var g={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&_.indexOf(s)<0&&(g[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)_.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(g[s[i]]=e[s[i]]);return g};function jl(e){return e&&e.type&&e.type.isTreeSelectNode}function Fl(e){function _(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ua(g).map(s=>{var i,n,o;if(!jl(s))return null;const a=s.children||{},w=s.key,u={};for(const[R,N]of Object.entries(s.props))u[_a(R)]=N;const{isLeaf:f,checkable:$,selectable:k,disabled:S,disableCheckbox:P}=u,h={isLeaf:f||f===""||void 0,checkable:$||$===""||void 0,selectable:k||k===""||void 0,disabled:S||S===""||void 0,disableCheckbox:P||P===""||void 0},v=Q(Q({},u),h),{title:c=(i=a.title)===null||i===void 0?void 0:i.call(a,v),switcherIcon:V=(n=a.switcherIcon)===null||n===void 0?void 0:n.call(a,v)}=u,E=Al(u,["title","switcherIcon"]),H=(o=a.default)===null||o===void 0?void 0:o.call(a),d=Q(Q(Q({},E),{title:c,switcherIcon:V,key:w,isLeaf:f}),h),p=_(H);return p.length&&(d.children=p),d})}return _(e)}function bt(e){if(!e)return e;const _=Q({},e);return"props"in _||Object.defineProperty(_,"props",{get(){return _}}),_}function Ul(e,_,g,s,i,n){let o=null,a=null;function w(){function u(f){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return f.map((S,P)=>{const h=`${$}-${P}`,v=S[n.value],c=g.includes(v),V=u(S[n.children]||[],h,c),E=t(Ot,S,{default:()=>[V.map(H=>H.node)]});if(_===v&&(o=E),c){const H={pos:h,node:E,children:V};return k||a.push(H),H}return null}).filter(S=>S)}a||(a=[],u(s),a.sort((f,$)=>{let{node:{props:{value:k}}}=f,{node:{props:{value:S}}}=$;const P=g.indexOf(k),h=g.indexOf(S);return P-h}))}Object.defineProperty(e,"triggerNode",{get(){return w(),o}}),Object.defineProperty(e,"allCheckedNodes",{get(){return w(),i?a:a.map(u=>{let{node:f}=u;return f})}})}function Hl(e,_){let{id:g,pId:s,rootPId:i}=_;const n={},o=[];return e.map(w=>{const u=Q({},w),f=u[g];return n[f]=u,u.key=u.key||f,u}).forEach(w=>{const u=w[s],f=n[u];f&&(f.children=f.children||[],f.children.push(w)),(u===i||!f&&i===null)&&o.push(w)}),o}function Bl(e,_,g){const s=ye();return Re([g,e,_],()=>{const i=g.value;e.value?s.value=g.value?Hl(we(e.value),Q({id:"id",pId:"pId",rootPId:null},i!==!0?i:{})):we(e.value).slice():s.value=Fl(we(_.value))},{immediate:!0,deep:!0}),s}const zl=e=>{const _=ye({valueLabels:new Map}),g=ye();return Re(e,()=>{g.value=we(e.value)},{immediate:!0}),[G(()=>{const{valueLabels:i}=_.value,n=new Map,o=g.value.map(a=>{var w;const{value:u}=a,f=(w=a.label)!==null&&w!==void 0?w:i.get(u);return n.set(u,f),Q(Q({},a),{label:f})});return _.value.valueLabels=n,o})]},Wl=(e,_)=>{const g=ye(new Map),s=ye({});return xt(()=>{const i=_.value,n=dl(e.value,{fieldNames:i,initWrapper:o=>Q(Q({},o),{valueEntities:new Map}),processEntity:(o,a)=>{const w=o.node[i.value];a.valueEntities.set(w,o)}});g.value=n.valueEntities,s.value=n.keyEntities}),{valueEntities:g,keyEntities:s}},Yl=(e,_,g,s,i,n)=>{const o=ye([]),a=ye([]);return xt(()=>{let w=e.value.map($=>{let{value:k}=$;return k}),u=_.value.map($=>{let{value:k}=$;return k});const f=w.filter($=>!s.value[$]);g.value&&({checkedKeys:w,halfCheckedKeys:u}=gt(w,!0,s.value,i.value,n.value)),o.value=Array.from(new Set([...f,...w])),a.value=u}),[o,a]},Jl=(e,_,g)=>{let{treeNodeFilterProp:s,filterTreeNode:i,fieldNames:n}=g;return G(()=>{const{children:o}=n.value,a=_.value,w=s==null?void 0:s.value;if(!a||i.value===!1)return e.value;let u;if(typeof i.value=="function")u=i.value;else{const $=a.toUpperCase();u=(k,S)=>{const P=S[w];return String(P).toUpperCase().includes($)}}function f($){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=[];for(let P=0,h=$.length;P<h;P++){const v=$[P],c=v[o],V=k||u(a,bt(v)),E=f(c||[],V);(V||E.length)&&S.push(Q(Q({},v),{[o]:E}))}return S}return f(e.value)})};function ra(){return Q(Q({},Ze(al(),["mode"])),{prefixCls:String,id:String,value:{type:[String,Number,Object,Array]},defaultValue:{type:[String,Number,Object,Array]},onChange:{type:Function},searchValue:String,inputValue:String,onSearch:{type:Function},autoClearSearchValue:{type:Boolean,default:void 0},filterTreeNode:{type:[Boolean,Function],default:void 0},treeNodeFilterProp:String,onSelect:Function,onDeselect:Function,showCheckedStrategy:{type:String},treeNodeLabelProp:String,fieldNames:{type:Object},multiple:{type:Boolean,default:void 0},treeCheckable:{type:Boolean,default:void 0},treeCheckStrictly:{type:Boolean,default:void 0},labelInValue:{type:Boolean,default:void 0},treeData:{type:Array},treeDataSimpleMode:{type:[Boolean,Object],default:void 0},loadData:{type:Function},treeLoadedKeys:{type:Array},onTreeLoad:{type:Function},treeDefaultExpandAll:{type:Boolean,default:void 0},treeExpandedKeys:{type:Array},treeDefaultExpandedKeys:{type:Array},onTreeExpand:{type:Function},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,onDropdownVisibleChange:{type:Function},treeLine:{type:[Boolean,Object],default:void 0},treeIcon:je.any,showTreeIcon:{type:Boolean,default:void 0},switcherIcon:je.any,treeMotion:je.any,children:Array,treeExpandAction:String,showArrow:{type:Boolean,default:void 0},showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:je.any,maxTagPlaceholder:{type:Function},dropdownPopupAlign:je.any,customSlots:Object})}function ql(e){return!e||typeof e!="object"}const Ql=wt({compatConfig:{MODE:3},name:"TreeSelect",inheritAttrs:!1,props:Ft(ra(),{treeNodeFilterProp:"value",autoClearSearchValue:!0,showCheckedStrategy:Dt,listHeight:200,listItemHeight:20,prefixCls:"vc-tree-select"}),setup(e,_){let{attrs:g,expose:s,slots:i}=_;const n=Za(Ee(e,"id")),o=G(()=>e.treeCheckable&&!e.treeCheckStrictly),a=G(()=>e.treeCheckable||e.treeCheckStrictly),w=G(()=>e.treeCheckStrictly||e.labelInValue),u=G(()=>a.value||e.multiple),f=G(()=>Pl(e.fieldNames)),[$,k]=Kt("",{value:G(()=>e.searchValue!==void 0?e.searchValue:e.inputValue),postState:U=>U||""}),S=U=>{var z;k(U),(z=e.onSearch)===null||z===void 0||z.call(e,U)},P=Bl(Ee(e,"treeData"),Ee(e,"children"),Ee(e,"treeDataSimpleMode")),{keyEntities:h,valueEntities:v}=Wl(P,f),c=U=>{const z=[],Y=[];return U.forEach(le=>{v.value.has(le)?Y.push(le):z.push(le)}),{missingRawValues:z,existRawValues:Y}},V=Jl(P,$,{fieldNames:f,treeNodeFilterProp:Ee(e,"treeNodeFilterProp"),filterTreeNode:Ee(e,"filterTreeNode")}),E=U=>{if(U){if(e.treeNodeLabelProp)return U[e.treeNodeLabelProp];const{_title:z}=f.value;for(let Y=0;Y<z.length;Y+=1){const le=U[z[Y]];if(le!==void 0)return le}}},H=U=>Tl(U).map(Y=>ql(Y)?{value:Y}:Y),d=U=>H(U).map(Y=>{let{label:le}=Y;const{value:de,halfChecked:ne}=Y;let ae;const re=v.value.get(de);return re&&(le=le??E(re.node),ae=re.node.disabled),{label:le,value:de,halfChecked:ne,disabled:ae}}),[p,R]=Kt(e.defaultValue,{value:Ee(e,"value")}),N=G(()=>H(p.value)),F=ye([]),x=ye([]);xt(()=>{const U=[],z=[];N.value.forEach(Y=>{Y.halfChecked?z.push(Y):U.push(Y)}),F.value=U,x.value=z});const L=G(()=>F.value.map(U=>U.value)),{maxLevel:b,levelEntities:T}=cl(h),[M,B]=Yl(F,x,o,h,b,T),X=G(()=>{const Y=Mt(M.value,e.showCheckedStrategy,h.value,f.value).map(ne=>{var ae,re,Se;return(Se=(re=(ae=h.value[ne])===null||ae===void 0?void 0:ae.node)===null||re===void 0?void 0:re[f.value.value])!==null&&Se!==void 0?Se:ne}).map(ne=>{const ae=F.value.find(re=>re.value===ne);return{value:ne,label:ae==null?void 0:ae.label}}),le=d(Y),de=le[0];return!u.value&&de&&Nt(de.value)&&Nt(de.label)?[]:le.map(ne=>{var ae;return Q(Q({},ne),{label:(ae=ne.label)!==null&&ae!==void 0?ae:ne.value})})}),[q]=zl(X),m=(U,z,Y)=>{const le=d(U);if(R(le),e.autoClearSearchValue&&k(""),e.onChange){let de=U;o.value&&(de=Mt(U,e.showCheckedStrategy,h.value,f.value).map(Pe=>{const Qe=v.value.get(Pe);return Qe?Qe.node[f.value.value]:Pe}));const{triggerValue:ne,selected:ae}=z||{triggerValue:void 0,selected:void 0};let re=de;if(e.treeCheckStrictly){const ke=x.value.filter(Pe=>!de.includes(Pe.value));re=[...re,...ke]}const Se=d(re),Oe={preValue:F.value,triggerValue:ne};let Te=!0;(e.treeCheckStrictly||Y==="selection"&&!ae)&&(Te=!1),Ul(Oe,ne,U,P.value,Te,f.value),a.value?Oe.checked=ae:Oe.selected=ae;const be=w.value?Se:Se.map(ke=>ke.value);e.onChange(u.value?be:be[0],w.value?null:Se.map(ke=>ke.label),Oe)}},Z=(U,z)=>{let{selected:Y,source:le}=z;var de,ne,ae;const re=we(h.value),Se=we(v.value),Oe=re[U],Te=Oe==null?void 0:Oe.node,be=(de=Te==null?void 0:Te[f.value.value])!==null&&de!==void 0?de:U;if(!u.value)m([be],{selected:!0,triggerValue:be},"option");else{let ke=Y?[...L.value,be]:M.value.filter(Pe=>Pe!==be);if(o.value){const{missingRawValues:Pe,existRawValues:Qe}=c(ke),Vt=Qe.map(ct=>Se.get(ct).key);let dt;Y?{checkedKeys:dt}=gt(Vt,!0,re,b.value,T.value):{checkedKeys:dt}=gt(Vt,{checked:!1,halfCheckedKeys:B.value},re,b.value,T.value),ke=[...Pe,...dt.map(ct=>re[ct].node[f.value.value])]}m(ke,{selected:Y,triggerValue:be},le||"option")}Y||!u.value?(ne=e.onSelect)===null||ne===void 0||ne.call(e,be,bt(Te)):(ae=e.onDeselect)===null||ae===void 0||ae.call(e,be,bt(Te))},xe=U=>{if(e.onDropdownVisibleChange){const z={};Object.defineProperty(z,"documentClickClose",{get(){return!1}}),e.onDropdownVisibleChange(U,z)}},A=(U,z)=>{const Y=U.map(le=>le.value);if(z.type==="clear"){m(Y,{},"selection");return}z.values.length&&Z(z.values[0].value,{selected:!1,source:"selection"})},{treeNodeFilterProp:J,loadData:ie,treeLoadedKeys:K,onTreeLoad:ee,treeDefaultExpandAll:ce,treeExpandedKeys:Ce,treeDefaultExpandedKeys:He,onTreeExpand:Le,virtual:Be,listHeight:ve,listItemHeight:ue,treeLine:De,treeIcon:ze,showTreeIcon:We,switcherIcon:I,treeMotion:me,customSlots:it,dropdownMatchSelectWidth:Ye,treeExpandAction:rt}=Aa(e);el(Rt({checkable:a,loadData:ie,treeLoadedKeys:K,onTreeLoad:ee,checkedKeys:M,halfCheckedKeys:B,treeDefaultExpandAll:ce,treeExpandedKeys:Ce,treeDefaultExpandedKeys:He,onTreeExpand:Le,treeIcon:ze,treeMotion:me,showTreeIcon:We,switcherIcon:I,treeLine:De,treeNodeFilterProp:J,keyEntities:h,customSlots:it})),El(Rt({virtual:Be,listHeight:ve,listItemHeight:ue,treeData:V,fieldNames:f,onSelect:Z,dropdownMatchSelectWidth:Ye,treeExpandAction:rt}));const Me=C();return s({focus(){var U;(U=Me.value)===null||U===void 0||U.focus()},blur(){var U;(U=Me.value)===null||U===void 0||U.blur()},scrollTo(U){var z;(z=Me.value)===null||z===void 0||z.scrollTo(U)}}),()=>{var U;const z=Ze(e,["id","prefixCls","customSlots","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"]);return t(tl,$e($e($e({ref:Me},g),z),{},{id:n,prefixCls:e.prefixCls,mode:u.value?"multiple":void 0,displayValues:q.value,onDisplayValuesChange:A,searchValue:$.value,onSearch:S,OptionList:Nl,emptyOptions:!P.value.length,onDropdownVisibleChange:xe,tagRender:e.tagRender||i.tagRender,dropdownMatchSelectWidth:(U=e.dropdownMatchSelectWidth)!==null&&U!==void 0?U:!0}),i)}}}),Gl=e=>{const{componentCls:_,treePrefixCls:g,colorBgElevated:s}=e,i=`.${g}`;return[{[`${_}-dropdown`]:[{padding:`${e.paddingXS}px ${e.paddingXS/2}px`},ol(g,Ut(e,{colorBgContainer:s})),{[i]:{borderRadius:0,"&-list-holder-inner":{alignItems:"stretch",[`${i}-treenode`]:{[`${i}-node-content-wrapper`]:{flex:"auto"}}}}},ml(`${g}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${i}-switcher${i}-switcher_close`]:{[`${i}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Xl(e,_){return pa("TreeSelect",g=>{const s=Ut(g,{treePrefixCls:_.value});return[Gl(s)]})(e)}const At=(e,_,g)=>g!==void 0?g:`${e}-${_}`;function Zl(){return Q(Q({},Ze(ra(),["showTreeIcon","treeMotion","inputIcon","getInputElement","treeLine","customSlots"])),{suffixIcon:je.any,size:_t(),bordered:ba(),treeLine:ka([Boolean,Object]),replaceFields:wa(),placement:_t(),status:_t(),popupClassName:String,dropdownClassName:String,"onUpdate:value":pt(),"onUpdate:treeExpandedKeys":pt(),"onUpdate:searchValue":pt()})}const ft=wt({compatConfig:{MODE:3},name:"ATreeSelect",inheritAttrs:!1,props:Ft(Zl(),{choiceTransitionName:"",listHeight:256,treeIcon:!1,listItemHeight:26,bordered:!0}),slots:Object,setup(e,_){let{attrs:g,slots:s,expose:i,emit:n}=_;va(!(e.treeData===void 0&&s.default)),ut(e.multiple!==!1||!e.treeCheckable,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true"),ut(e.replaceFields===void 0,"TreeSelect","`replaceFields` is deprecated, please use fieldNames instead"),ut(!e.dropdownClassName,"TreeSelect","`dropdownClassName` is deprecated. Please use `popupClassName` instead.");const o=ul(),a=_l.useInject(),w=G(()=>pl(a.status,e.status)),{prefixCls:u,renderEmpty:f,direction:$,virtual:k,dropdownMatchSelectWidth:S,size:P,getPopupContainer:h,getPrefixCls:v,disabled:c}=ma("select",e),{compactSize:V,compactItemClassnames:E}=fa(u,$),H=G(()=>V.value||P.value),d=ha(),p=G(()=>{var K;return(K=c.value)!==null&&K!==void 0?K:d.value}),R=G(()=>v()),N=G(()=>e.placement!==void 0?e.placement:$.value==="rtl"?"bottomRight":"bottomLeft"),F=G(()=>At(R.value,ga(N.value),e.transitionName)),x=G(()=>At(R.value,"",e.choiceTransitionName)),L=G(()=>v("select-tree",e.prefixCls)),b=G(()=>v("tree-select",e.prefixCls)),[T,M]=ll(u),[B]=Xl(b,L),X=G(()=>Et(e.popupClassName||e.dropdownClassName,`${b.value}-dropdown`,{[`${b.value}-dropdown-rtl`]:$.value==="rtl"},M.value)),q=G(()=>!!(e.treeCheckable||e.multiple)),m=G(()=>e.showArrow!==void 0?e.showArrow:e.loading||!q.value),Z=C();i({focus(){var K,ee;(ee=(K=Z.value).focus)===null||ee===void 0||ee.call(K)},blur(){var K,ee;(ee=(K=Z.value).blur)===null||ee===void 0||ee.call(K)}});const xe=function(){for(var K=arguments.length,ee=new Array(K),ce=0;ce<K;ce++)ee[ce]=arguments[ce];n("update:value",ee[0]),n("change",...ee),o.onFieldChange()},A=K=>{n("update:treeExpandedKeys",K),n("treeExpand",K)},J=K=>{n("update:searchValue",K),n("search",K)},ie=K=>{n("blur",K),o.onFieldBlur()};return()=>{var K,ee;const{notFoundContent:ce=(K=s.notFoundContent)===null||K===void 0?void 0:K.call(s),prefixCls:Ce,bordered:He,listHeight:Le,listItemHeight:Be,multiple:ve,treeIcon:ue,treeLine:De,showArrow:ze,switcherIcon:We=(ee=s.switcherIcon)===null||ee===void 0?void 0:ee.call(s),fieldNames:I=e.replaceFields,id:me=o.id.value}=e,{isFormItemInput:it,hasFeedback:Ye,feedbackIcon:rt}=a,{suffixIcon:Me,removeIcon:U,clearIcon:z}=nl(Q(Q({},e),{multiple:q.value,showArrow:m.value,hasFeedback:Ye,feedbackIcon:rt,prefixCls:u.value}),s);let Y;ce!==void 0?Y=ce:Y=f("Select");const le=Ze(e,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon","bordered","status","onUpdate:value","onUpdate:treeExpandedKeys","onUpdate:searchValue"]),de=Et(!Ce&&b.value,{[`${u.value}-lg`]:H.value==="large",[`${u.value}-sm`]:H.value==="small",[`${u.value}-rtl`]:$.value==="rtl",[`${u.value}-borderless`]:!He,[`${u.value}-in-form-item`]:it},vl(u.value,w.value,Ye),E.value,g.class,M.value),ne={};return e.treeData===void 0&&s.default&&(ne.children=ya(s.default())),T(B(t(Ql,$e($e($e($e({},g),le),{},{disabled:p.value,virtual:k.value,dropdownMatchSelectWidth:S.value,id:me,fieldNames:I,ref:Z,prefixCls:u.value,class:de,listHeight:Le,listItemHeight:Be,treeLine:!!De,inputIcon:Me,multiple:ve,removeIcon:U,clearIcon:z,switcherIcon:ae=>il(L.value,We,ae,s.leafIcon,De),showTreeIcon:ue,notFoundContent:Y,getPopupContainer:h==null?void 0:h.value,treeMotion:null,dropdownClassName:X.value,choiceTransitionName:x.value,onChange:xe,onBlur:ie,onSearch:J,onTreeExpand:A},ne),{},{transitionName:F.value,customSlots:Q(Q({},s),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}),maxTagPlaceholder:e.maxTagPlaceholder||s.maxTagPlaceholder,placement:N.value,showArrow:Ye||ze}),Q(Q({},s),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}))))}}}),jt=Ot,Tt=Q(ft,{TreeNode:Ot,SHOW_ALL:Ml,SHOW_PARENT:ia,SHOW_CHILD:Dt,install:e=>(e.component(ft.name,ft),e.component(jt.displayName,jt),e)}),en={class:"page-tabs"},tn=["onClick"],an={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(e,{emit:_}){const{t:g}=xa(),s=_,i=e,n=C([{value:1,title:g("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"},{value:0,title:g("views.user.model.rolePermissions"),langKey:"views.user.model.rolePermissions"}]),o=a=>{s("update:value",a),s("change",a)};return(a,w)=>(y(),D("div",en,[(y(!0),D(_e,null,qe(n.value,u=>(y(),D("div",{class:Wt(["tab-item",{active:i.value==u.value}]),onClick:f=>o(u.value),key:u.value},j(W(g)(u.langKey)),11,tn))),128))]))}},ln=he(an,[["__scopeId","data-v-924c1ece"]]),nn=e=>(Ke("data-v-662035a2"),e=e(),Ne(),e),sn={class:"avatar-uploader"},on=["src"],rn={key:1},dn=nn(()=>r("div",{class:"ant-upload-text"},"上传照片",-1)),cn=["src"],un={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(e,{emit:_}){function g(v){return new Promise((c,V)=>{const E=new FileReader;E.readAsDataURL(v),E.onload=()=>c(E.result),E.onerror=H=>V(H)})}const s=_,i=e,n=C([]),o=C(!1),a=C("");Re(()=>i.value,v=>{a.value=v},{immediate:!0});const w=Ie.useInjectFormItemContext(),u=()=>{let v={imageUrl:a.value,file:n.value[0].originFileObj};s("change",v),s("update:value",v.imageUrl),w.onFieldChange()},f=v=>v.type==="image/jpeg"||v.type==="image/png"?v.size/1024<1024?(n.value=[v],g(v).then(E=>{a.value=E,o.value=!1,u()}),!1):(oe.error("成员头像图片大小不能超过1M"),!1):(oe.error("机器人头像只支持JPG、PNG格式的图片"),!1),$=C(!1),k=C(""),S=C(""),P=()=>{$.value=!1,S.value=""},h=async v=>{!v.url&&!v.preview&&(v.preview=await g(v.originFileObj)),k.value=v.url||v.preview,$.value=!0,S.value=v.name||v.url.substring(v.url.lastIndexOf("/")+1)};return(v,c)=>{const V=Ua,E=fe;return y(),D("div",sn,[t(V,{"file-list":n.value,"onUpdate:fileList":c[0]||(c[0]=H=>n.value=H),"list-type":"picture-card","show-upload-list":!1,"before-upload":f,accept:".jpg,.png,.jpeg",onPreview:h},{default:l(()=>[a.value?(y(),D("img",{key:0,class:"avatar",src:a.value,alt:"avatar"},null,8,on)):(y(),D("div",rn,[o.value?(y(),se(W(Ca),{key:0})):(y(),se(W(at),{key:1})),dn]))]),_:1},8,["file-list"]),t(E,{open:$.value,title:S.value,footer:null,onCancel:P},{default:l(()=>[r("img",{alt:"example",style:{width:"100%"},src:k.value},null,8,cn)]),_:1},8,["open","title"])])}}},_n=he(un,[["__scopeId","data-v-662035a2"]]),pn=e=>(Ke("data-v-e2c6d008"),e=e(),Ne(),e),vn={class:"form-box"},mn={class:"avatar-box"},fn=pn(()=>r("div",{class:"tip"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1)),hn={class:"flex-item-box"},gn={class:"flex-item-box"},yn={class:"flex-item-box"},bn={class:"flex-item-box"},kn={key:0,style:{"margin-top":"4px"}},wn={__name:"add-team-members",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C(!1),o=C("添加团队成员"),a=pe({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",department_ids:[],expire_time_type:0,expire_time:"",id:""}),w=C([]),u=()=>{lt({}).then(d=>{let p=d.data||[];w.value=kt(p)})},f=d=>{a.avatar=d.file},$=C([]);Ht({page:1,size:200,search:""}).then(d=>{let p=d.data.list||[];$.value=p.filter(R=>R.id!="1"&&R.role_type!=1)});const k=pe({user_name:[{message:"请输入登录账号",required:!0},{validator:async(d,p)=>!/^[a-zA-Z0-9_.-]+$/.test(p)&&p?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(d,p)=>!qt(p)&&p?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(d,p)=>p!=a.password&&p?Promise.reject("两次输入的密码不一致"):Promise.resolve()}],expire_time:[{validator:async(d,p)=>a.expire_time_type==1&&!p?Promise.reject("请选择指定日期"):Promise.resolve()}],department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:S,validate:P,validateInfos:h}=i(a,k),v=d=>{o.value="添加团队成员",n.value=!0,S(),a.user_name="",a.nick_name="",a.avatar="",a.avatar_url=ht,a.user_roles="3",a.password="",a.check_password="",a.expire_time_type=0,a.expire_time="",a.department_ids=d?[d]:[],a.id="",u()},c=d=>{o.value="编辑团队成员",a.user_name=d.user_name,a.nick_name=d.nick_name,a.avatar_url=d.avatar||ht,a.avatar="",a.user_roles=d.user_roles,a.password="",a.check_password="",a.id=d.id,d.expire_time>0?(a.expire_time_type=1,a.expire_time=Ve(d.expire_time*1e3)):(a.expire_time_type=0,a.expire_time=""),a.department_ids=d.departments.map(p=>+p.id),delete k.password,delete k.check_password,n.value=!0,u()},V=C(!1),E=()=>{P().then(()=>{let d={...we(a)};d.expire_time_type==1?d.expire_time=Ve(d.expire_time).unix():d.expire_time=0,d.department_ids=a.department_ids.join(","),delete d.avatar_url,V.value=!0,Sa(d).then(p=>{oe.success(`${o.value}成功`),n.value=!1,s("ok")}).finally(()=>{V.value=!1})})},H=d=>d&&d<Ve().startOf("day");return _({add:v,edit:c}),(d,p)=>{const R=Ct,N=tt,F=Gt,x=Xt,L=Tt,b=ea,T=Zt,M=St,B=hl,X=Ie,q=fe;return y(),D("div",null,[t(q,{open:n.value,"onUpdate:open":p[9]||(p[9]=m=>n.value=m),title:o.value,onOk:E,width:"746px"},{default:l(()=>[r("div",vn,[r("div",mn,[t(_n,{value:a.avatar_url,"onUpdate:value":p[0]||(p[0]=m=>a.avatar_url=m),onChange:f},null,8,["value"]),fn]),t(X,{layout:"vertical",autocomplete:"off"},{default:l(()=>[r("div",hn,[t(N,ge({label:"成员昵称"},W(h).nick_name),{default:l(()=>[t(R,{maxlength:100,type:"text",placeholder:"请输入昵称",value:a.nick_name,"onUpdate:value":p[1]||(p[1]=m=>a.nick_name=m)},null,8,["value"])]),_:1},16),t(N,ge({label:"登录账号"},W(h).user_name),{default:l(()=>[t(R,{disabled:a.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:a.user_name,"onUpdate:value":p[2]||(p[2]=m=>a.user_name=m)},null,8,["disabled","value"])]),_:1},16)]),r("div",gn,[t(N,ge({label:"成员角色"},W(h).user_roles),{default:l(()=>[t(x,{value:a.user_roles,"onUpdate:value":p[3]||(p[3]=m=>a.user_roles=m),style:{width:"100%"},placeholder:"请选择成员角色"},{default:l(()=>[(y(!0),D(_e,null,qe($.value,m=>(y(),se(F,{key:m.id,value:m.id},{default:l(()=>[O(j(m.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),t(N,ge({label:"选择部门"},W(h).department_ids,{name:"department_ids"}),{default:l(()=>[t(L,{value:a.department_ids,"onUpdate:value":p[4]||(p[4]=m=>a.department_ids=m),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":w.value,"tree-node-filter-prop":"label"},{title:l(({value:m,label:Z})=>[r("div",null,j(Z),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),r("div",yn,[a.id?te("",!0):(y(),se(N,ge({key:0,label:"登录密码"},W(h).password),{default:l(()=>[t(b,{value:a.password,"onUpdate:value":p[5]||(p[5]=m=>a.password=m),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),a.id?te("",!0):(y(),se(N,ge({key:1,label:"确认密码"},W(h).check_password),{default:l(()=>[t(b,{value:a.check_password,"onUpdate:value":p[6]||(p[6]=m=>a.check_password=m),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),r("div",bn,[t(N,ge({label:"过期时间"},W(h).expire_time,{required:""}),{default:l(()=>[t(M,{value:a.expire_time_type,"onUpdate:value":p[7]||(p[7]=m=>a.expire_time_type=m)},{default:l(()=>[t(T,{value:0},{default:l(()=>[O("永久有效")]),_:1}),t(T,{value:1},{default:l(()=>[O("指定时间")]),_:1})]),_:1},8,["value"]),a.expire_time_type==1?(y(),D("div",kn,[t(B,{showNow:!1,format:"YYYY-MM-DD HH:mm","disabled-date":H,value:a.expire_time,"onUpdate:value":p[8]||(p[8]=m=>a.expire_time=m),"show-time":{defaultValue:W(Ve)("00:00","HH:mm")}},null,8,["value","show-time"])])):te("",!0)]),_:1},16)])]),_:1})])]),_:1},8,["open","title"])])}}},xn=he(wn,[["__scopeId","data-v-e2c6d008"]]),Cn={class:"form-box"},Sn={__name:"reset-password",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C(!1),o=C("重置登录密码"),a=pe({password:"",check_password:"",id:""}),w=pe({password:[{message:"请输入登录密码",required:!0},{validator:async(P,h)=>!qt(h)&&h?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(P,h)=>h!=a.password&&h?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:u,validate:f,validateInfos:$}=i(a,w),k=P=>{P.id,n.value=!0,u(),a.password="",a.check_password="",a.id=P.id},S=()=>{f().then(()=>{$a({...we(a)}).then(P=>{oe.success("修改成功"),n.value=!1,s("ok")})})};return _({open:k}),(P,h)=>{const v=ea,c=tt,V=Ie,E=fe;return y(),D("div",null,[t(E,{open:n.value,"onUpdate:open":h[2]||(h[2]=H=>n.value=H),title:o.value,onOk:S,width:"476px"},{default:l(()=>[r("div",Cn,[t(V,{layout:"vertical"},{default:l(()=>[t(c,ge({label:"登录密码"},W($).password),{default:l(()=>[t(v,{value:a.password,"onUpdate:value":h[0]||(h[0]=H=>a.password=H),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(c,ge({label:"确认密码"},W($).check_password),{default:l(()=>[t(v,{value:a.check_password,"onUpdate:value":h[1]||(h[1]=H=>a.check_password=H),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},$n=he(Sn,[["__scopeId","data-v-d0706fa4"]]),In={key:0,class:"form-wrapper"},Ln={class:"select"},Dn={class:"tools-wrapper"},On=["src"],Tn={class:"item-name"},Pn={key:1,class:"form-wrapper"},Vn={class:"main-tabs-box"},En={class:"select"},Rn={class:"tools-wrapper"},Kn={class:"item-name"},Nn={class:"tools-wrapper"},Mn={class:"item-name"},An={key:2,class:"form-wrapper"},jn={class:"select"},Fn={class:"tools-wrapper"},Un={class:"item-name"},Hn={__name:"see-model-alert",props:{robotList:{type:Array,default:()=>[]},libraryList:{type:Array,default:()=>[]},formList:{type:Array,default:()=>[]}},emits:["save","ok"],setup(e,{expose:_,emit:g}){const s=g,i=e,n=C([]),o=C(""),a=C(!1),w=C([]),u=C([]),f=x=>{const L=[];return x.map(b=>{L.push(b.id)}),L},$=x=>{n.value=x},k=C(1),S=[{value:2,payload:{title:"部门知识库"}},{value:1,payload:{title:"成员知识库"}}],P=C(S);let h=null;const v=C(1),c=C(1),V=C(),E=async(x,L,b)=>{n.value=[],v.value=x,c.value=1,k.value=1,h=JSON.parse(JSON.stringify(b)),V.value=h.id,b=JSON.parse(JSON.stringify(b)),P.value=S,b.managed_robot_list=b.managed_robot_list||[],b.managed_library_list=b.managed_library_list||[],b.managed_form_list=b.managed_form_list||[];let T=[];x==1?(o.value="添加成员管理的机器人",T=i.robotList,T.forEach(M=>{let B=b.managed_robot_list.filter(X=>X.id==M.id);B.length?M.operate_rights=B[0].operate_rights:M.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的机器人",n.value=f(b.managed_robot_list))):x==2?(o.value="添加成员管理的知识库",T=i.libraryList,T.forEach(M=>{let B=b.managed_library_list.filter(X=>X.id==M.id);B.length?M.operate_rights=B[0].operate_rights:M.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的知识库",n.value=f(b.managed_library_list))):x==3&&(o.value="添加成员管理的数据库",T=i.formList,T.forEach(M=>{let B=b.managed_form_list.filter(X=>X.id==M.id);B.length?M.operate_rights=B[0].operate_rights:M.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的数据库",n.value=f(b.managed_form_list))),w.value=T,a.value=!0},H=()=>{Qt({object_type:v.value,identity_type:c.value,identity_id:V.value,tab:c.value}).then(x=>{u.value=x.data||[]})},d=()=>{k.value==2&&H()},p=(x,L)=>{n.value=[],c.value=1,k.value=1,v.value=x,V.value=L;let b=[];x==1?(o.value="批量修改成员管理的机器人",b=i.robotList):x==2?(o.value="批量修改成员管理的知识库",b=i.libraryList):x==3&&(o.value="批量修改成员管理的数据库",b=i.formList),b.forEach(T=>{T.operate_rights="4"}),w.value=b,a.value=!0},R=(x,L,b)=>{n.value=[],L.is_user?c.value=1:c.value=2,V.value=L.id,P.value=[{value:2,payload:{title:c.value==1?"部门知识库":"上级知识库"}},{value:1,payload:{title:c.value==1?"成员知识库":"部门知识库"}}],k.value=1,v.value=x;let T=[];x==1?(o.value=`添加${c==1?"成员":"部门"}管理的机器人`,T=i.robotList):x==2?(o.value=`添加${c==1?"成员":"部门"}管理的知识库`,T=i.libraryList):x==3&&(o.value=`添加${c==1?"成员":"部门"}管理的数据库`,T=i.formList),T.forEach(M=>{let B=b.filter(X=>X.object_id==M.id);B.length?M.operate_rights=B[0].operate_rights:M.operate_rights="4"}),n.value=b.map(M=>M.object_id),w.value=T,a.value=!0},N=()=>{let x={identity_ids:V.value,identity_type:c.value,object_type:v.value},L=[];w.value.forEach(b=>{n.value.includes(b.id)&&L.push({object_id:+b.id,object_type:+v.value,operate_rights:+b.operate_rights})}),x.object_array=JSON.stringify(L),Ha(x).then(b=>{a.value=!1,oe.success("保存成功"),s("ok")})},F=()=>{};return _({open:E,handleBatchOpen:p,handleDepartmentOpen:R}),(x,L)=>{const b=$t,T=Zt,M=St,B=nt,X=ta,q=fe;return y(),se(q,{class:"add-model-alert",width:"800px",open:a.value,"onUpdate:open":L[1]||(L[1]=m=>a.value=m),title:o.value,onOk:N,onCancel:F},{default:l(()=>[v.value==1?(y(),D("div",In,[r("div",Ln,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"机器人","data-index":"robot_name",width:350},{default:l(({record:m})=>[r("div",Dn,[r("img",{class:"model-logo",src:m.robot_avatar,alt:""},null,8,On),r("div",Tn,j(m.robot_name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):v.value==2?(y(),D("div",Pn,[r("div",Vn,[t(X,{value:k.value,"onUpdate:value":L[0]||(L[0]=m=>k.value=m),options:P.value,onChange:d},{label:l(({payload:m})=>[O(j(m.title),1)]),_:1},8,["value","options"])]),k.value==1?(y(),D(_e,{key:0},[r("div",En,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"知识库","data-index":"library_name",width:350},{default:l(({record:m})=>[r("div",Rn,[r("div",Kn,j(m.library_name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])],64)):(y(),se(B,{key:1,"data-source":u.value,pagination:!1,scroll:{y:500},"row-key":"id"},{default:l(()=>[t(b,{title:"知识库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",Nn,[r("div",Mn,j(m.name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z,disabled:""},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source"]))])):v.value==3?(y(),D("div",An,[r("div",jn,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"数据库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",Fn,[r("div",Un,j(m.name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(M,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):te("",!0)]),_:1},8,["open","title"])}}},da=he(Hn,[["__scopeId","data-v-0706de39"]]),ca=e=>(Ke("data-v-0fb87f68"),e=e(),Ne(),e),Bn={class:"form-box"},zn={class:"form-item"},Wn=ca(()=>r("div",{class:"form-label"},"部门名称",-1)),Yn={class:"form-content"},Jn={key:0,class:"form-item"},qn=ca(()=>r("div",{class:"form-label"},"所属部门",-1)),Qn={class:"form-content"},Gn={__name:"add-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=g,n=pe({department_name:"",id:"",pid:""}),o=C(""),a=k=>{n.id="",n.pid=k.id>0?k.id||"":void 0,n.department_name="",o.value="添加部门",s.value=!0,f()},w=k=>{n.id=k.id||"",n.pid=k.pid||"",n.department_name=k.title||"",o.value="重命名",s.value=!0},u=C([]),f=()=>{lt({}).then(k=>{let S=k.data||[];u.value=kt(S)})},$=()=>{if(!n.department_name)return oe.error("请输入部门名称");if(!n.id&&!n.pid)return oe.error("请选择所属部门");Ba({...n}).then(k=>{oe.success("修改成功"),s.value=!1,i("ok")})};return _({show:a,rename:w}),(k,S)=>{const P=Ct,h=Tt,v=fe;return y(),D("div",null,[t(v,{open:s.value,"onUpdate:open":S[2]||(S[2]=c=>s.value=c),title:o.value,onOk:$,width:472},{default:l(()=>[r("div",Bn,[r("div",zn,[Wn,r("div",Yn,[t(P,{maxLength:10,value:n.department_name,"onUpdate:value":S[0]||(S[0]=c=>n.department_name=c),placeholder:"请输入部门名称"},null,8,["value"])])]),n.id?te("",!0):(y(),D("div",Jn,[qn,r("div",Qn,[t(h,{value:n.pid,"onUpdate:value":S[1]||(S[1]=c=>n.pid=c),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":u.value,"tree-node-filter-prop":"label"},{title:l(({value:c,label:V})=>[r("div",null,j(V),1)]),_:1},8,["value","tree-data"])])]))])]),_:1},8,["open","title"])])}}},Xn=he(Gn,[["__scopeId","data-v-0fb87f68"]]),ot=e=>(Ke("data-v-de653ece"),e=e(),Ne(),e),Zn={class:"del-box"},es={class:"icon-box"},ts=ot(()=>r("div",{class:"top-title"},"删除部门",-1)),as=ot(()=>r("div",{class:"content"}," 确认删除部门么？直接删除后，该部门成员归属到默认部门或设置新的部门 ",-1)),ls={class:"footer-btn"},ns={class:"set-box"},ss=ot(()=>r("div",{class:"set-desc"},"删除之前请先将之前部门的成员换到其他团队",-1)),os={class:"set-item"},is=ot(()=>r("div",{class:"set-label"},"所属部门",-1)),rs={__name:"del-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=C(!1),n=g,o=pe({id:"",new_department_id:void 0});let a=[];const w=h=>{if(a=[],a=u(h),o.new_department_id=void 0,o.id=h.id,h.children.length==0){fe.confirm({title:"提示",icon:t(Je),content:"确定删除该部门",onOk(){k()}});return}s.value=!0,P()};function u(h){let v=[h.id];if(h.children&&h.children.length>0)for(const c of h.children)v=v.concat(u(c));return v}const f=()=>{i.value=!0},$=()=>{o.new_department_id="",k()},k=()=>{za({...o}).then(h=>{i.value=!1,s.value=!1,oe.success("删除成功"),n("ok",o.id)})},S=C([]),P=()=>{Wa().then(h=>{let v=h.data||[];S.value=v.filter(c=>!a.includes(+c.id))})};return _({show:w}),(h,v)=>{const c=et,V=fe,E=Gt,H=Xt;return y(),D("div",null,[t(V,{open:s.value,"onUpdate:open":v[1]||(v[1]=d=>s.value=d),title:null,footer:null,width:480,closable:!1},{default:l(()=>[r("div",Zn,[r("div",es,[t(W(Bt))]),ts,as,r("div",ls,[t(c,{onClick:v[0]||(v[0]=d=>s.value=!1)},{default:l(()=>[O("关闭")]),_:1}),t(c,{danger:"",onClick:$},{default:l(()=>[O("直接删除")]),_:1}),t(c,{type:"primary",onClick:f},{default:l(()=>[O("删除并设置")]),_:1})])])]),_:1},8,["open"]),t(V,{open:i.value,"onUpdate:open":v[3]||(v[3]=d=>i.value=d),title:"设置部门",width:472,onOk:k},{default:l(()=>[r("div",ns,[ss,r("div",os,[is,r("div",null,[t(H,{value:o.new_department_id,"onUpdate:value":v[2]||(v[2]=d=>o.new_department_id=d),style:{width:"100%"},placeholder:"请选择"},{default:l(()=>[(y(!0),D(_e,null,qe(S.value,d=>(y(),se(E,{key:d.id,value:d.id},{default:l(()=>[O(j(d.department_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])]),_:1},8,["open"])])}}},ds=he(rs,[["__scopeId","data-v-de653ece"]]),Pt=e=>(Ke("data-v-f461874a"),e=e(),Ne(),e),cs={class:"department-tree-search"},us={class:"flex-block"},_s={class:"tree-list-box"},ps={style:{"margin-right":"4px"}},vs={class:"action-btn toggle-btn"},ms={class:"doc-item"},fs={key:0,class:"tree-title"},hs={style:{color:"#f50"}},gs={style:{color:"#f50"}},ys={key:1,class:"tree-title"},bs={class:"use-num"},ks={key:2,class:"doc-action-box"},ws=Pt(()=>r("span",{class:"menu-name"},"添加子部门",-1)),xs=Pt(()=>r("span",{class:"menu-name"},"重命名",-1)),Cs=Pt(()=>r("span",{class:"menu-name",style:{color:"#fb363f"}},"删 除",-1)),Ss={__name:"department-tree",emits:["select","save","refresh"],setup(e,{expose:_,emit:g}){const s=g;let i=[];const n=[],o=(x,L)=>{let b;for(let T=0;T<L.length;T++){const M=L[T];M.children&&(M.children.some(B=>B.key===x)?b=M.key:o(x,M.children)&&(b=o(x,M.children)))}return b},a=C([]),w=C([]),u=C(""),f=C(!0),$=C([]);let k="",S={};const P=x=>{a.value=x,f.value=!1};Re(u,x=>{const L=n.map(b=>b.title.indexOf(x)>-1?o(b.key,$.value):null).filter((b,T,M)=>b&&M.indexOf(b)===T);a.value=L,u.value=x,f.value=!0});const h=x=>{for(let L=0;L<x.length;L++){const b=x[L],T=b.key;n.push({key:T,title:b.title}),b.children&&h(b.children)}},v=x=>{lt({}).then(L=>{let b=L.data||[];i=[],i=Ia(b),h(i),$.value=i,x&&(b.forEach(T=>{T.is_default==1&&(k=T.id,S=T)}),Xe(()=>{k&&(w.value=[k],s("select",S))}))})};v(!0);let c={};const V=x=>{w.value[0]==x?Xe(()=>{k&&(w.value=[k],s("select",S))}):s("refresh"),v()},E=C(),H=x=>{E.value.show(x)},d=x=>{E.value.rename(x)},p=(x,L)=>{L.node.is_user,L.node.id,L.selected||Xe(()=>{w.value=[L.node.id]}),c={...L.node},s("select",c)},R=C(null),N=x=>{R.value.show(x)},F=()=>{v(),s("refresh")};return _({getLists:v}),(x,L)=>{const b=It,T=sa,M=aa,B=la,X=na,q=rl;return y(),D(_e,null,[r("div",cs,[r("div",us,[t(b,{value:u.value,"onUpdate:value":L[0]||(L[0]=m=>u.value=m),placeholder:"搜索部门",style:{flex:"1"}},null,8,["value"]),r("div",{class:"add-btn-box",onClick:L[1]||(L[1]=m=>H({}))},[t(W(at))])]),r("div",_s,[t(q,{"expanded-keys":a.value,selectedKeys:w.value,"onUpdate:selectedKeys":L[3]||(L[3]=m=>w.value=m),"auto-expand-parent":f.value,onSelect:p,"tree-data":$.value,blockNode:"",onExpand:P},{switcherIcon:l(({switcherCls:m})=>[r("div",ps,[r("span",vs,[t(W(yl),{style:{"font-size":"12px"},class:Wt(m)},null,8,["class"])])])]),title:l(m=>[r("div",ms,[m.title.indexOf(u.value)>-1&&u.value?(y(),D("span",fs,[m.title.length>3&&m.level>3?(y(),se(T,{key:0},{title:l(()=>[O(j(m.title),1)]),default:l(()=>[O(" "+j(m.title.substring(0,m.title.indexOf(u.value)))+" ",1),r("span",hs,j(u.value),1),O(" "+j(m.title.substring(m.title.indexOf(u.value)+u.value.length)),1)]),_:2},1024)):(y(),D(_e,{key:1},[O(j(m.title.substring(0,m.title.indexOf(u.value)))+" ",1),r("span",gs,j(u.value),1),O(" "+j(m.title.substring(m.title.indexOf(u.value)+u.value.length)),1)],64))])):(y(),D("span",ys,[m.title.length>3&&m.level>3?(y(),se(T,{key:0},{title:l(()=>[O(j(m.title),1)]),default:l(()=>[O(" "+j(m.title),1)]),_:2},1024)):(y(),D(_e,{key:1},[O(j(m.title),1)],64))])),r("div",bs,j(m.children_nums),1),m.is_user?te("",!0):(y(),D("div",ks,[t(X,null,{overlay:l(()=>[t(B,null,{default:l(()=>[t(M,{key:"addDoc",onClick:Ge(Z=>H(m),["stop","prevent"])},{default:l(()=>[ws]),_:2},1032,["onClick"]),t(M,{key:"importDoc",onClick:Ge(Z=>d(m),["stop","prevent"])},{default:l(()=>[xs]),_:2},1032,["onClick"]),m.is_default!=1?(y(),se(M,{key:"del",onClick:Ge(Z=>N(m),["stop","prevent"])},{default:l(()=>[Cs]),_:2},1032,["onClick"])):te("",!0)]),_:2},1024)]),default:l(()=>[r("span",{class:"action-btn",onClick:L[2]||(L[2]=Ge(()=>{},["stop"]))},[t(W(bl))])]),_:2},1024)]))])]),_:1},8,["expanded-keys","selectedKeys","auto-expand-parent","tree-data"])])]),t(Xn,{ref_key:"addDepartmentRef",ref:E,onOk:F},null,512),t(ds,{ref_key:"delDepartmentRef",ref:R,onOk:V},null,512)],64)}}},$s=he(Ss,[["__scopeId","data-v-f461874a"]]),Fe=e=>(Ke("data-v-d9967a89"),e=e(),Ne(),e),Is={class:"main-content-box"},Ls={style:{"margin-top":"12px"}},Ds={key:0},Os={key:1},Ts={key:2},Ps={class:"list-content"},Vs={key:0},Es={key:1},Rs={key:2},Ks={key:0,class:"user-block"},Ns={class:"role-menu-box"},Ms=["onClick"],As={class:"menu-header"},js=Fe(()=>r("span",{class:"title"},"管理",-1)),Fs=Fe(()=>r("div",{class:"desc"},"可编辑，可删除，可查看",-1)),Us={key:0,class:"check-box"},Hs=["onClick"],Bs={class:"menu-header"},zs=Fe(()=>r("span",{class:"title"},"编辑",-1)),Ws=Fe(()=>r("div",{class:"desc"},"可编辑，可查看",-1)),Ys={key:0,class:"check-box"},Js=["onClick"],qs={class:"menu-header"},Qs=Fe(()=>r("span",{class:"title"},"查看",-1)),Gs=Fe(()=>r("div",{class:"desc"},"仅查看",-1)),Xs={key:0,class:"check-box"},Zs={class:"hover-btn-box"},eo={key:0},to={key:1},ao={key:2},lo=["onClick"],no={__name:"knowledge-permissions",props:{treeParmas:{type:Object,default:()=>({})}},setup(e){const _=C("2"),g=C([]),s=e;Re(()=>s.treeParmas,c=>{i()},{deep:!0});const i=()=>{Qt({object_type:_.value,identity_type:s.treeParmas.is_user?1:2,identity_id:s.treeParmas.id}).then(c=>{let V=c.data||[];g.value=V})};i();const n=()=>{i()},o=(c,V)=>{let E=V==4?"管理":V==2?"编辑":"查看";fe.confirm({title:"提示?",icon:t(Je),content:"确认修改该数据权限为【"+E+"】",okText:"确认",cancelText:"取消",onOk:()=>{let H=[{object_id:+c.object_id,object_type:+c.object_type,operate_rights:+V}];Ya({identity_ids:c.identity_id,identity_type:2,object_array:JSON.stringify(H)}).then(d=>{oe.success("修改成功"),i()})},onCancel(){}})},a=c=>{fe.confirm({title:"提示?",icon:t(Je),content:"确认删除该条数据",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ja({identity_id:c.identity_id,identity_type:2,object_id:c.object_id,object_type:c.object_type}).then(V=>{oe.success("删除成功"),i()})},onCancel(){}})},w=C([]),u=C([]),f=C([]),$=async()=>{await Yt().then(c=>{w.value=c.data}).catch(()=>{})},k=async()=>{await zt({type:""}).then(c=>{u.value=c.data}).catch(()=>{})},S=async()=>{await Jt().then(c=>{f.value=c.data}).catch(()=>{})},P=C(null),h=async()=>{if(!s.treeParmas.id)return oe.error("请先选择部门");let c=_.value;c==1?await $():c==2?await k():c==3&&await S(),P.value.handleDepartmentOpen(c,s.treeParmas,g.value)},v=C([{dataIndex:"name",key:"name"},{title:"权限",dataIndex:"role",key:"role"},{title:"操作",dataIndex:"action",key:"action",width:80}]);return(c,V)=>{const E=fl,H=St,d=et,p=Cl,R=nt;return y(),D(_e,null,[r("div",Is,[t(H,{value:_.value,"onUpdate:value":V[0]||(V[0]=N=>_.value=N),onChange:n},{default:l(()=>[t(E,{value:"2"},{default:l(()=>[O("知识库")]),_:1}),t(E,{value:"1"},{default:l(()=>[O("机器人")]),_:1}),t(E,{value:"3"},{default:l(()=>[O("数据库")]),_:1})]),_:1},8,["value"]),r("div",Ls,[t(d,{type:"primary",onClick:h},{default:l(()=>[_.value==2?(y(),D("span",Ds,"添加知识库权限")):te("",!0),_.value==1?(y(),D("span",Os,"添加机器人权限")):te("",!0),_.value==3?(y(),D("span",Ts,"添加数据库权限")):te("",!0)]),_:1})]),r("div",Ps,[t(R,{columns:v.value,"data-source":g.value,pagination:!1},{headerCell:l(({column:N})=>[N.key==="name"?(y(),D(_e,{key:0},[_.value==2?(y(),D("span",Vs,"知识库")):te("",!0),_.value==1?(y(),D("span",Es,"机器人")):te("",!0),_.value==3?(y(),D("span",Rs,"数据库")):te("",!0)],64)):te("",!0)]),bodyCell:l(({column:N,record:F})=>[N.key==="name"?(y(),D("div",Ks,j(F.name),1)):te("",!0),N.key==="role"?(y(),se(p,{key:1,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:l(()=>[r("div",Ns,[r("div",{class:"role-menu",onClick:x=>o(F,4)},[r("div",As,[t(W(kl)),js]),Fs,F.operate_rights==4?(y(),D("div",Us,[t(W(vt))])):te("",!0)],8,Ms),r("div",{class:"role-menu",onClick:x=>o(F,2)},[r("div",Bs,[t(W(wl)),zs]),Ws,F.operate_rights==2?(y(),D("div",Ys,[t(W(vt))])):te("",!0)],8,Hs),r("div",{class:"role-menu",onClick:x=>o(F,1)},[r("div",qs,[t(W(gl)),Qs]),Gs,F.operate_rights==1?(y(),D("div",Xs,[t(W(vt))])):te("",!0)],8,Js)])]),default:l(()=>[r("div",Zs,[F.operate_rights==4?(y(),D("span",eo,"管理")):te("",!0),F.operate_rights==2?(y(),D("span",to,"编辑")):te("",!0),F.operate_rights==1?(y(),D("span",ao,"查看")):te("",!0),t(W(xl))])]),_:2},1024)):te("",!0),N.key==="action"?(y(),D("a",{key:2,onClick:x=>a(F)},"删除",8,lo)):te("",!0)]),_:1},8,["columns","data-source"])])]),t(da,{ref_key:"seeModelAlertRef",ref:P,robotList:w.value,libraryList:u.value,formList:f.value,onOk:i},null,8,["robotList","libraryList","formList"])],64)}}},so=he(no,[["__scopeId","data-v-d9967a89"]]),oo={__name:"batch-edit-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=g,n=Ie.useForm,o=pe({user_ids:"",department_ids:[]}),a=pe({department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:w,validate:u,validateInfos:f}=n(o,a),$=v=>{o.user_ids=v,o.department_ids=[],s.value=!0,S()},k=C([]),S=()=>{lt({}).then(v=>{let c=v.data||[];k.value=kt(c)})},P=C(!1),h=()=>{u().then(()=>{let v={...o};v.department_ids=o.department_ids.join(","),P.value=!0,qa(v).then(c=>{oe.success("批量修改部门成功"),s.value=!1,i("ok")}).finally(()=>{P.value=!1})})};return _({show:$}),(v,c)=>{const V=Tt,E=tt,H=Ie,d=fe;return y(),D("div",null,[t(d,{open:s.value,"onUpdate:open":c[1]||(c[1]=p=>s.value=p),title:"批量修改部门",onOk:h,confirmLoading:P.value},{default:l(()=>[t(H,{layout:"vertical",style:{"margin-top":"24px"}},{default:l(()=>[t(E,ge({label:"选择部门"},W(f).department_ids),{default:l(()=>[t(V,{value:o.department_ids,"onUpdate:value":c[0]||(c[0]=p=>o.department_ids=p),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":k.value,"tree-node-filter-prop":"label"},{title:l(({value:p,label:R})=>[r("div",null,j(R),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Ue=e=>(Ke("data-v-928accdd"),e=e(),Ne(),e),io={class:"flex-content-box"},ro={class:"left-department-box"},co={class:"team-members-pages"},uo={class:"main-tabs-block"},_o={class:"list-box"},po={class:"user-box"},vo=["src"],mo={class:"name-info"},fo={class:"user-name"},ho={class:"nick-name"},go={key:0,class:"list-content"},yo={key:1,class:"list-preview list-content"},bo={style:{display:"inline"}},ko={class:"list-item-box"},wo={class:"list-item"},xo={key:0,class:"list-content"},Co=Ue(()=>r("div",null,"全部",-1)),So=[Co],$o={key:1,class:"list-content"},Io=["onClick"],Lo={key:2,class:"list-preview list-content"},Do={style:{display:"inline"}},Oo={class:"list-item-box"},To={class:"list-item"},Po=["onClick"],Vo={key:0,class:"list-content"},Eo=Ue(()=>r("div",null,"全部",-1)),Ro=[Eo],Ko={key:1,class:"list-content"},No=["onClick"],Mo={key:2,class:"list-preview list-content"},Ao={style:{display:"inline"}},jo={class:"list-item-box"},Fo={class:"list-item"},Uo=["onClick"],Ho={key:0,class:"list-content"},Bo=Ue(()=>r("div",null,"全部",-1)),zo=[Bo],Wo={key:1,class:"list-content"},Yo=["onClick"],Jo={key:2,class:"list-preview list-content"},qo={style:{display:"inline"}},Qo={class:"list-item-box"},Go={class:"list-item"},Xo=["onClick"],Zo={key:0,class:"status-block green"},ei={key:1,class:"status-block yellow"},ti=Ue(()=>r("span",{class:"disabled"},"编辑",-1)),ai=Ue(()=>r("span",{class:"disabled"},"重置密码",-1)),li=Ue(()=>r("span",{class:"disabled"},"删除",-1)),ni=["onClick"],si=["onClick"],oi=["onClick"],ii={__name:"team-members",setup(e){const _=C(1),g=[{value:1,payload:{title:"团队成员"}},{value:2,payload:{title:"知识库权限"}}],s=pe({page:1,size:10,total:0,search:""}),i=C([]),n=C([]),o=C([]),a=C(null),w=A=>{s.page=A.current,s.size=A.pageSize,h()},u=pe({id:""}),f=A=>{Object.assign(u,{...A}),_.value==1&&$()},$=()=>{s.page=1,h()},k=C([]),S=A=>{let J=[];return A.map(ie=>{J.push(ie.name||ie.department_name)}),J.join(", ")},P=C(!1),h=()=>{let A={page:s.page,size:s.size,search:s.search};u.id&&u.is_default!=1&&(A.department_id=u.id),P.value=!0,Da(A).then(J=>{let ie=J.data.list;ie.forEach(K=>{K.create_time=Ve(K.create_time*1e3).format("YYYY-MM-DD HH:mm"),K.expire_time_desc=K.expire_time=="0"?"永久有效":Ve(K.expire_time*1e3).format("YYYY-MM-DD HH:mm"),K.expire_status=0,(K.expire_time=="0"||Ve().unix()<K.expire_time)&&(K.expire_status=1),K.managed_robot_list=K.managed_robot_list?JSON.parse(K.managed_robot_list):[],K.managed_library_list=K.managed_library_list?JSON.parse(K.managed_library_list):[],K.managed_form_list=K.managed_form_list?JSON.parse(K.managed_form_list):[],K.departments=K.departments?JSON.parse(K.departments):[]}),k.value=ie,E.selectedRowKeys=[],s.total=+J.data.total}).finally(()=>{P.value=!1})},v=()=>{_.value==1&&$()},c=C(null),V=()=>{h(),c.value.getLists()},E=pe({selectedRowKeys:[]}),H=A=>{E.selectedRowKeys=A},d=A=>({disabled:A.role_type==1}),p=A=>{Oa({user_id:A.id}).then(J=>{oe.success(A.login_switch==1?"关闭成功":"开启成功"),h()})},R=C(null),N=()=>{R.value.add(u.id)},F=A=>{R.value.edit(A)},x=C(null),L=A=>{x.value.open(A)},b=A=>{fe.confirm({title:"提示?",icon:t(Je),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ta({id:A.id}).then(J=>{oe.success("删除成功"),h()})},onCancel(){}})},T=async()=>{await Yt().then(A=>{i.value=A.data}).catch(()=>{})},M=async()=>{await zt({type:""}).then(A=>{n.value=A.data}).catch(()=>{})},B=async()=>{await Jt().then(A=>{o.value=A.data}).catch(()=>{})},X=async A=>{let J=[];if(E.selectedRowKeys.forEach(ie=>{k.value.filter(ee=>ee.id==ie)[0].role_type==1||J.push(ie)}),E.selectedRowKeys=J,E.selectedRowKeys.length==0)return oe.error("请选择要修改的成员");A==1?await T():A==2?await M():A==3&&await B(),a.value.handleBatchOpen(A,E.selectedRowKeys.join(","))},q=C(null),m=()=>{if(E.selectedRowKeys.length==0)return oe.error("请选择要修改的成员");q.value.show(E.selectedRowKeys.join(","))},Z=async(A,J)=>{A==1?await T():A==2?await M():A==3&&await B(),a.value.open(A,"add",J)},xe=async(A,J)=>{A==1?await T():A==2?await M():A==3&&await B(),a.value.open(A,"edit",J)};return(A,J)=>{const ie=Fa,K=ta,ee=et,ce=aa,Ce=la,He=na,Le=Lt,Be=It,ve=sa,ue=$t,De=Pa,ze=Sl,We=nt;return y(),D("div",io,[r("div",ro,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[t($s,{ref_key:"departmentTreeRef",ref:c,onSelect:f,onRefresh:h},null,512)]),_:1})]),r("div",co,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[r("div",uo,[t(K,{value:_.value,"onUpdate:value":J[0]||(J[0]=I=>_.value=I),options:g,onChange:v},{label:l(({payload:I})=>[O(j(I.title),1)]),_:1},8,["value"])]),_.value==1?(y(),D(_e,{key:0},[t(Le,{justify:"space-between"},{default:l(()=>[t(Le,{gap:8},{default:l(()=>[t(ee,{type:"primary",onClick:N},{icon:l(()=>[t(W(at))]),default:l(()=>[O(" 添加团队成员 ")]),_:1}),t(He,null,{overlay:l(()=>[t(Ce,null,{default:l(()=>[t(ce,{onClick:J[1]||(J[1]=I=>X(1))},{default:l(()=>[O(" 修改机器人 ")]),_:1}),t(ce,{onClick:J[2]||(J[2]=I=>X(2))},{default:l(()=>[O(" 修改知识库 ")]),_:1}),t(ce,{onClick:J[3]||(J[3]=I=>X(3))},{default:l(()=>[O(" 修改数据库 ")]),_:1})]),_:1})]),default:l(()=>[t(ee,null,{default:l(()=>[O("批量修改权限")]),_:1})]),_:1}),t(ee,{onClick:m},{default:l(()=>[O("批量修改部门")]),_:1})]),_:1}),t(Be,{value:s.search,"onUpdate:value":J[4]||(J[4]=I=>s.search=I),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:$},null,8,["value"])]),_:1}),r("div",_o,[t(We,{"data-source":k.value,scroll:{x:1100},loading:P.value,"row-key":"id","row-selection":{selectedRowKeys:E.selectedRowKeys,onChange:H,getCheckboxProps:d},pagination:{current:s.page,total:s.total,pageSize:s.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:w},{default:l(()=>[t(ue,{title:"成员名称","data-index":"user_name",width:"190px"},{default:l(({record:I})=>[r("div",po,[r("img",{src:I.avatar||W(ht),alt:""},null,8,vo),r("div",mo,[r("div",fo,[I.user_name&&I.user_name.length>7?(y(),se(ve,{key:0,title:I.user_name},{default:l(()=>[O(j(I.user_name),1)]),_:2},1032,["title"])):(y(),D(_e,{key:1},[O(j(I.user_name),1)],64))]),r("div",ho,[I.nick_name&&I.nick_name.length>7?(y(),se(ve,{key:0,title:I.nick_name},{default:l(()=>[O(j(I.nick_name),1)]),_:2},1032,["title"])):(y(),D(_e,{key:1},[O(j(I.nick_name),1)],64))])])])]),_:1}),t(ue,{title:"角色","data-index":"role_name",width:"100px"},{default:l(({record:I})=>[O(j(I.role_name),1)]),_:1}),t(ue,{"data-index":"departments",width:"200px"},{title:l(()=>[O(" 部门 ")]),default:l(({record:I})=>[I.departments&&I.departments.length==0?(y(),D("div",go," -- ")):(y(),D("div",yo,[t(ve,null,{title:l(()=>[r("div",bo,j(S(I.departments)),1)]),default:l(()=>[r("div",ko,[r("div",wo,j(S(I.departments)),1)])]),_:2},1024)]))]),_:1}),t(ue,{"data-index":"managed_robot_list",width:"200px"},{title:l(()=>[O(" 管理的机器人 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部机器人，成员只能管理分配的机器人。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",xo,So)):I.managed_robot_list?(y(),D("div",Lo,[t(ve,null,{title:l(()=>[r("div",Do,j(S(I.managed_robot_list)),1)]),default:l(()=>[r("div",Oo,[r("div",To,j(S(I.managed_robot_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(1,I)},[t(De,{name:"edit"})],8,Po)])):(y(),D("div",$o,[r("div",{class:"list-highlight",onClick:me=>Z(1,I)},"添加",8,Io)]))]),_:1}),t(ue,{"data-index":"managed_library_list",width:"200px"},{title:l(()=>[O(" 管理的知识库 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部知识库，成员只能管理分配的知识库。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",Vo,Ro)):I.managed_library_list?(y(),D("div",Mo,[t(ve,null,{title:l(()=>[r("div",Ao,j(S(I.managed_library_list)),1)]),default:l(()=>[r("div",jo,[r("div",Fo,j(S(I.managed_library_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(2,I)},[t(De,{name:"edit"})],8,Uo)])):(y(),D("div",Ko,[r("div",{class:"list-highlight",onClick:me=>Z(2,I)},"添加",8,No)]))]),_:1}),t(ue,{"data-index":"managed_form_list",width:"200px"},{title:l(()=>[O(" 管理的数据库 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部数据库，成员只能管理分配的数据库。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",Ho,zo)):I.managed_form_list?(y(),D("div",Jo,[t(ve,null,{title:l(()=>[r("div",qo,j(S(I.managed_form_list)),1)]),default:l(()=>[r("div",Qo,[r("div",Go,j(S(I.managed_form_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(3,I)},[t(De,{name:"edit"})],8,Xo)])):(y(),D("div",Wo,[r("div",{class:"list-highlight",onClick:me=>Z(3,I)},"添加",8,Yo)]))]),_:1}),t(ue,{title:"状态","data-index":"expire_status",width:"120px"},{default:l(({record:I})=>[I.expire_status==1?(y(),D("div",Zo,[t(W(La)),O("生效中 ")])):te("",!0),I.expire_status==0?(y(),D("div",ei,[t(W(Bt)),O("已过期 ")])):te("",!0)]),_:1}),t(ue,{title:"过期时间","data-index":"expire_time_desc",width:"130px"},{default:l(({record:I})=>[O(j(I.expire_time_desc),1)]),_:1}),t(ue,{title:"登录","data-index":"login_switch",width:"90px",fixed:"right"},{default:l(({record:I})=>[t(ze,{onChange:me=>p(I),checked:I.login_switch=="1",disabled:I.role_type=="1","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked","disabled"])]),_:1}),t(ue,{title:"操作","data-index":"action",width:"176px",fixed:"right"},{default:l(({record:I})=>[I.role_type=="1"?(y(),se(Le,{key:0,gap:16},{default:l(()=>[ti,ai,li]),_:1})):(y(),se(Le,{key:1,gap:16},{default:l(()=>[r("a",{onClick:me=>F(I)},"编辑",8,ni),r("a",{onClick:me=>L(I)},"重置密码",8,si),r("a",{onClick:me=>b(I)},"删除",8,oi)]),_:2},1024))]),_:1})]),_:1},8,["data-source","loading","row-selection","pagination"])])],64)):(y(),se(so,{key:1,treeParmas:u},null,8,["treeParmas"]))]),_:1}),t(xn,{ref_key:"addTeamMembersRef",ref:R,onOk:V},null,512),t($n,{ref_key:"resetPasswordRef",ref:x,onOk:h},null,512),t(da,{ref_key:"seeModelAlertRef",ref:a,robotList:i.value,libraryList:n.value,formList:o.value,onOk:h},null,8,["robotList","libraryList","formList"]),t(oo,{ref_key:"batchEditDepartmentRef",ref:q,onOk:V},null,512)])])}}},ri=he(ii,[["__scopeId","data-v-928accdd"]]),di={class:"form-box"},ci={class:"title-row"},ui={class:"check-num"},_i={__name:"add-role",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C([]),o=C({}),a=C(!1),w=C("添加角色"),u=C(""),f=pe({name:"",mark:"",role_type:""}),$=pe({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:k,validate:S,validateInfos:P}=i(f,$),h=async()=>{await Va().then(d=>{n.value=d.data;for(let p=0;p<d.data.length;p++){const R=d.data[p];o.value[R.uni_key]=[]}})},v=async()=>{await h(),w.value="添加角色",u.value="",a.value=!0,f.name="",f.mark="",k()},c=d=>{w.value="编辑角色",u.value=d.id,Ea({id:d.id}).then(p=>{let R=p.data,N=R.role_permission||[];f.name=R.name,f.mark=R.mark,f.role_type=R.role_type,o.value=V(n.value,N),a.value=!0})},V=(d,p)=>{let R={};return d.forEach(N=>{R[N.uni_key]=[];for(let F=0;F<N.children.length;F++){const x=N.children[F];p.includes(x.uni_key)&&R[N.uni_key].push(x.uni_key)}}),R},E=d=>{let p=[];for(let R in d)d[R].map(F=>{p.push(F)});return p},H=()=>{S().then(()=>{let d=E(o.value),p={id:u.value,mark:f.mark};f.role_type==0&&(p.name=f.name,p.role_type=f.role_type,p.uni_keys=d.join(",")),Ra(p).then(R=>{a.value=!1,oe.success("保存成功"),s("ok")})})};return ja(()=>{h()}),_({add:v,edit:c}),(d,p)=>{const R=Ct,N=tt,F=$l,x=Lt,L=Il,b=Dl,T=Ol,M=Ll,B=Ie,X=fe;return y(),D("div",null,[t(X,{open:a.value,"onUpdate:open":p[2]||(p[2]=q=>a.value=q),title:w.value,onOk:H,width:"746px"},{default:l(()=>[r("div",di,[t(B,{layout:"vertical"},{default:l(()=>[t(N,ge({label:"角色名称"},W(P).name),{default:l(()=>[t(R,{type:"text",maxlength:100,disabled:f.role_type>0,placeholder:"请输入角色名称",value:f.name,"onUpdate:value":p[0]||(p[0]=q=>f.name=q)},null,8,["disabled","value"])]),_:1},16),t(N,{label:"角色备注"},{default:l(()=>[t(F,{value:f.mark,"onUpdate:value":p[1]||(p[1]=q=>f.mark=q),placeholder:"请输入角色备注"},null,8,["value"])]),_:1}),t(N,{label:"角色权限"},{default:l(()=>[(y(!0),D(_e,null,qe(n.value,q=>(y(),D("div",{class:"role-check-box",key:q.uni_key},[t(x,{class:"title-boock",justify:"space-between"},{default:l(()=>[r("div",ci,j(q.name),1),r("div",ui,j(o.value[q.uni_key].length)+"/"+j(q.children.length),1)]),_:2},1024),t(M,{value:o.value[q.uni_key],"onUpdate:value":m=>o.value[q.uni_key]=m,style:{width:"100%"}},{default:l(()=>[t(T,{gutter:[0,12]},{default:l(()=>[(y(!0),D(_e,null,qe(q.children,m=>(y(),se(b,{span:6,key:m.uni_key},{default:l(()=>[t(L,{disabled:f.role_type>0,value:m.uni_key},{default:l(()=>[O(j(m.name),1)]),_:2},1032,["disabled","value"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])]))),128))]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},pi=he(_i,[["__scopeId","data-v-bb48065b"]]),vi={class:"team-members-pages"},mi={class:"list-box"},fi={__name:"role-permissions",setup(e){C("");const _=pe({page:1,size:10,total:0,search:""}),g=C([{}]),s=f=>{_.page=f.current,_.size=f.pageSize,n()},i=()=>{_.page=1,n()},n=()=>{let f={page:_.page,size:_.size,search:_.search};Ht(f).then($=>{let k=$.data.list;k.forEach(S=>{S.update_time=Ve(S.update_time*1e3).format("YYYY-MM-DD HH:mm")}),g.value=k,_.total=+$.data.total})};i();const o=C(null),a=()=>{o.value.add()},w=f=>{o.value.edit(f)},u=f=>{fe.confirm({title:"提示?",icon:t(Je),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ka({id:f.id}).then($=>{oe.success("删除成功"),n()})},onCancel(){}})};return(f,$)=>{const k=et,S=It,P=Lt,h=$t,v=nt;return y(),D("div",vi,[t(P,{justify:"space-between"},{default:l(()=>[t(k,{type:"primary",onClick:a},{icon:l(()=>[t(W(at))]),default:l(()=>[O(" 添加角色 ")]),_:1}),t(S,{value:_.search,"onUpdate:value":$[0]||($[0]=c=>_.search=c),placeholder:"输入角色名称",style:{width:"288px"},onSearch:i},null,8,["value"])]),_:1}),r("div",mi,[t(v,{"data-source":g.value,pagination:{current:_.page,total:_.total,pageSize:_.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:s},{default:l(()=>[t(h,{title:"角色","data-index":"name",width:"157px"},{default:l(({record:c})=>[O(j(c.name),1)]),_:1}),t(h,{title:"备注","data-index":"mark",width:"480px"},{default:l(({record:c})=>[O(j(c.mark),1)]),_:1}),t(h,{title:"最近修改时间","data-index":"update_time",width:"150px"},{default:l(({record:c})=>[O(j(c.update_time),1)]),_:1}),t(h,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:l(({record:c})=>[O(j(c.operate_name),1)]),_:1}),t(h,{title:"创建人","data-index":"create_name",width:"130px"},{default:l(({record:c})=>[O(j(c.create_name),1)]),_:1}),t(h,{title:"操作","data-index":"action",width:"178px"},{default:l(({record:c})=>[t(P,{gap:16,class:"action-box"},{default:l(()=>[t(k,{type:"link",onClick:V=>w(c)},{default:l(()=>[O("编辑")]),_:2},1032,["onClick"]),t(k,{type:"link",onClick:V=>u(c),disabled:c.role_type<=3&&c.role_type>0},{default:l(()=>[O("删除")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),t(pi,{ref_key:"addRoleRef",ref:o,onOk:n},null,512)])}}},hi=he(fi,[["__scopeId","data-v-e2c92e52"]]),gi={class:"user-model-page"},yi={class:"list-wrapper"},bi={__name:"index",setup(e){const _=C(1),g=()=>{_.value};return(s,i)=>(y(),D("div",gi,[t(ln,{value:_.value,"onUpdate:value":i[0]||(i[0]=n=>_.value=n),onChange:g},null,8,["value"]),r("div",yi,[_.value==1?(y(),se(ri,{key:0})):(y(),se(hi,{key:1}))])]))}},Mr=he(bi,[["__scopeId","data-v-752bf84e"]]);export{Mr as default};
